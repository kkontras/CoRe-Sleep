Starting Job
/users/sista/kkontras/Documents/Sleep_Project/main_paper_3.py
/esat/smcdata/users/kkontras/Image_Dataset/no_backup/envs/gl_env/bin/python
Python 3.7.10
/users/sista/kkontras/Documents/Sleep_Project
1
 THE Configuration of your experiment ..
{'agent': 'Sleep_Agent_Init_Train',
 'augmentation': {},
 'channel': 0,
 'dataset': {'cache_datasets': {'test': False, 'train': False, 'valid': False},
             'data_roots': '/esat/biomeddata/SHHS_Dataset/no_backup',
             'data_split': {'fold': 0,
                            'fold_size': 7,
                            'folds_file': '/users/sista/kkontras/Documents/Huy_shhs1/HUY '
                                          'SHHS1 CODE/data_split_eval.mat',
                            'rand_split': 0,
                            'rand_splits': 13,
                            'split_method': 'patients_huy',
                            'test_split_rate': 0.3,
                            'val_patient_num': 3,
                            'val_split_rate': 0.01692},
             'data_view_dir': [{'data_type': 'stft',
                                'list_dir': 'patient_mat_list.txt',
                                'mod': 'eeg',
                                'num_ch': 1},
                               {'data_type': 'stft',
                                'list_dir': 'patient_eog_mat_list.txt',
                                'mod': 'eog',
                                'num_ch': 1}],
             'dataloader_class': 'SleepDataLoader_mat_huy',
             'filter_windows': {'test': {'perc_threshold': 0.4,
                                         'skip_skips': True,
                                         'std_threshold': 41,
                                         'use_type': 'include_only_skipped',
                                         'whole_patient': False},
                                'train': {'perc_threshold': 0.4,
                                          'skip_skips': False,
                                          'std_threshold': 41,
                                          'subsets': {'combined': 100,
                                                      'eeg': 0,
                                                      'eog': 400},
                                          'use_type': 'subsample',
                                          'whole_patient': True},
                                'val': {'skip_skips': True,
                                        'use_type': False,
                                        'whole_patient': False}},
             'huy_data': True,
             'inner_overlap': [0.5, 0.5],
             'keep_view': [1, 0],
             'seq_length': [21, 0],
             'seq_views': [False],
             'shuffle_train': True},
 'early_stopping': {'log_interval': 10,
                    'max_epoch': 1000,
                    'n_steps_stop': 100,
                    'n_steps_stop_after': 50,
                    'save_every': 1,
                    'validate_after': 0,
                    'validate_every': 50},
 'exp_name': 'Sleep EEG-EOG BLIP Experiment',
 'lr_finder': False,
 'lr_finder_steps': 100,
 'mode': 'train',
 'model': {'args': {'augment_within': False,
                    'dmodel': 128,
                    'dropout': 0.3,
                    'fc_inner': 1024,
                    'ignore_alignment_val': True,
                    'multi_loss': {'multi_loss_weights': {'alignment_loss': 0.1,
                                                          'multi_supervised_loss': {'combined': 1,
                                                                                    'eeg': 1,
                                                                                    'eog': 1},
                                                          'order_loss': 0}},
                    'num_classes': 5,
                    'three_modes': True,
                    'training_type': 'alignment_order_multisupervised'},
           'encoders': [{'args': {'align_inner': True,
                                  'd_model': 128,
                                  'dim_feedforward': 1024,
                                  'dim_proj': 128,
                                  'dropout': 0.3,
                                  'inner_biased': False,
                                  'mod_token': False,
                                  'num_heads': 8,
                                  'num_layers': 4,
                                  'outer_biased': False,
                                  'outer_rep': False,
                                  'pos': False,
                                  'rpos': True,
                                  'shared': True,
                                  'skip_random_mod': False},
                         'encoders': [],
                         'freeze_encoder': False,
                         'model': 'SleepEnc_BLIP_EEG_EOG_shared_free_cliplike',
                         'pretrainedEncoder': {'dir': '', 'use': False},
                         'savetrainedEncoder': {'dir': '', 'save': False}}],
           'load_ongoing': False,
           'model_class': 'EEG_SLEEP_BLIP_GM_MultiMode',
           'pretrained_model': {'dir': '', 'use': False},
           'save_dir': '/esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2021_data/shhs1/multi_modal/paper_models/fourier_transformer_eeg_eog_mat_BLIP_al01_shared_b16_freetrain_rpos_nopos_nonsharedpreds_drop03_align_inner_trial1_incomplete_100p_0e_400o.pth.tar'},
 'normalization': {'calculate_metrics': False,
                   'dir': '/esat/biomeddata/SHHS_Dataset/no_backup/metrics_eeg_eog_emg_stft.pkl',
                   'metrics_type': 'train_dataset',
                   'save_metrics': False,
                   'use': True},
 'num_classes': 5,
 'num_modalities': 1,
 'optimizer': {'beta1': 0.9,
               'beta2': 0.999,
               'learning_rate': 0.0001,
               'momentum': 0.2,
               'type': 'Adam',
               'weight_decay': 0.0001},
 'plots': {'plot_stft_num': 0, 'save': False},
 'post_proc': {'post_proc_step': 15,
               'test_postprocessing': False,
               'val_postprocessing': False},
 'scheduler': {'max_lr': 0.03, 'type': 'cosanneal', 'warm_up': 55},
 'statistics': {'ce_weights': {'temp': 0.1, 'use': False}, 'print': False},
 'training_params': {'adversarial_training': {'adv_epsilon': 0.01,
                                              'use': False},
                     'async_loading': True,
                     'batch_size': 32,
                     'cuda': False,
                     'data_loader_workers': 8,
                     'gpu_device': [0],
                     'pin_memory': True,
                     'rec_test': False,
                     'res': True,
                     'seed': 28,
                     'tdqm_disable': True,
                     'test_batch_size': 32,
                     'test_on_tops': True,
                     'use_test_set': True,
                     'validation': True,
                     'verbose': True,
                     'wandb_disable': True}}
 *************************************** 
The experiment name is Sleep EEG-EOG BLIP Experiment
 *************************************** 
We are splitting dataset by huy splits
{'use_type': 'subsample', 'skip_skips': False, 'whole_patient': True, 'std_threshold': 41, 'perc_threshold': 0.4, 'subsets': {'combined': 100, 'eeg': 0, 'eog': 400}}
We subsample patients with 100 both mods, 0 only EEG and 400 only EOG and len_skipped is 500.
{'use_type': False, 'skip_skips': True, 'whole_patient': False}
{'use_type': 'include_only_skipped', 'skip_skips': True, 'whole_patient': False, 'std_threshold': 41, 'perc_threshold': 0.4}
Patients with broken modalities are 27
{'use_type': False, 'skip_skips': True}
Loading metrics from /esat/biomeddata/SHHS_Dataset/no_backup/metrics_eeg_eog_emg_stft.pkl
Weights are [1. 1. 1. 1. 1.]
736
50
15
tensor([1., 1., 1., 1., 1.], device='cuda:0')
We are not shuffling the data
Training function is sleep_train_one_step_alignment_order_multisupervised
Loss Weights are {'combined': 1, 'eeg': 1, 'eog': 1, 'alignments': 0.1, 'order': 0, 'consistency': 0, 'reconstruction': 0}
We are not shuffling the data
<class 'graphs.models.attention_models.BLIP.SleepEnc_BLIP_EEG_EOG_shared_free_cliplike'>
Total number of trainable parameters are: 7628293
Available cuda devices: 1, current device:0
Total number of trainable parameters are: 7628293
[37mEpoch 0 step 1 with [31mce_loss_combined : 1.109243 [31mce_loss_eeg : 1.129480 [31mce_loss_eog : 1.033826 [31mtotal : 3.272549 [94mAcc_combined: 62.60 [94mAcc_eeg: 57.72 [94mAcc_eog: 58.37 [92mF1_combined: 39.89 [92mF1_eeg: 28.65 [92mF1_eog: 33.28 [92mK_combined: 0.4446 [92mK_eeg: 0.3321 [92mK_eog: 0.3540 [34mF1_perclass_combined: [78.66, 0.0, 67.29, 53.49, 0.0] [34mF1_perclass_eeg: [78.13, 0.0, 65.1, 0.0, 0.0] [34mF1_perclass_eog: [73.25, 0.0, 66.17, 18.72, 8.29] 
[37mEpoch 0 step 3 with [31mce_loss_combined : 0.896681 [31mce_loss_eeg : 0.959021 [31mce_loss_eog : 1.129938 [31mtotal : 2.985639 [94mAcc_combined: 64.13 [94mAcc_eeg: 60.96 [94mAcc_eog: 52.46 [92mF1_combined: 39.86 [92mF1_eeg: 30.25 [92mF1_eog: 31.87 [92mK_combined: 0.4615 [92mK_eeg: 0.3908 [92mK_eog: 0.3207 [34mF1_perclass_combined: [78.42, 0.0, 71.24, 16.9, 32.76] [34mF1_perclass_eeg: [84.26, 0.0, 67.0, 0.0, 0.0] [34mF1_perclass_eog: [68.57, 0.0, 59.02, 7.32, 24.42] 
[37mEpoch 0 step 4 with [31mce_loss_combined : 0.939172 [31mce_loss_eeg : 1.055793 [31mce_loss_eog : 0.972949 [31mtotal : 2.967913 [94mAcc_combined: 61.98 [94mAcc_eeg: 58.48 [94mAcc_eog: 62.56 [92mF1_combined: 42.53 [92mF1_eeg: 41.78 [92mF1_eog: 40.86 [92mK_combined: 0.4642 [92mK_eeg: 0.4217 [92mK_eog: 0.4394 [34mF1_perclass_combined: [68.78, 0.0, 64.54, 70.99, 8.36] [34mF1_perclass_eeg: [65.07, 0.0, 58.3, 71.76, 13.75] [34mF1_perclass_eog: [73.97, 0.0, 70.39, 39.88, 20.09] 
[37mEpoch 0 step 7 with [31mce_loss_combined : 0.795151 [31mce_loss_eeg : 0.874016 [31mce_loss_eog : 0.835471 [31mtotal : 2.504637 [94mAcc_combined: 70.01 [94mAcc_eeg: 67.18 [94mAcc_eog: 69.69 [92mF1_combined: 54.66 [92mF1_eeg: 43.06 [92mF1_eog: 54.65 [92mK_combined: 0.5742 [92mK_eeg: 0.5017 [92mK_eog: 0.5704 [34mF1_perclass_combined: [79.49, 0.0, 70.34, 71.81, 51.64] [34mF1_perclass_eeg: [84.19, 0.0, 70.63, 60.21, 0.29] [34mF1_perclass_eog: [78.16, 0.0, 70.74, 70.33, 54.04] 
[37mEpoch 0 step 10 with [31mce_loss_combined : 0.688342 [31mce_loss_eeg : 0.790684 [31mce_loss_eog : 0.742364 [31mtotal : 2.221389 [94mAcc_combined: 76.65 [94mAcc_eeg: 71.84 [94mAcc_eog: 73.46 [92mF1_combined: 60.48 [92mF1_eeg: 55.72 [92mF1_eog: 58.15 [92mK_combined: 0.6661 [92mK_eeg: 0.6034 [92mK_eog: 0.6255 [34mF1_perclass_combined: [81.98, 0.0, 79.88, 71.46, 69.08] [34mF1_perclass_eeg: [81.83, 0.0, 73.3, 74.76, 48.7] [34mF1_perclass_eog: [79.96, 0.0, 75.18, 72.1, 63.52] 
[37mEpoch 1 step 15 with [31mce_loss_combined : 0.652025 [31mce_loss_eeg : 0.791550 [31mce_loss_eog : 0.758108 [31mtotal : 2.201683 [94mAcc_combined: 77.90 [94mAcc_eeg: 70.61 [94mAcc_eog: 71.09 [92mF1_combined: 61.87 [92mF1_eeg: 52.47 [92mF1_eog: 51.49 [92mK_combined: 0.6846 [92mK_eeg: 0.5731 [92mK_eog: 0.5740 [34mF1_perclass_combined: [84.26, 0.0, 79.8, 69.45, 75.86] [34mF1_perclass_eeg: [83.78, 0.0, 73.2, 62.73, 42.62] [34mF1_perclass_eog: [81.58, 0.0, 74.76, 25.36, 75.73] 
[37mEpoch 1 step 18 with [31mce_loss_combined : 0.588169 [31mce_loss_eeg : 0.791000 [31mce_loss_eog : 0.736826 [31mtotal : 2.115995 [94mAcc_combined: 79.26 [94mAcc_eeg: 68.12 [94mAcc_eog: 72.66 [92mF1_combined: 63.66 [92mF1_eeg: 55.47 [92mF1_eog: 56.95 [92mK_combined: 0.7087 [92mK_eeg: 0.5745 [92mK_eog: 0.6078 [34mF1_perclass_combined: [82.54, 0.06, 81.6, 79.41, 74.71] [34mF1_perclass_eeg: [85.56, 0.0, 61.96, 76.95, 52.9] [34mF1_perclass_eog: [75.69, 0.0, 77.19, 67.72, 64.17] 
[37mEpoch 1 step 21 with [31mce_loss_combined : 0.597977 [31mce_loss_eeg : 0.787557 [31mce_loss_eog : 0.711742 [31mtotal : 2.097275 [94mAcc_combined: 79.19 [94mAcc_eeg: 70.41 [94mAcc_eog: 75.00 [92mF1_combined: 63.72 [92mF1_eeg: 46.81 [92mF1_eog: 59.50 [92mK_combined: 0.7069 [92mK_eeg: 0.5679 [92mK_eog: 0.6441 [34mF1_perclass_combined: [83.47, 0.0, 80.94, 76.8, 77.37] [34mF1_perclass_eeg: [83.22, 0.0, 72.61, 78.19, 0.04] [34mF1_perclass_eog: [79.06, 0.0, 77.94, 65.56, 74.92] 
[37mEpoch 1 step 24 with [31mce_loss_combined : 0.596066 [31mce_loss_eeg : 0.773679 [31mce_loss_eog : 0.652887 [31mtotal : 2.022632 [94mAcc_combined: 79.49 [94mAcc_eeg: 72.18 [94mAcc_eog: 77.06 [92mF1_combined: 64.12 [92mF1_eeg: 57.55 [92mF1_eog: 62.39 [92mK_combined: 0.7077 [92mK_eeg: 0.6158 [92mK_eog: 0.6719 [34mF1_perclass_combined: [84.21, 0.0, 80.92, 75.65, 79.83] [34mF1_perclass_eeg: [83.74, 0.0, 72.53, 72.36, 59.1] [34mF1_perclass_eog: [80.8, 0.0, 78.43, 75.25, 77.5] 
[37mEpoch 1 step 25 with [31mce_loss_combined : 0.540088 [31mce_loss_eeg : 0.782431 [31mce_loss_eog : 0.617261 [31mtotal : 1.939780 [94mAcc_combined: 81.19 [94mAcc_eeg: 72.49 [94mAcc_eog: 78.27 [92mF1_combined: 65.31 [92mF1_eeg: 53.96 [92mF1_eog: 63.35 [92mK_combined: 0.7326 [92mK_eeg: 0.5958 [92mK_eog: 0.6939 [34mF1_perclass_combined: [86.4, 0.39, 82.77, 76.92, 80.08] [34mF1_perclass_eeg: [84.51, 0.0, 75.23, 67.62, 42.44] [34mF1_perclass_eog: [83.1, 0.0, 79.21, 75.01, 79.42] 
[37mEpoch 2 step 32 with [31mce_loss_combined : 0.517573 [31mce_loss_eeg : 0.684791 [31mce_loss_eog : 0.649094 [31mtotal : 1.851458 [94mAcc_combined: 81.48 [94mAcc_eeg: 74.60 [94mAcc_eog: 76.97 [92mF1_combined: 66.17 [92mF1_eeg: 59.53 [92mF1_eog: 62.53 [92mK_combined: 0.7413 [92mK_eeg: 0.6488 [92mK_eog: 0.6818 [34mF1_perclass_combined: [87.03, 1.42, 82.15, 80.58, 79.68] [34mF1_perclass_eeg: [85.55, 0.0, 74.78, 77.86, 59.47] [34mF1_perclass_eog: [80.78, 0.0, 77.75, 75.16, 78.98] 
[37mEpoch 2 step 36 with [31mce_loss_combined : 0.489654 [31mce_loss_eeg : 0.669615 [31mce_loss_eog : 0.623562 [31mtotal : 1.782831 [94mAcc_combined: 82.81 [94mAcc_eeg: 76.18 [94mAcc_eog: 78.35 [92mF1_combined: 67.31 [92mF1_eeg: 60.14 [92mF1_eog: 62.86 [92mK_combined: 0.7575 [92mK_eeg: 0.6640 [92mK_eog: 0.6900 [34mF1_perclass_combined: [88.57, 1.09, 83.19, 81.45, 82.27] [34mF1_perclass_eeg: [86.68, 0.0, 76.98, 81.11, 55.92] [34mF1_perclass_eog: [83.25, 0.0, 80.06, 71.93, 79.07] 
[37mEpoch 3 step 51 with [31mce_loss_combined : 0.464246 [31mce_loss_eeg : 0.649929 [31mce_loss_eog : 0.590305 [31mtotal : 1.704479 [94mAcc_combined: 83.62 [94mAcc_eeg: 76.60 [94mAcc_eog: 80.07 [92mF1_combined: 70.72 [92mF1_eeg: 60.49 [92mF1_eog: 64.99 [92mK_combined: 0.7702 [92mK_eeg: 0.6688 [92mK_eog: 0.7193 [34mF1_perclass_combined: [89.37, 14.92, 84.06, 80.45, 84.81] [34mF1_perclass_eeg: [86.87, 0.66, 77.81, 80.95, 56.17] [34mF1_perclass_eog: [84.68, 1.25, 81.04, 74.78, 83.2] 
[37mEpoch 4 step 60 with [31mce_loss_combined : 0.470049 [31mce_loss_eeg : 0.637836 [31mce_loss_eog : 0.564356 [31mtotal : 1.672241 [94mAcc_combined: 83.53 [94mAcc_eeg: 77.73 [94mAcc_eog: 79.45 [92mF1_combined: 70.97 [92mF1_eeg: 62.67 [92mF1_eog: 65.34 [92mK_combined: 0.7684 [92mK_eeg: 0.6883 [92mK_eog: 0.7078 [34mF1_perclass_combined: [88.8, 17.61, 84.6, 79.13, 84.71] [34mF1_perclass_eeg: [84.96, 3.11, 78.86, 80.94, 65.47] [34mF1_perclass_eog: [85.87, 10.12, 80.99, 66.07, 83.67] 
[37mEpoch 4 step 64 with [31mce_loss_combined : 0.468067 [31mce_loss_eeg : 0.628270 [31mce_loss_eog : 0.556184 [31mtotal : 1.652521 [94mAcc_combined: 83.71 [94mAcc_eeg: 77.70 [94mAcc_eog: 80.13 [92mF1_combined: 71.11 [92mF1_eeg: 62.73 [92mF1_eog: 65.33 [92mK_combined: 0.7720 [92mK_eeg: 0.6916 [92mK_eog: 0.7200 [34mF1_perclass_combined: [88.35, 16.87, 84.69, 81.02, 84.64] [34mF1_perclass_eeg: [86.4, 1.59, 78.21, 81.89, 65.58] [34mF1_perclass_eog: [84.66, 2.33, 80.97, 74.57, 84.11] 
[37mEpoch 4 step 65 with [31mce_loss_combined : 0.457445 [31mce_loss_eeg : 0.616026 [31mce_loss_eog : 0.549392 [31mtotal : 1.622862 [94mAcc_combined: 84.13 [94mAcc_eeg: 78.46 [94mAcc_eog: 80.35 [92mF1_combined: 70.89 [92mF1_eeg: 63.27 [92mF1_eog: 65.54 [92mK_combined: 0.7778 [92mK_eeg: 0.7010 [92mK_eog: 0.7231 [34mF1_perclass_combined: [88.62, 13.44, 84.97, 82.23, 85.17] [34mF1_perclass_eeg: [86.5, 1.48, 79.22, 82.62, 66.55] [34mF1_perclass_eog: [84.96, 1.64, 80.9, 76.11, 84.09] 
[37mEpoch 4 step 72 with [31mce_loss_combined : 0.443177 [31mce_loss_eeg : 0.600175 [31mce_loss_eog : 0.529323 [31mtotal : 1.572675 [94mAcc_combined: 84.33 [94mAcc_eeg: 78.54 [94mAcc_eog: 81.13 [92mF1_combined: 73.02 [92mF1_eeg: 64.72 [92mF1_eog: 67.26 [92mK_combined: 0.7818 [92mK_eeg: 0.7039 [92mK_eog: 0.7352 [34mF1_perclass_combined: [89.31, 22.27, 84.9, 82.92, 85.71] [34mF1_perclass_eeg: [86.4, 8.18, 79.39, 82.76, 66.87] [34mF1_perclass_eog: [86.69, 6.14, 81.04, 77.55, 84.9] 
[37mEpoch 5 step 74 with [31mce_loss_combined : 0.439796 [31mce_loss_eeg : 0.584943 [31mce_loss_eog : 0.521986 [31mtotal : 1.546725 [94mAcc_combined: 84.77 [94mAcc_eeg: 79.50 [94mAcc_eog: 81.42 [92mF1_combined: 73.49 [92mF1_eeg: 65.58 [92mF1_eog: 67.73 [92mK_combined: 0.7865 [92mK_eeg: 0.7130 [92mK_eog: 0.7384 [34mF1_perclass_combined: [89.34, 23.88, 85.66, 82.46, 86.1] [34mF1_perclass_eeg: [86.52, 9.94, 80.77, 83.0, 67.68] [34mF1_perclass_eog: [86.33, 9.03, 82.16, 76.23, 84.88] 
[37mEpoch 6 step 90 with [31mce_loss_combined : 0.434187 [31mce_loss_eeg : 0.574188 [31mce_loss_eog : 0.521920 [31mtotal : 1.530296 [94mAcc_combined: 84.94 [94mAcc_eeg: 79.97 [94mAcc_eog: 81.38 [92mF1_combined: 74.18 [92mF1_eeg: 65.84 [92mF1_eog: 69.57 [92mK_combined: 0.7888 [92mK_eeg: 0.7175 [92mK_eog: 0.7375 [34mF1_perclass_combined: [89.44, 26.65, 85.89, 82.69, 86.24] [34mF1_perclass_eeg: [86.27, 9.97, 81.62, 82.44, 68.88] [34mF1_perclass_eog: [86.49, 18.54, 82.29, 75.03, 85.52] 
[37mEpoch 6 step 91 with [31mce_loss_combined : 0.423363 [31mce_loss_eeg : 0.588671 [31mce_loss_eog : 0.513654 [31mtotal : 1.525688 [94mAcc_combined: 85.25 [94mAcc_eeg: 79.10 [94mAcc_eog: 81.66 [92mF1_combined: 74.83 [92mF1_eeg: 65.23 [92mF1_eog: 69.81 [92mK_combined: 0.7941 [92mK_eeg: 0.7064 [92mK_eog: 0.7435 [34mF1_perclass_combined: [89.92, 28.97, 86.1, 82.75, 86.41] [34mF1_perclass_eeg: [85.81, 9.9, 80.63, 80.76, 69.05] [34mF1_perclass_eog: [86.9, 17.85, 82.16, 76.99, 85.16] 
[37mEpoch 6 step 93 with [31mce_loss_combined : 0.420836 [31mce_loss_eeg : 0.585250 [31mce_loss_eog : 0.510085 [31mtotal : 1.516170 [94mAcc_combined: 85.35 [94mAcc_eeg: 79.24 [94mAcc_eog: 81.63 [92mF1_combined: 75.69 [92mF1_eeg: 65.92 [92mF1_eog: 69.73 [92mK_combined: 0.7955 [92mK_eeg: 0.7112 [92mK_eog: 0.7418 [34mF1_perclass_combined: [89.77, 32.68, 86.31, 82.94, 86.77] [34mF1_perclass_eeg: [86.95, 11.41, 80.13, 81.83, 69.28] [34mF1_perclass_eog: [86.64, 17.7, 82.24, 76.48, 85.6] 
[37mEpoch 6 step 94 with [31mce_loss_combined : 0.419386 [31mce_loss_eeg : 0.580330 [31mce_loss_eog : 0.508875 [31mtotal : 1.508591 [94mAcc_combined: 85.41 [94mAcc_eeg: 79.47 [94mAcc_eog: 81.70 [92mF1_combined: 75.40 [92mF1_eeg: 66.08 [92mF1_eog: 69.30 [92mK_combined: 0.7965 [92mK_eeg: 0.7146 [92mK_eog: 0.7427 [34mF1_perclass_combined: [89.83, 30.86, 86.32, 83.25, 86.76] [34mF1_perclass_eeg: [86.97, 11.04, 80.33, 82.56, 69.51] [34mF1_perclass_eog: [86.78, 15.15, 82.24, 76.69, 85.65] 
[37mEpoch 6 step 95 with [31mce_loss_combined : 0.419048 [31mce_loss_eeg : 0.577633 [31mce_loss_eog : 0.508707 [31mtotal : 1.505388 [94mAcc_combined: 85.40 [94mAcc_eeg: 79.57 [94mAcc_eog: 81.72 [92mF1_combined: 75.50 [92mF1_eeg: 66.16 [92mF1_eog: 69.47 [92mK_combined: 0.7964 [92mK_eeg: 0.7160 [92mK_eog: 0.7432 [34mF1_perclass_combined: [89.75, 31.32, 86.28, 83.36, 86.79] [34mF1_perclass_eeg: [86.95, 11.02, 80.41, 82.84, 69.59] [34mF1_perclass_eog: [86.74, 15.83, 82.25, 76.87, 85.67] 
[37mEpoch 8 step 124 with [31mce_loss_combined : 0.420617 [31mce_loss_eeg : 0.548221 [31mce_loss_eog : 0.509821 [31mtotal : 1.478660 [94mAcc_combined: 85.51 [94mAcc_eeg: 80.81 [94mAcc_eog: 81.62 [92mF1_combined: 76.32 [92mF1_eeg: 67.62 [92mF1_eog: 70.42 [92mK_combined: 0.7987 [92mK_eeg: 0.7319 [92mK_eog: 0.7431 [34mF1_perclass_combined: [89.64, 34.55, 86.27, 83.89, 87.23] [34mF1_perclass_eeg: [87.21, 13.49, 81.77, 83.8, 71.85] [34mF1_perclass_eog: [86.42, 20.69, 82.18, 77.31, 85.49] 
[37mEpoch 8 step 125 with [31mce_loss_combined : 0.409120 [31mce_loss_eeg : 0.550439 [31mce_loss_eog : 0.508630 [31mtotal : 1.468189 [94mAcc_combined: 85.57 [94mAcc_eeg: 80.55 [94mAcc_eog: 81.50 [92mF1_combined: 75.43 [92mF1_eeg: 66.92 [92mF1_eog: 68.68 [92mK_combined: 0.7993 [92mK_eeg: 0.7289 [92mK_eog: 0.7405 [34mF1_perclass_combined: [90.26, 29.83, 85.83, 83.69, 87.56] [34mF1_perclass_eeg: [87.22, 11.03, 81.34, 83.28, 71.73] [34mF1_perclass_eog: [86.83, 11.18, 81.26, 78.03, 86.11] 
[37mEpoch 8 step 131 with [31mce_loss_combined : 0.411375 [31mce_loss_eeg : 0.552646 [31mce_loss_eog : 0.488033 [31mtotal : 1.452054 [94mAcc_combined: 85.78 [94mAcc_eeg: 80.59 [94mAcc_eog: 82.26 [92mF1_combined: 76.36 [92mF1_eeg: 67.40 [92mF1_eog: 70.65 [92mK_combined: 0.8020 [92mK_eeg: 0.7294 [92mK_eog: 0.7510 [34mF1_perclass_combined: [90.29, 33.94, 86.47, 83.86, 87.25] [34mF1_perclass_eeg: [87.29, 13.14, 81.65, 83.45, 71.49] [34mF1_perclass_eog: [87.71, 19.4, 82.61, 77.31, 86.2] 
[37mEpoch 8 step 132 with [31mce_loss_combined : 0.410792 [31mce_loss_eeg : 0.551822 [31mce_loss_eog : 0.487092 [31mtotal : 1.449706 [94mAcc_combined: 85.80 [94mAcc_eeg: 80.58 [94mAcc_eog: 82.34 [92mF1_combined: 76.16 [92mF1_eeg: 67.28 [92mF1_eog: 70.72 [92mK_combined: 0.8020 [92mK_eeg: 0.7286 [92mK_eog: 0.7522 [34mF1_perclass_combined: [90.28, 32.63, 86.44, 83.97, 87.46] [34mF1_perclass_eeg: [87.3, 12.8, 81.69, 83.46, 71.15] [34mF1_perclass_eog: [87.74, 19.21, 82.6, 77.79, 86.24] 
[37mEpoch 9 step 133 with [31mce_loss_combined : 0.410522 [31mce_loss_eeg : 0.546919 [31mce_loss_eog : 0.486314 [31mtotal : 1.443755 [94mAcc_combined: 85.94 [94mAcc_eeg: 80.88 [94mAcc_eog: 82.38 [92mF1_combined: 76.45 [92mF1_eeg: 67.58 [92mF1_eog: 70.70 [92mK_combined: 0.8038 [92mK_eeg: 0.7325 [92mK_eog: 0.7528 [34mF1_perclass_combined: [90.26, 33.96, 86.68, 83.92, 87.43] [34mF1_perclass_eeg: [87.35, 13.1, 82.02, 83.48, 71.97] [34mF1_perclass_eog: [87.71, 19.42, 82.81, 77.39, 86.19] 
[37mEpoch 12 step 190 with [31mce_loss_combined : 0.414645 [31mce_loss_eeg : 0.532567 [31mce_loss_eog : 0.470663 [31mtotal : 1.417876 [94mAcc_combined: 85.88 [94mAcc_eeg: 81.64 [94mAcc_eog: 82.88 [92mF1_combined: 77.31 [92mF1_eeg: 69.27 [92mF1_eog: 71.47 [92mK_combined: 0.8029 [92mK_eeg: 0.7435 [92mK_eog: 0.7599 [34mF1_perclass_combined: [90.21, 38.88, 86.83, 83.1, 87.55] [34mF1_perclass_eeg: [88.03, 17.86, 82.93, 82.57, 74.94] [34mF1_perclass_eog: [88.69, 21.31, 83.13, 77.51, 86.7] 
[37mEpoch 13 step 199 with [31mce_loss_combined : 0.410177 [31mce_loss_eeg : 0.522079 [31mce_loss_eog : 0.483120 [31mtotal : 1.415375 [94mAcc_combined: 86.19 [94mAcc_eeg: 82.15 [94mAcc_eog: 82.43 [92mF1_combined: 77.22 [92mF1_eeg: 69.11 [92mF1_eog: 70.61 [92mK_combined: 0.8068 [92mK_eeg: 0.7491 [92mK_eog: 0.7522 [34mF1_perclass_combined: [90.35, 37.35, 86.99, 83.41, 88.01] [34mF1_perclass_eeg: [88.16, 15.24, 83.32, 82.88, 75.92] [34mF1_perclass_eog: [87.95, 18.46, 82.66, 77.17, 86.82] 
{'val_loss': {'ce_loss_combined': 0.4101767, 'ce_loss_eeg': 0.5220786, 'ce_loss_eog': 0.4831197, 'total': 1.415375}, 'val_acc': {'combined': 0.8618778472242989, 'eeg': 0.8215257633302431, 'eog': 0.8243468205787653}, 'val_f1': {'combined': 0.7722226346020478, 'eeg': 0.6910538507470027, 'eog': 0.7061232924300036}, 'val_k': {'combined': 0.8068201582774124, 'eeg': 0.7491114433770456, 'eog': 0.7521772739544643}, 'val_perclassf1': {'combined': array([0.90349249, 0.37353946, 0.86988591, 0.83409697, 0.88009835]), 'eeg': array([0.88157781, 0.15240275, 0.83321689, 0.82884675, 0.75922506]), 'eog': array([0.87950279, 0.18460854, 0.82664395, 0.77165301, 0.86820818])}}
We are in the final state.
 THE Configuration of your experiment ..
{'agent': 'Sleep_Agent_Init_Train',
 'augmentation': {},
 'channel': 0,
 'dataset': {'cache_datasets': {'test': False, 'train': False, 'valid': False},
             'data_roots': '/esat/biomeddata/SHHS_Dataset/no_backup',
             'data_split': {'split_method': 'patients_test',
                            'test_split_rate': 0.3,
                            'val_split_rate': 0.026},
             'data_view_dir': [{'data_type': 'stft',
                                'list_dir': 'patient_mat_list.txt',
                                'mod': 'eeg',
                                'num_ch': 1},
                               {'data_type': 'stft',
                                'list_dir': 'patient_eog_mat_list.txt',
                                'mod': 'eog',
                                'num_ch': 1}],
             'dataloader_class': 'SleepDataLoader_mat_huy',
             'filter_windows': {'test': {'perc_threshold': 0.4,
                                         'skip_skips': True,
                                         'std_threshold': 41,
                                         'use_type': 'include_only_skipped',
                                         'whole_patient': False},
                                'train': {'perc_threshold': 0.4,
                                          'skip_skips': False,
                                          'std_threshold': 41,
                                          'subsets': {'combined': 100,
                                                      'eeg': 0,
                                                      'eog': 400},
                                          'use_type': 'subsample',
                                          'whole_patient': True},
                                'val': {'skip_skips': True,
                                        'use_type': False,
                                        'whole_patient': False}},
             'huy_data': True,
             'inner_overlap': [0.5, 0.5],
             'keep_view': [1, 0],
             'seq_length': [21, 0],
             'seq_views': [False],
             'shuffle_train': True},
 'early_stopping': {'log_interval': 10,
                    'max_epoch': 1000,
                    'n_steps_stop': 100,
                    'n_steps_stop_after': 50,
                    'save_every': 1,
                    'validate_after': 0,
                    'validate_every': 50},
 'exp_name': 'Sleep EEG-EOG BLIP Experiment',
 'lr_finder': False,
 'lr_finder_steps': 100,
 'mode': 'train',
 'model': {'args': {'augment_within': False,
                    'dmodel': 128,
                    'dropout': 0.3,
                    'fc_inner': 1024,
                    'ignore_alignment_val': True,
                    'multi_loss': {'multi_loss_weights': {'alignment_loss': 0.1,
                                                          'multi_supervised_loss': {'combined': 1,
                                                                                    'eeg': 1,
                                                                                    'eog': 1},
                                                          'order_loss': 0}},
                    'num_classes': 5,
                    'three_modes': True,
                    'training_type': 'alignment_order_multisupervised'},
           'encoders': [{'args': {'align_inner': True,
                                  'd_model': 128,
                                  'dim_feedforward': 1024,
                                  'dim_proj': 128,
                                  'dropout': 0.3,
                                  'inner_biased': False,
                                  'mod_token': False,
                                  'num_heads': 8,
                                  'num_layers': 4,
                                  'outer_biased': False,
                                  'outer_rep': False,
                                  'pos': False,
                                  'rpos': True,
                                  'shared': True,
                                  'skip_random_mod': False},
                         'encoders': [],
                         'freeze_encoder': False,
                         'model': 'SleepEnc_BLIP_EEG_EOG_shared_free_cliplike',
                         'pretrainedEncoder': {'dir': '', 'use': False},
                         'savetrainedEncoder': {'dir': '', 'save': False}}],
           'load_ongoing': False,
           'model_class': 'EEG_SLEEP_BLIP_GM_MultiMode',
           'pretrained_model': {'dir': '', 'use': False},
           'save_dir': '/esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2021_data/shhs1/multi_modal/paper_models/fourier_transformer_eeg_eog_mat_BLIP_al01_shared_b16_freetrain_rpos_nopos_nonsharedpreds_drop03_align_inner_trial1_pt_incomplete_100p_0e_400o.pth.tar'},
 'normalization': {'calculate_metrics': False,
                   'dir': '/esat/biomeddata/SHHS_Dataset/no_backup/metrics_eeg_eog_emg_stft.pkl',
                   'metrics_type': 'train_dataset',
                   'save_metrics': False,
                   'use': True},
 'num_classes': 5,
 'num_modalities': 1,
 'optimizer': {'beta1': 0.9,
               'beta2': 0.999,
               'learning_rate': 0.0001,
               'momentum': 0.2,
               'type': 'Adam',
               'weight_decay': 0.0001},
 'plots': {'plot_stft_num': 0, 'save': False},
 'post_proc': {'post_proc_step': 15,
               'test_postprocessing': False,
               'val_postprocessing': False},
 'scheduler': {'max_lr': 0.03, 'type': 'cosanneal', 'warm_up': 55},
 'statistics': {'ce_weights': {'temp': 0.1, 'use': False}, 'print': False},
 'training_params': {'adversarial_training': {'adv_epsilon': 0.01,
                                              'use': False},
                     'async_loading': True,
                     'batch_size': 32,
                     'cuda': False,
                     'data_loader_workers': 8,
                     'gpu_device': [0],
                     'pin_memory': True,
                     'rec_test': False,
                     'res': True,
                     'seed': 28,
                     'tdqm_disable': True,
                     'test_batch_size': 32,
                     'test_on_tops': True,
                     'use_test_set': True,
                     'validation': True,
                     'verbose': True,
                     'wandb_disable': True}}
 *************************************** 
The experiment name is Sleep EEG-EOG BLIP Experiment
 *************************************** 
stft_eeg Train 3724 validation 100 test 1639
stft_eog Train 3724 validation 100 test 1639
{'use_type': 'subsample', 'skip_skips': False, 'whole_patient': True, 'std_threshold': 41, 'perc_threshold': 0.4, 'subsets': {'combined': 100, 'eeg': 0, 'eog': 400}}
We subsample patients with 100 both mods, 0 only EEG and 400 only EOG and len_skipped is 500.
{'use_type': False, 'skip_skips': True, 'whole_patient': False}
{'use_type': 'include_only_skipped', 'skip_skips': True, 'whole_patient': False, 'std_threshold': 41, 'perc_threshold': 0.4}
Patients with broken modalities are 24
{'use_type': False, 'skip_skips': True}
Loading metrics from /esat/biomeddata/SHHS_Dataset/no_backup/metrics_eeg_eog_emg_stft.pkl
Weights are [1. 1. 1. 1. 1.]
738
50
15
tensor([1., 1., 1., 1., 1.], device='cuda:0')
We are not shuffling the data
Training function is sleep_train_one_step_alignment_order_multisupervised
Loss Weights are {'combined': 1, 'eeg': 1, 'eog': 1, 'alignments': 0.1, 'order': 0, 'consistency': 0, 'reconstruction': 0}
We are not shuffling the data
<class 'graphs.models.attention_models.BLIP.SleepEnc_BLIP_EEG_EOG_shared_free_cliplike'>
Total number of trainable parameters are: 7628293
Available cuda devices: 1, current device:0
Total number of trainable parameters are: 7628293
[37mEpoch 0 step 1 with [31mce_loss_combined : 1.235217 [31mce_loss_eeg : 1.300493 [31mce_loss_eog : 1.128141 [31mtotal : 3.663852 [94mAcc_combined: 55.97 [94mAcc_eeg: 50.29 [94mAcc_eog: 57.77 [92mF1_combined: 27.66 [92mF1_eeg: 23.87 [92mF1_eog: 33.27 [92mK_combined: 0.3011 [92mK_eeg: 0.1990 [92mK_eog: 0.3542 [34mF1_perclass_combined: [73.21, 0.0, 64.99, 0.0, 0.09] [34mF1_perclass_eeg: [58.2, 0.0, 61.15, 0.0, 0.0] [34mF1_perclass_eog: [68.24, 0.0, 67.92, 19.2, 10.99] 
[37mEpoch 0 step 3 with [31mce_loss_combined : 0.871189 [31mce_loss_eeg : 0.987926 [31mce_loss_eog : 0.877933 [31mtotal : 2.737048 [94mAcc_combined: 66.03 [94mAcc_eeg: 59.73 [94mAcc_eog: 66.87 [92mF1_combined: 50.89 [92mF1_eeg: 29.37 [92mF1_eog: 51.09 [92mK_combined: 0.5171 [92mK_eeg: 0.3771 [92mK_eog: 0.5262 [34mF1_perclass_combined: [74.57, 0.0, 71.28, 65.2, 43.43] [34mF1_perclass_eeg: [79.21, 0.0, 67.62, 0.0, 0.0] [34mF1_perclass_eog: [73.97, 0.0, 74.07, 61.32, 46.12] 
[37mEpoch 0 step 7 with [31mce_loss_combined : 0.834711 [31mce_loss_eeg : 1.063593 [31mce_loss_eog : 0.811275 [31mtotal : 2.709579 [94mAcc_combined: 67.59 [94mAcc_eeg: 58.56 [94mAcc_eog: 68.62 [92mF1_combined: 48.11 [92mF1_eeg: 37.59 [92mF1_eog: 50.18 [92mK_combined: 0.5287 [92mK_eeg: 0.3997 [92mK_eog: 0.5364 [34mF1_perclass_combined: [76.63, 0.0, 73.27, 27.35, 63.32] [34mF1_perclass_eeg: [60.53, 0.0, 70.89, 56.53, 0.0] [34mF1_perclass_eog: [76.96, 0.0, 74.36, 42.1, 57.48] 
[37mEpoch 0 step 8 with [31mce_loss_combined : 0.791306 [31mce_loss_eeg : 0.913248 [31mce_loss_eog : 0.746072 [31mtotal : 2.450626 [94mAcc_combined: 70.22 [94mAcc_eeg: 59.48 [94mAcc_eog: 72.93 [92mF1_combined: 53.20 [92mF1_eeg: 34.40 [92mF1_eog: 56.90 [92mK_combined: 0.5687 [92mK_eeg: 0.3955 [92mK_eog: 0.6097 [34mF1_perclass_combined: [77.69, 0.0, 75.11, 52.85, 60.35] [34mF1_perclass_eeg: [71.14, 0.0, 70.15, 10.63, 20.06] [34mF1_perclass_eog: [78.58, 0.0, 76.88, 64.38, 64.66] 
[37mEpoch 0 step 9 with [31mce_loss_combined : 0.744994 [31mce_loss_eeg : 0.962125 [31mce_loss_eog : 0.731484 [31mtotal : 2.438603 [94mAcc_combined: 72.20 [94mAcc_eeg: 56.88 [94mAcc_eog: 73.35 [92mF1_combined: 55.22 [92mF1_eeg: 28.18 [92mF1_eog: 59.55 [92mK_combined: 0.6002 [92mK_eeg: 0.3457 [92mK_eog: 0.6240 [34mF1_perclass_combined: [80.97, 0.0, 74.72, 74.92, 45.47] [34mF1_perclass_eeg: [70.35, 0.0, 69.09, 1.45, 0.0] [34mF1_perclass_eog: [77.03, 0.0, 74.57, 74.0, 72.16] 
[37mEpoch 0 step 10 with [31mce_loss_combined : 0.669642 [31mce_loss_eeg : 0.858947 [31mce_loss_eog : 0.694895 [31mtotal : 2.223484 [94mAcc_combined: 75.81 [94mAcc_eeg: 68.31 [94mAcc_eog: 74.63 [92mF1_combined: 60.12 [92mF1_eeg: 53.67 [92mF1_eog: 58.94 [92mK_combined: 0.6550 [92mK_eeg: 0.5590 [92mK_eog: 0.6343 [34mF1_perclass_combined: [80.68, 0.0, 79.0, 72.51, 68.39] [34mF1_perclass_eeg: [78.42, 0.0, 70.12, 64.17, 55.62] [34mF1_perclass_eog: [80.63, 0.0, 77.37, 63.94, 72.74] 
[37mEpoch 1 step 16 with [31mce_loss_combined : 0.617987 [31mce_loss_eeg : 0.802176 [31mce_loss_eog : 0.694186 [31mtotal : 2.114349 [94mAcc_combined: 77.15 [94mAcc_eeg: 68.53 [94mAcc_eog: 75.64 [92mF1_combined: 61.22 [92mF1_eeg: 46.87 [92mF1_eog: 60.07 [92mK_combined: 0.6727 [92mK_eeg: 0.5438 [92mK_eog: 0.6529 [34mF1_perclass_combined: [83.84, 0.0, 79.19, 74.55, 68.53] [34mF1_perclass_eeg: [84.07, 0.0, 69.68, 76.75, 3.82] [34mF1_perclass_eog: [80.23, 0.0, 78.09, 64.47, 77.58] 
[37mEpoch 1 step 20 with [31mce_loss_combined : 0.561658 [31mce_loss_eeg : 0.800758 [31mce_loss_eog : 0.667754 [31mtotal : 2.030170 [94mAcc_combined: 79.79 [94mAcc_eeg: 68.86 [94mAcc_eog: 75.60 [92mF1_combined: 64.25 [92mF1_eeg: 51.98 [92mF1_eog: 60.48 [92mK_combined: 0.7155 [92mK_eeg: 0.5609 [92mK_eog: 0.6532 [34mF1_perclass_combined: [84.99, 0.0, 80.83, 74.84, 80.59] [34mF1_perclass_eeg: [84.03, 0.0, 70.04, 44.28, 61.55] [34mF1_perclass_eog: [79.42, 0.0, 78.02, 71.44, 73.49] 
[37mEpoch 1 step 21 with [31mce_loss_combined : 0.517779 [31mce_loss_eeg : 0.762253 [31mce_loss_eog : 0.624334 [31mtotal : 1.904366 [94mAcc_combined: 81.32 [94mAcc_eeg: 70.36 [94mAcc_eog: 76.78 [92mF1_combined: 65.40 [92mF1_eeg: 50.61 [92mF1_eog: 60.67 [92mK_combined: 0.7347 [92mK_eeg: 0.5618 [92mK_eog: 0.6686 [34mF1_perclass_combined: [88.01, 0.0, 82.37, 76.84, 79.75] [34mF1_perclass_eeg: [84.62, 0.0, 73.82, 66.88, 27.75] [34mF1_perclass_eog: [82.77, 0.0, 78.9, 61.71, 79.96] 
[37mEpoch 1 step 22 with [31mce_loss_combined : 0.501237 [31mce_loss_eeg : 0.724868 [31mce_loss_eog : 0.609780 [31mtotal : 1.835884 [94mAcc_combined: 82.38 [94mAcc_eeg: 73.67 [94mAcc_eog: 78.48 [92mF1_combined: 66.75 [92mF1_eeg: 57.78 [92mF1_eog: 63.61 [92mK_combined: 0.7521 [92mK_eeg: 0.6287 [92mK_eog: 0.6986 [34mF1_perclass_combined: [89.08, 0.11, 82.62, 80.09, 81.87] [34mF1_perclass_eeg: [85.85, 0.0, 75.05, 78.19, 49.81] [34mF1_perclass_eog: [82.98, 0.0, 79.42, 77.12, 78.51] 
[37mEpoch 2 step 37 with [31mce_loss_combined : 0.511914 [31mce_loss_eeg : 0.715280 [31mce_loss_eog : 0.587233 [31mtotal : 1.814427 [94mAcc_combined: 80.98 [94mAcc_eeg: 75.85 [94mAcc_eog: 78.37 [92mF1_combined: 66.03 [92mF1_eeg: 60.64 [92mF1_eog: 62.48 [92mK_combined: 0.7260 [92mK_eeg: 0.6587 [92mK_eog: 0.6887 [34mF1_perclass_combined: [88.6, 3.62, 81.69, 74.52, 81.71] [34mF1_perclass_eeg: [83.07, 0.16, 78.95, 81.3, 59.7] [34mF1_perclass_eog: [84.91, 1.79, 79.9, 62.58, 83.23] 
[37mEpoch 2 step 38 with [31mce_loss_combined : 0.524774 [31mce_loss_eeg : 0.691112 [31mce_loss_eog : 0.594839 [31mtotal : 1.810725 [94mAcc_combined: 80.70 [94mAcc_eeg: 75.06 [94mAcc_eog: 78.67 [92mF1_combined: 67.12 [92mF1_eeg: 60.57 [92mF1_eog: 64.29 [92mK_combined: 0.7344 [92mK_eeg: 0.6603 [92mK_eog: 0.7034 [34mF1_perclass_combined: [87.06, 8.16, 80.84, 78.79, 80.76] [34mF1_perclass_eeg: [83.7, 0.9, 74.73, 80.43, 63.1] [34mF1_perclass_eog: [84.74, 0.38, 77.87, 76.77, 81.69] 
[37mEpoch 2 step 39 with [31mce_loss_combined : 0.443696 [31mce_loss_eeg : 0.668092 [31mce_loss_eog : 0.548152 [31mtotal : 1.659941 [94mAcc_combined: 83.50 [94mAcc_eeg: 77.42 [94mAcc_eog: 80.02 [92mF1_combined: 69.23 [92mF1_eeg: 62.15 [92mF1_eog: 64.71 [92mK_combined: 0.7677 [92mK_eeg: 0.6841 [92mK_eog: 0.7160 [34mF1_perclass_combined: [89.41, 8.12, 84.1, 80.73, 83.8] [34mF1_perclass_eeg: [84.4, 1.11, 79.21, 80.63, 65.41] [34mF1_perclass_eog: [85.22, 0.27, 80.81, 73.58, 83.66] 
[37mEpoch 3 step 52 with [31mce_loss_combined : 0.417663 [31mce_loss_eeg : 0.642837 [31mce_loss_eog : 0.547367 [31mtotal : 1.607867 [94mAcc_combined: 84.84 [94mAcc_eeg: 78.73 [94mAcc_eog: 79.93 [92mF1_combined: 71.26 [92mF1_eeg: 63.63 [92mF1_eog: 65.47 [92mK_combined: 0.7872 [92mK_eeg: 0.7031 [92mK_eog: 0.7184 [34mF1_perclass_combined: [90.79, 11.86, 85.23, 82.04, 86.39] [34mF1_perclass_eeg: [86.03, 1.07, 80.6, 81.57, 68.87] [34mF1_perclass_eog: [84.22, 4.08, 80.71, 74.18, 84.15] 
[37mEpoch 3 step 54 with [31mce_loss_combined : 0.410570 [31mce_loss_eeg : 0.650018 [31mce_loss_eog : 0.513615 [31mtotal : 1.574203 [94mAcc_combined: 84.91 [94mAcc_eeg: 78.52 [94mAcc_eog: 80.98 [92mF1_combined: 73.14 [92mF1_eeg: 64.44 [92mF1_eog: 65.61 [92mK_combined: 0.7883 [92mK_eeg: 0.7002 [92mK_eog: 0.7298 [34mF1_perclass_combined: [90.77, 21.75, 85.55, 81.68, 85.97] [34mF1_perclass_eeg: [85.0, 7.21, 80.39, 81.89, 67.72] [34mF1_perclass_eog: [86.18, 1.7, 81.86, 72.83, 85.47] 
[37mEpoch 4 step 60 with [31mce_loss_combined : 0.423717 [31mce_loss_eeg : 0.636802 [31mce_loss_eog : 0.513183 [31mtotal : 1.573702 [94mAcc_combined: 84.72 [94mAcc_eeg: 77.91 [94mAcc_eog: 81.19 [92mF1_combined: 69.28 [92mF1_eeg: 61.66 [92mF1_eog: 66.09 [92mK_combined: 0.7866 [92mK_eeg: 0.6868 [92mK_eog: 0.7347 [34mF1_perclass_combined: [90.42, 2.08, 84.78, 82.73, 86.37] [34mF1_perclass_eeg: [85.21, 0.0, 79.7, 82.31, 61.09] [34mF1_perclass_eog: [85.95, 0.7, 81.45, 76.93, 85.42] 
[37mEpoch 4 step 64 with [31mce_loss_combined : 0.425843 [31mce_loss_eeg : 0.636446 [31mce_loss_eog : 0.500014 [31mtotal : 1.562303 [94mAcc_combined: 84.48 [94mAcc_eeg: 78.30 [94mAcc_eog: 81.85 [92mF1_combined: 71.29 [92mF1_eeg: 62.91 [92mF1_eog: 67.60 [92mK_combined: 0.7861 [92mK_eeg: 0.6929 [92mK_eog: 0.7472 [34mF1_perclass_combined: [90.85, 13.16, 84.15, 82.05, 86.26] [34mF1_perclass_eeg: [86.87, 3.02, 79.35, 82.41, 62.94] [34mF1_perclass_eog: [86.25, 4.79, 82.0, 78.99, 85.97] 
[37mEpoch 4 step 65 with [31mce_loss_combined : 0.416360 [31mce_loss_eeg : 0.631927 [31mce_loss_eog : 0.492269 [31mtotal : 1.540556 [94mAcc_combined: 84.90 [94mAcc_eeg: 78.55 [94mAcc_eog: 82.08 [92mF1_combined: 71.74 [92mF1_eeg: 63.19 [92mF1_eog: 67.73 [92mK_combined: 0.7909 [92mK_eeg: 0.6963 [92mK_eog: 0.7486 [34mF1_perclass_combined: [90.84, 13.95, 84.88, 82.7, 86.35] [34mF1_perclass_eeg: [86.88, 3.21, 79.73, 82.49, 63.66] [34mF1_perclass_eog: [86.52, 4.88, 82.4, 78.42, 86.41] 
[37mEpoch 4 step 73 with [31mce_loss_combined : 0.412009 [31mce_loss_eeg : 0.630568 [31mce_loss_eog : 0.492800 [31mtotal : 1.535377 [94mAcc_combined: 85.00 [94mAcc_eeg: 79.17 [94mAcc_eog: 82.04 [92mF1_combined: 73.47 [92mF1_eeg: 64.17 [92mF1_eog: 68.09 [92mK_combined: 0.7909 [92mK_eeg: 0.7103 [92mK_eog: 0.7485 [34mF1_perclass_combined: [90.14, 22.71, 85.59, 82.02, 86.92] [34mF1_perclass_eeg: [85.4, 2.05, 80.55, 81.7, 71.15] [34mF1_perclass_eog: [86.78, 7.39, 82.26, 77.9, 86.12] 
[37mEpoch 5 step 74 with [31mce_loss_combined : 0.409325 [31mce_loss_eeg : 0.630428 [31mce_loss_eog : 0.488614 [31mtotal : 1.528366 [94mAcc_combined: 84.91 [94mAcc_eeg: 79.16 [94mAcc_eog: 82.03 [92mF1_combined: 72.19 [92mF1_eeg: 63.91 [92mF1_eog: 67.53 [92mK_combined: 0.7890 [92mK_eeg: 0.7083 [92mK_eog: 0.7482 [34mF1_perclass_combined: [89.42, 16.83, 85.9, 82.57, 86.23] [34mF1_perclass_eeg: [84.62, 1.94, 81.19, 81.87, 69.92] [34mF1_perclass_eog: [86.62, 3.78, 82.09, 79.0, 86.18] 
[37mEpoch 5 step 75 with [31mce_loss_combined : 0.396577 [31mce_loss_eeg : 0.617937 [31mce_loss_eog : 0.484885 [31mtotal : 1.499399 [94mAcc_combined: 85.40 [94mAcc_eeg: 79.70 [94mAcc_eog: 82.10 [92mF1_combined: 72.52 [92mF1_eeg: 64.41 [92mF1_eog: 67.58 [92mK_combined: 0.7958 [92mK_eeg: 0.7159 [92mK_eog: 0.7487 [34mF1_perclass_combined: [90.45, 16.39, 85.99, 82.9, 86.86] [34mF1_perclass_eeg: [85.48, 2.0, 81.46, 82.5, 70.6] [34mF1_perclass_eog: [86.85, 3.62, 82.06, 78.86, 86.53] 
[37mEpoch 5 step 87 with [31mce_loss_combined : 0.385996 [31mce_loss_eeg : 0.612713 [31mce_loss_eog : 0.493388 [31mtotal : 1.492097 [94mAcc_combined: 85.95 [94mAcc_eeg: 79.64 [94mAcc_eog: 81.78 [92mF1_combined: 75.39 [92mF1_eeg: 65.21 [92mF1_eog: 68.88 [92mK_combined: 0.8047 [92mK_eeg: 0.7183 [92mK_eog: 0.7452 [34mF1_perclass_combined: [91.61, 27.81, 86.05, 83.57, 87.92] [34mF1_perclass_eeg: [85.96, 4.81, 80.87, 83.04, 71.37] [34mF1_perclass_eog: [86.87, 10.87, 81.56, 79.24, 85.87] 
[37mEpoch 6 step 89 with [31mce_loss_combined : 0.391479 [31mce_loss_eeg : 0.596822 [31mce_loss_eog : 0.482701 [31mtotal : 1.471002 [94mAcc_combined: 85.81 [94mAcc_eeg: 79.81 [94mAcc_eog: 82.06 [92mF1_combined: 71.73 [92mF1_eeg: 64.03 [92mF1_eog: 67.69 [92mK_combined: 0.8009 [92mK_eeg: 0.7142 [92mK_eog: 0.7472 [34mF1_perclass_combined: [91.55, 9.87, 85.77, 83.84, 87.6] [34mF1_perclass_eeg: [86.9, 1.18, 81.16, 83.41, 67.49] [34mF1_perclass_eog: [86.93, 4.54, 82.09, 78.37, 86.5] 
[37mEpoch 6 step 91 with [31mce_loss_combined : 0.381482 [31mce_loss_eeg : 0.591062 [31mce_loss_eog : 0.480154 [31mtotal : 1.452698 [94mAcc_combined: 85.91 [94mAcc_eeg: 80.60 [94mAcc_eog: 82.22 [92mF1_combined: 73.24 [92mF1_eeg: 65.65 [92mF1_eog: 68.41 [92mK_combined: 0.8043 [92mK_eeg: 0.7301 [92mK_eog: 0.7518 [34mF1_perclass_combined: [91.62, 17.09, 85.78, 83.72, 87.99] [34mF1_perclass_eeg: [87.07, 2.93, 81.51, 83.65, 73.07] [34mF1_perclass_eog: [87.02, 7.85, 82.29, 79.11, 85.77] 
[37mEpoch 6 step 92 with [31mce_loss_combined : 0.380311 [31mce_loss_eeg : 0.595672 [31mce_loss_eog : 0.473899 [31mtotal : 1.449883 [94mAcc_combined: 85.87 [94mAcc_eeg: 80.08 [94mAcc_eog: 82.35 [92mF1_combined: 73.59 [92mF1_eeg: 65.30 [92mF1_eog: 68.79 [92mK_combined: 0.8013 [92mK_eeg: 0.7213 [92mK_eog: 0.7514 [34mF1_perclass_combined: [91.27, 20.7, 86.46, 81.6, 87.93] [34mF1_perclass_eeg: [87.08, 4.24, 81.44, 80.42, 73.31] [34mF1_perclass_eog: [87.05, 10.56, 82.9, 76.81, 86.62] 
[37mEpoch 6 step 93 with [31mce_loss_combined : 0.376774 [31mce_loss_eeg : 0.586148 [31mce_loss_eog : 0.469911 [31mtotal : 1.432833 [94mAcc_combined: 86.09 [94mAcc_eeg: 80.52 [94mAcc_eog: 82.51 [92mF1_combined: 73.76 [92mF1_eeg: 65.79 [92mF1_eog: 69.15 [92mK_combined: 0.8044 [92mK_eeg: 0.7257 [92mK_eog: 0.7534 [34mF1_perclass_combined: [91.45, 20.06, 86.58, 82.97, 87.76] [34mF1_perclass_eeg: [87.26, 5.36, 81.98, 81.93, 72.45] [34mF1_perclass_eog: [87.15, 11.16, 82.98, 77.81, 86.64] 
[37mEpoch 6 step 94 with [31mce_loss_combined : 0.373015 [31mce_loss_eeg : 0.583081 [31mce_loss_eog : 0.466753 [31mtotal : 1.422849 [94mAcc_combined: 86.21 [94mAcc_eeg: 80.72 [94mAcc_eog: 82.65 [92mF1_combined: 74.31 [92mF1_eeg: 66.22 [92mF1_eog: 69.74 [92mK_combined: 0.8073 [92mK_eeg: 0.7296 [92mK_eog: 0.7568 [34mF1_perclass_combined: [91.64, 21.73, 86.43, 83.67, 88.07] [34mF1_perclass_eeg: [87.38, 6.2, 81.97, 83.0, 72.56] [34mF1_perclass_eog: [87.29, 12.8, 82.84, 78.99, 86.8] 
[37mEpoch 8 step 124 with [31mce_loss_combined : 0.370980 [31mce_loss_eeg : 0.584970 [31mce_loss_eog : 0.464103 [31mtotal : 1.420053 [94mAcc_combined: 86.45 [94mAcc_eeg: 80.68 [94mAcc_eog: 82.93 [92mF1_combined: 76.49 [92mF1_eeg: 67.75 [92mF1_eog: 71.54 [92mK_combined: 0.8111 [92mK_eeg: 0.7287 [92mK_eog: 0.7610 [34mF1_perclass_combined: [92.0, 31.85, 86.67, 84.04, 87.87] [34mF1_perclass_eeg: [87.32, 14.08, 82.02, 83.14, 72.18] [34mF1_perclass_eog: [88.13, 20.03, 82.87, 79.94, 86.72] 
[37mEpoch 8 step 126 with [31mce_loss_combined : 0.360807 [31mce_loss_eeg : 0.579073 [31mce_loss_eog : 0.454630 [31mtotal : 1.394509 [94mAcc_combined: 86.73 [94mAcc_eeg: 80.95 [94mAcc_eog: 82.76 [92mF1_combined: 76.43 [92mF1_eeg: 67.39 [92mF1_eog: 71.35 [92mK_combined: 0.8141 [92mK_eeg: 0.7321 [92mK_eog: 0.7562 [34mF1_perclass_combined: [91.99, 30.98, 87.29, 83.42, 88.46] [34mF1_perclass_eeg: [87.69, 11.22, 82.21, 82.75, 73.07] [34mF1_perclass_eog: [88.17, 22.09, 83.29, 75.81, 87.39] 
[37mEpoch 8 step 127 with [31mce_loss_combined : 0.361728 [31mce_loss_eeg : 0.575369 [31mce_loss_eog : 0.452666 [31mtotal : 1.389762 [94mAcc_combined: 86.64 [94mAcc_eeg: 81.20 [94mAcc_eog: 83.19 [92mF1_combined: 76.01 [92mF1_eeg: 67.74 [92mF1_eog: 71.25 [92mK_combined: 0.8140 [92mK_eeg: 0.7372 [92mK_eog: 0.7646 [34mF1_perclass_combined: [91.99, 28.62, 86.91, 84.02, 88.49] [34mF1_perclass_eeg: [87.68, 11.33, 82.33, 83.57, 73.78] [34mF1_perclass_eog: [88.13, 17.5, 83.15, 79.99, 87.47] 
[37mEpoch 8 step 128 with [31mce_loss_combined : 0.358954 [31mce_loss_eeg : 0.576134 [31mce_loss_eog : 0.448332 [31mtotal : 1.383420 [94mAcc_combined: 86.78 [94mAcc_eeg: 81.17 [94mAcc_eog: 83.24 [92mF1_combined: 76.61 [92mF1_eeg: 68.10 [92mF1_eog: 71.39 [92mK_combined: 0.8157 [92mK_eeg: 0.7371 [92mK_eog: 0.7646 [34mF1_perclass_combined: [91.77, 31.38, 87.33, 84.04, 88.54] [34mF1_perclass_eeg: [87.54, 13.18, 82.43, 83.21, 74.15] [34mF1_perclass_eog: [88.1, 18.92, 83.53, 78.89, 87.5] 
[37mEpoch 8 step 129 with [31mce_loss_combined : 0.360146 [31mce_loss_eeg : 0.575241 [31mce_loss_eog : 0.446361 [31mtotal : 1.381748 [94mAcc_combined: 86.70 [94mAcc_eeg: 81.28 [94mAcc_eog: 83.32 [92mF1_combined: 76.61 [92mF1_eeg: 68.10 [92mF1_eog: 71.63 [92mK_combined: 0.8154 [92mK_eeg: 0.7390 [92mK_eog: 0.7666 [34mF1_perclass_combined: [91.87, 31.36, 87.06, 84.08, 88.7] [34mF1_perclass_eeg: [87.72, 12.62, 82.39, 83.9, 73.85] [34mF1_perclass_eog: [88.2, 19.26, 83.42, 79.53, 87.72] 
[37mEpoch 8 step 130 with [31mce_loss_combined : 0.353830 [31mce_loss_eeg : 0.574268 [31mce_loss_eog : 0.449476 [31mtotal : 1.377574 [94mAcc_combined: 86.85 [94mAcc_eeg: 81.31 [94mAcc_eog: 83.03 [92mF1_combined: 77.23 [92mF1_eeg: 68.17 [92mF1_eog: 71.99 [92mK_combined: 0.8179 [92mK_eeg: 0.7410 [92mK_eog: 0.7621 [34mF1_perclass_combined: [92.29, 33.53, 87.0, 84.3, 89.05] [34mF1_perclass_eeg: [88.07, 12.16, 82.02, 83.83, 74.77] [34mF1_perclass_eog: [88.28, 23.64, 83.48, 77.19, 87.39] 
[37mEpoch 8 step 132 with [31mce_loss_combined : 0.357142 [31mce_loss_eeg : 0.571977 [31mce_loss_eog : 0.443646 [31mtotal : 1.372766 [94mAcc_combined: 86.82 [94mAcc_eeg: 81.48 [94mAcc_eog: 83.34 [92mF1_combined: 76.92 [92mF1_eeg: 68.23 [92mF1_eog: 71.79 [92mK_combined: 0.8168 [92mK_eeg: 0.7419 [92mK_eog: 0.7670 [34mF1_perclass_combined: [91.92, 32.41, 87.14, 84.22, 88.92] [34mF1_perclass_eeg: [87.92, 12.21, 82.52, 83.88, 74.6] [34mF1_perclass_eog: [88.21, 20.32, 83.49, 79.1, 87.82] 
[37mEpoch 9 step 134 with [31mce_loss_combined : 0.357402 [31mce_loss_eeg : 0.571427 [31mce_loss_eog : 0.442825 [31mtotal : 1.371654 [94mAcc_combined: 86.82 [94mAcc_eeg: 81.45 [94mAcc_eog: 83.35 [92mF1_combined: 76.71 [92mF1_eeg: 68.14 [92mF1_eog: 71.53 [92mK_combined: 0.8166 [92mK_eeg: 0.7410 [92mK_eog: 0.7670 [34mF1_perclass_combined: [91.99, 31.39, 87.16, 84.15, 88.88] [34mF1_perclass_eeg: [87.86, 12.07, 82.55, 83.72, 74.52] [34mF1_perclass_eog: [88.27, 18.77, 83.47, 79.3, 87.83] 
[37mEpoch 12 step 185 with [31mce_loss_combined : 0.359393 [31mce_loss_eeg : 0.559076 [31mce_loss_eog : 0.449647 [31mtotal : 1.368116 [94mAcc_combined: 86.67 [94mAcc_eeg: 81.77 [94mAcc_eog: 82.87 [92mF1_combined: 77.50 [92mF1_eeg: 68.81 [92mF1_eog: 71.85 [92mK_combined: 0.8134 [92mK_eeg: 0.7443 [92mK_eog: 0.7581 [34mF1_perclass_combined: [92.06, 37.5, 87.49, 81.86, 88.62] [34mF1_perclass_eeg: [88.45, 14.62, 83.16, 80.76, 77.05] [34mF1_perclass_eog: [88.47, 24.97, 83.58, 74.99, 87.25] 
[37mEpoch 12 step 186 with [31mce_loss_combined : 0.355595 [31mce_loss_eeg : 0.551563 [31mce_loss_eog : 0.447742 [31mtotal : 1.354899 [94mAcc_combined: 86.87 [94mAcc_eeg: 82.34 [94mAcc_eog: 83.41 [92mF1_combined: 76.96 [92mF1_eeg: 69.42 [92mF1_eog: 70.89 [92mK_combined: 0.8172 [92mK_eeg: 0.7544 [92mK_eog: 0.7671 [34mF1_perclass_combined: [92.03, 32.74, 87.29, 84.38, 88.34] [34mF1_perclass_eeg: [88.5, 14.14, 83.36, 83.87, 77.24] [34mF1_perclass_eog: [88.45, 15.17, 83.44, 80.15, 87.26] 
[37mEpoch 13 step 196 with [31mce_loss_combined : 0.358469 [31mce_loss_eeg : 0.563892 [31mce_loss_eog : 0.430632 [31mtotal : 1.352993 [94mAcc_combined: 87.03 [94mAcc_eeg: 81.22 [94mAcc_eog: 83.73 [92mF1_combined: 76.70 [92mF1_eeg: 67.86 [92mF1_eog: 71.75 [92mK_combined: 0.8183 [92mK_eeg: 0.7346 [92mK_eog: 0.7723 [34mF1_perclass_combined: [92.24, 31.33, 87.67, 83.83, 88.43] [34mF1_perclass_eeg: [87.59, 12.87, 82.8, 81.56, 74.47] [34mF1_perclass_eog: [88.73, 18.55, 83.87, 79.95, 87.63] 
[37mEpoch 13 step 197 with [31mce_loss_combined : 0.355678 [31mce_loss_eeg : 0.556587 [31mce_loss_eog : 0.433839 [31mtotal : 1.346104 [94mAcc_combined: 86.73 [94mAcc_eeg: 81.93 [94mAcc_eog: 83.65 [92mF1_combined: 77.80 [92mF1_eeg: 69.20 [92mF1_eog: 72.85 [92mK_combined: 0.8174 [92mK_eeg: 0.7485 [92mK_eog: 0.7738 [34mF1_perclass_combined: [92.57, 36.92, 86.62, 83.73, 89.18] [34mF1_perclass_eeg: [88.12, 14.62, 82.81, 83.98, 76.5] [34mF1_perclass_eog: [89.15, 23.66, 83.29, 80.34, 87.82] 
[37mEpoch 13 step 198 with [31mce_loss_combined : 0.348996 [31mce_loss_eeg : 0.557028 [31mce_loss_eog : 0.430478 [31mtotal : 1.336502 [94mAcc_combined: 87.16 [94mAcc_eeg: 82.03 [94mAcc_eog: 83.85 [92mF1_combined: 78.54 [92mF1_eeg: 69.66 [92mF1_eog: 73.31 [92mK_combined: 0.8221 [92mK_eeg: 0.7488 [92mK_eog: 0.7747 [34mF1_perclass_combined: [92.49, 39.18, 87.47, 84.52, 89.04] [34mF1_perclass_eeg: [88.0, 16.94, 83.25, 83.82, 76.29] [34mF1_perclass_eog: [89.1, 25.56, 83.96, 80.16, 87.75] 
[37mEpoch 13 step 201 with [31mce_loss_combined : 0.347637 [31mce_loss_eeg : 0.550982 [31mce_loss_eog : 0.431260 [31mtotal : 1.329879 [94mAcc_combined: 87.22 [94mAcc_eeg: 82.39 [94mAcc_eog: 83.83 [92mF1_combined: 77.87 [92mF1_eeg: 69.49 [92mF1_eog: 72.15 [92mK_combined: 0.8227 [92mK_eeg: 0.7549 [92mK_eog: 0.7740 [34mF1_perclass_combined: [92.41, 35.76, 87.49, 84.56, 89.13] [34mF1_perclass_eeg: [88.25, 14.2, 83.42, 84.04, 77.51] [34mF1_perclass_eog: [88.98, 19.7, 83.75, 80.5, 87.83] 
[37mEpoch 13 step 202 with [31mce_loss_combined : 0.347026 [31mce_loss_eeg : 0.552647 [31mce_loss_eog : 0.428036 [31mtotal : 1.327709 [94mAcc_combined: 87.25 [94mAcc_eeg: 82.34 [94mAcc_eog: 83.90 [92mF1_combined: 78.47 [92mF1_eeg: 69.97 [92mF1_eog: 72.60 [92mK_combined: 0.8231 [92mK_eeg: 0.7544 [92mK_eog: 0.7745 [34mF1_perclass_combined: [92.32, 38.74, 87.7, 84.42, 89.15] [34mF1_perclass_eeg: [88.24, 16.84, 83.49, 83.81, 77.47] [34mF1_perclass_eog: [88.99, 22.29, 84.08, 79.78, 87.89] 
[37mEpoch 13 step 203 with [31mce_loss_combined : 0.345245 [31mce_loss_eeg : 0.547687 [31mce_loss_eog : 0.426524 [31mtotal : 1.319457 [94mAcc_combined: 87.37 [94mAcc_eeg: 82.52 [94mAcc_eog: 83.93 [92mF1_combined: 78.23 [92mF1_eeg: 69.64 [92mF1_eog: 72.55 [92mK_combined: 0.8249 [92mK_eeg: 0.7566 [92mK_eog: 0.7752 [34mF1_perclass_combined: [92.56, 36.88, 87.64, 84.61, 89.45] [34mF1_perclass_eeg: [88.53, 14.46, 83.59, 83.95, 77.66] [34mF1_perclass_eog: [89.13, 21.99, 84.08, 79.51, 88.03] 
[37mEpoch 14 step 210 with [31mce_loss_combined : 0.345078 [31mce_loss_eeg : 0.549467 [31mce_loss_eog : 0.424902 [31mtotal : 1.319447 [94mAcc_combined: 87.38 [94mAcc_eeg: 82.54 [94mAcc_eog: 83.86 [92mF1_combined: 78.08 [92mF1_eeg: 69.76 [92mF1_eog: 72.21 [92mK_combined: 0.8243 [92mK_eeg: 0.7565 [92mK_eog: 0.7739 [34mF1_perclass_combined: [92.55, 36.35, 87.8, 84.32, 89.39] [34mF1_perclass_eeg: [88.45, 15.27, 83.71, 83.74, 77.63] [34mF1_perclass_eog: [89.04, 20.8, 84.09, 79.23, 87.88] 
[37mEpoch 14 step 212 with [31mce_loss_combined : 0.344559 [31mce_loss_eeg : 0.547771 [31mce_loss_eog : 0.423038 [31mtotal : 1.315368 [94mAcc_combined: 87.45 [94mAcc_eeg: 82.53 [94mAcc_eog: 83.91 [92mF1_combined: 78.30 [92mF1_eeg: 69.73 [92mF1_eog: 72.38 [92mK_combined: 0.8254 [92mK_eeg: 0.7561 [92mK_eog: 0.7751 [34mF1_perclass_combined: [92.55, 37.07, 87.84, 84.58, 89.45] [34mF1_perclass_eeg: [88.49, 15.18, 83.7, 83.76, 77.52] [34mF1_perclass_eog: [89.08, 21.04, 83.99, 79.9, 87.89] 
{'val_loss': {'ce_loss_combined': 0.34455922, 'ce_loss_eeg': 0.54777056, 'ce_loss_eog': 0.4230384, 'total': 1.3153682}, 'val_acc': {'combined': 0.8744975744975745, 'eeg': 0.8253341253341253, 'eog': 0.8391050391050391}, 'val_f1': {'combined': 0.782986401745589, 'eeg': 0.6972916380729701, 'eog': 0.7238365760164144}, 'val_k': {'combined': 0.8254376963983977, 'eeg': 0.7560658038144947, 'eog': 0.7751230257469094}, 'val_perclassf1': {'combined': array([0.92550404, 0.37067917, 0.87842867, 0.84584547, 0.89447465]), 'eeg': array([0.88487034, 0.15183358, 0.83702456, 0.83757907, 0.77515064]), 'eog': array([0.89082561, 0.21043876, 0.83994641, 0.79902337, 0.87894873])}}
We are in the final state.
 THE Configuration of your experiment ..
{'agent': 'Sleep_Agent_Init_Train',
 'augmentation': {},
 'channel': 0,
 'dataset': {'cache_datasets': {'test': False, 'train': False, 'valid': False},
             'data_roots': '/esat/biomeddata/SHHS_Dataset/no_backup',
             'data_split': {'split_method': 'patients_test',
                            'test_split_rate': 0.3,
                            'val_split_rate': 0.026},
             'data_view_dir': [{'data_type': 'stft',
                                'list_dir': 'patient_mat_list.txt',
                                'mod': 'eeg',
                                'num_ch': 1},
                               {'data_type': 'stft',
                                'list_dir': 'patient_eog_mat_list.txt',
                                'mod': 'eog',
                                'num_ch': 1}],
             'dataloader_class': 'SleepDataLoader_mat_huy',
             'filter_windows': {'test': {'perc_threshold': 0.4,
                                         'skip_skips': True,
                                         'std_threshold': 41,
                                         'use_type': 'include_only_skipped',
                                         'whole_patient': False},
                                'train': {'perc_threshold': 0.4,
                                          'skip_skips': False,
                                          'std_threshold': 41,
                                          'subsets': {'combined': 100,
                                                      'eeg': 400,
                                                      'eog': 0},
                                          'use_type': 'subsample',
                                          'whole_patient': True},
                                'val': {'skip_skips': True,
                                        'use_type': False,
                                        'whole_patient': False}},
             'huy_data': True,
             'inner_overlap': [0.5, 0.5],
             'keep_view': [1, 0],
             'seq_length': [21, 0],
             'seq_views': [False],
             'shuffle_train': True},
 'early_stopping': {'log_interval': 10,
                    'max_epoch': 1000,
                    'n_steps_stop': 100,
                    'n_steps_stop_after': 50,
                    'save_every': 1,
                    'validate_after': 0,
                    'validate_every': 50},
 'exp_name': 'Sleep EEG-EOG BLIP Experiment',
 'lr_finder': False,
 'lr_finder_steps': 100,
 'mode': 'train',
 'model': {'args': {'augment_within': False,
                    'dmodel': 128,
                    'dropout': 0.3,
                    'fc_inner': 1024,
                    'ignore_alignment_val': True,
                    'multi_loss': {'multi_loss_weights': {'alignment_loss': 0.1,
                                                          'multi_supervised_loss': {'combined': 1,
                                                                                    'eeg': 1,
                                                                                    'eog': 1},
                                                          'order_loss': 0}},
                    'num_classes': 5,
                    'three_modes': True,
                    'training_type': 'alignment_order_multisupervised'},
           'encoders': [{'args': {'align_inner': True,
                                  'd_model': 128,
                                  'dim_feedforward': 1024,
                                  'dim_proj': 128,
                                  'dropout': 0.3,
                                  'inner_biased': False,
                                  'mod_token': False,
                                  'num_heads': 8,
                                  'num_layers': 4,
                                  'outer_biased': False,
                                  'outer_rep': False,
                                  'pos': False,
                                  'rpos': True,
                                  'shared': True,
                                  'skip_random_mod': False},
                         'encoders': [],
                         'freeze_encoder': False,
                         'model': 'SleepEnc_BLIP_EEG_EOG_shared_free_cliplike',
                         'pretrainedEncoder': {'dir': '', 'use': False},
                         'savetrainedEncoder': {'dir': '', 'save': False}}],
           'load_ongoing': False,
           'model_class': 'EEG_SLEEP_BLIP_GM_MultiMode',
           'pretrained_model': {'dir': '', 'use': False},
           'save_dir': '/esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2021_data/shhs1/multi_modal/paper_models/fourier_transformer_eeg_eog_mat_BLIP_al01_shared_b16_freetrain_rpos_nopos_nonsharedpreds_drop03_align_inner_trial2_pt_incomplete_100p_0e_400o.pth.tar'},
 'normalization': {'calculate_metrics': False,
                   'dir': '/esat/biomeddata/SHHS_Dataset/no_backup/metrics_eeg_eog_emg_stft.pkl',
                   'metrics_type': 'train_dataset',
                   'save_metrics': False,
                   'use': True},
 'num_classes': 5,
 'num_modalities': 1,
 'optimizer': {'beta1': 0.9,
               'beta2': 0.999,
               'learning_rate': 0.0001,
               'momentum': 0.2,
               'type': 'Adam',
               'weight_decay': 0.0001},
 'plots': {'plot_stft_num': 0, 'save': False},
 'post_proc': {'post_proc_step': 15,
               'test_postprocessing': False,
               'val_postprocessing': False},
 'scheduler': {'max_lr': 0.03, 'type': 'cosanneal', 'warm_up': 55},
 'statistics': {'ce_weights': {'temp': 0.1, 'use': False}, 'print': False},
 'training_params': {'adversarial_training': {'adv_epsilon': 0.01,
                                              'use': False},
                     'async_loading': True,
                     'batch_size': 32,
                     'cuda': False,
                     'data_loader_workers': 8,
                     'gpu_device': [0],
                     'pin_memory': True,
                     'rec_test': False,
                     'res': True,
                     'seed': 35,
                     'tdqm_disable': True,
                     'test_batch_size': 32,
                     'test_on_tops': True,
                     'use_test_set': True,
                     'validation': True,
                     'verbose': True,
                     'wandb_disable': True}}
 *************************************** 
The experiment name is Sleep EEG-EOG BLIP Experiment
 *************************************** 
stft_eeg Train 3724 validation 100 test 1639
stft_eog Train 3724 validation 100 test 1639
{'use_type': 'subsample', 'skip_skips': False, 'whole_patient': True, 'std_threshold': 41, 'perc_threshold': 0.4, 'subsets': {'combined': 100, 'eeg': 400, 'eog': 0}}
We subsample patients with 100 both mods, 400 only EEG and 0 only EOG and len_skipped is 500.
{'use_type': False, 'skip_skips': True, 'whole_patient': False}
{'use_type': 'include_only_skipped', 'skip_skips': True, 'whole_patient': False, 'std_threshold': 41, 'perc_threshold': 0.4}
Patients with broken modalities are 14
{'use_type': False, 'skip_skips': True}
Loading metrics from /esat/biomeddata/SHHS_Dataset/no_backup/metrics_eeg_eog_emg_stft.pkl
Weights are [1. 1. 1. 1. 1.]
735
50
15
tensor([1., 1., 1., 1., 1.], device='cuda:0')
We are not shuffling the data
Training function is sleep_train_one_step_alignment_order_multisupervised
Loss Weights are {'combined': 1, 'eeg': 1, 'eog': 1, 'alignments': 0.1, 'order': 0, 'consistency': 0, 'reconstruction': 0}
We are not shuffling the data
<class 'graphs.models.attention_models.BLIP.SleepEnc_BLIP_EEG_EOG_shared_free_cliplike'>
Total number of trainable parameters are: 7628293
Available cuda devices: 1, current device:0
Total number of trainable parameters are: 7628293
[37mEpoch 0 step 1 with [31mce_loss_combined : 1.045020 [31mce_loss_eeg : 0.980313 [31mce_loss_eog : 1.175221 [31mtotal : 3.200555 [94mAcc_combined: 50.93 [94mAcc_eeg: 55.07 [94mAcc_eog: 55.99 [92mF1_combined: 34.24 [92mF1_eeg: 42.37 [92mF1_eog: 26.83 [92mK_combined: 0.3357 [92mK_eeg: 0.4083 [92mK_eog: 0.3113 [34mF1_perclass_combined: [81.1, 0.0, 42.04, 47.9, 0.16] [34mF1_perclass_eeg: [80.47, 0.0, 42.64, 52.51, 36.23] [34mF1_perclass_eog: [67.82, 0.0, 66.31, 0.0, 0.0] 
[37mEpoch 0 step 3 with [31mce_loss_combined : 0.883445 [31mce_loss_eeg : 0.808192 [31mce_loss_eog : 1.234271 [31mtotal : 2.925908 [94mAcc_combined: 66.22 [94mAcc_eeg: 69.08 [94mAcc_eog: 53.02 [92mF1_combined: 45.76 [92mF1_eeg: 49.84 [92mF1_eog: 25.37 [92mK_combined: 0.5026 [92mK_eeg: 0.5464 [92mK_eog: 0.2929 [34mF1_perclass_combined: [82.36, 0.0, 68.89, 65.56, 11.97] [34mF1_perclass_eeg: [84.5, 0.0, 72.11, 73.27, 19.31] [34mF1_perclass_eog: [65.16, 0.0, 61.71, 0.0, 0.0] 
[37mEpoch 0 step 4 with [31mce_loss_combined : 0.852742 [31mce_loss_eeg : 0.793745 [31mce_loss_eog : 1.088724 [31mtotal : 2.735211 [94mAcc_combined: 65.55 [94mAcc_eeg: 69.84 [94mAcc_eog: 57.95 [92mF1_combined: 42.29 [92mF1_eeg: 51.24 [92mF1_eog: 28.33 [92mK_combined: 0.4837 [92mK_eeg: 0.5688 [92mK_eog: 0.3364 [34mF1_perclass_combined: [76.33, 0.0, 73.02, 46.33, 15.78] [34mF1_perclass_eeg: [79.04, 0.0, 73.29, 76.04, 27.83] [34mF1_perclass_eog: [75.69, 0.0, 65.95, 0.0, 0.0] 
[37mEpoch 0 step 7 with [31mce_loss_combined : 0.718944 [31mce_loss_eeg : 0.692644 [31mce_loss_eog : 1.062771 [31mtotal : 2.474360 [94mAcc_combined: 72.97 [94mAcc_eeg: 73.88 [94mAcc_eog: 57.24 [92mF1_combined: 56.11 [92mF1_eeg: 58.38 [92mF1_eog: 27.81 [92mK_combined: 0.6083 [92mK_eeg: 0.6315 [92mK_eog: 0.3365 [34mF1_perclass_combined: [82.38, 0.0, 76.37, 69.86, 51.95] [34mF1_perclass_eeg: [85.04, 0.0, 75.32, 78.36, 53.16] [34mF1_perclass_eog: [73.71, 0.0, 65.05, 0.28, 0.0] 
[37mEpoch 1 step 15 with [31mce_loss_combined : 0.667552 [31mce_loss_eeg : 0.674893 [31mce_loss_eog : 0.966997 [31mtotal : 2.309443 [94mAcc_combined: 74.92 [94mAcc_eeg: 75.15 [94mAcc_eog: 59.57 [92mF1_combined: 57.23 [92mF1_eeg: 59.68 [92mF1_eog: 31.86 [92mK_combined: 0.6308 [92mK_eeg: 0.6444 [92mK_eog: 0.3587 [34mF1_perclass_combined: [87.38, 0.0, 77.9, 72.72, 48.17] [34mF1_perclass_eeg: [83.98, 0.95, 78.15, 76.77, 58.55] [34mF1_perclass_eog: [77.68, 0.0, 67.17, 14.38, 0.1] 
[37mEpoch 1 step 17 with [31mce_loss_combined : 0.680530 [31mce_loss_eeg : 0.620459 [31mce_loss_eog : 0.992071 [31mtotal : 2.293059 [94mAcc_combined: 73.10 [94mAcc_eeg: 77.70 [94mAcc_eog: 58.67 [92mF1_combined: 53.58 [92mF1_eeg: 62.14 [92mF1_eog: 29.18 [92mK_combined: 0.6003 [92mK_eeg: 0.6834 [92mK_eog: 0.3450 [34mF1_perclass_combined: [86.23, 0.0, 75.85, 76.33, 29.48] [34mF1_perclass_eeg: [86.08, 0.8, 79.58, 79.41, 64.81] [34mF1_perclass_eog: [77.27, 0.0, 66.98, 1.56, 0.11] 
[37mEpoch 1 step 21 with [31mce_loss_combined : 0.638524 [31mce_loss_eeg : 0.650605 [31mce_loss_eog : 0.972858 [31mtotal : 2.261987 [94mAcc_combined: 75.74 [94mAcc_eeg: 76.16 [94mAcc_eog: 62.36 [92mF1_combined: 60.11 [92mF1_eeg: 60.92 [92mF1_eog: 46.61 [92mK_combined: 0.6582 [92mK_eeg: 0.6657 [92mK_eog: 0.4611 [34mF1_perclass_combined: [86.97, 0.85, 77.01, 78.22, 57.49] [34mF1_perclass_eeg: [85.9, 1.0, 78.02, 77.46, 62.23] [34mF1_perclass_eog: [67.4, 0.0, 67.14, 63.82, 34.68] 
[37mEpoch 1 step 23 with [31mce_loss_combined : 0.562706 [31mce_loss_eeg : 0.622708 [31mce_loss_eog : 0.990247 [31mtotal : 2.175662 [94mAcc_combined: 79.30 [94mAcc_eeg: 77.15 [94mAcc_eog: 65.58 [92mF1_combined: 63.61 [92mF1_eeg: 63.36 [92mF1_eog: 46.49 [92mK_combined: 0.7052 [92mK_eeg: 0.6866 [92mK_eog: 0.4876 [34mF1_perclass_combined: [87.32, 2.78, 81.73, 74.97, 71.23] [34mF1_perclass_eeg: [85.37, 4.91, 77.97, 81.8, 66.72] [34mF1_perclass_eog: [78.45, 0.0, 72.03, 39.71, 42.25] 
[37mEpoch 1 step 24 with [31mce_loss_combined : 0.622870 [31mce_loss_eeg : 0.644606 [31mce_loss_eog : 0.893484 [31mtotal : 2.160959 [94mAcc_combined: 78.29 [94mAcc_eeg: 75.60 [94mAcc_eog: 67.50 [92mF1_combined: 61.55 [92mF1_eeg: 57.37 [92mF1_eog: 52.78 [92mK_combined: 0.6851 [92mK_eeg: 0.6389 [92mK_eog: 0.5420 [34mF1_perclass_combined: [84.0, 0.0, 81.69, 77.46, 64.6] [34mF1_perclass_eeg: [85.5, 0.81, 78.67, 77.61, 44.24] [34mF1_perclass_eog: [75.02, 0.0, 69.1, 69.07, 50.71] 
[37mEpoch 2 step 30 with [31mce_loss_combined : 0.568379 [31mce_loss_eeg : 0.579013 [31mce_loss_eog : 0.936296 [31mtotal : 2.083689 [94mAcc_combined: 79.14 [94mAcc_eeg: 79.65 [94mAcc_eog: 64.47 [92mF1_combined: 63.44 [92mF1_eeg: 64.88 [92mF1_eog: 41.06 [92mK_combined: 0.7051 [92mK_eeg: 0.7124 [92mK_eog: 0.4682 [34mF1_perclass_combined: [88.11, 2.33, 81.65, 73.27, 71.83] [34mF1_perclass_eeg: [86.42, 4.5, 81.79, 80.78, 70.94] [34mF1_perclass_eog: [78.38, 0.0, 71.08, 0.0, 55.85] 
[37mEpoch 2 step 34 with [31mce_loss_combined : 0.579192 [31mce_loss_eeg : 0.564169 [31mce_loss_eog : 0.920538 [31mtotal : 2.063898 [94mAcc_combined: 79.26 [94mAcc_eeg: 79.86 [94mAcc_eog: 68.87 [92mF1_combined: 65.97 [92mF1_eeg: 65.64 [92mF1_eog: 54.18 [92mK_combined: 0.7092 [92mK_eeg: 0.7172 [92mK_eog: 0.5572 [34mF1_perclass_combined: [84.64, 13.06, 81.66, 80.83, 69.67] [34mF1_perclass_eeg: [86.11, 8.18, 81.58, 82.45, 69.89] [34mF1_perclass_eog: [74.11, 0.0, 71.92, 67.62, 57.25] 
[37mEpoch 2 step 37 with [31mce_loss_combined : 0.514287 [31mce_loss_eeg : 0.602116 [31mce_loss_eog : 0.798776 [31mtotal : 1.915178 [94mAcc_combined: 81.19 [94mAcc_eeg: 78.37 [94mAcc_eog: 70.35 [92mF1_combined: 66.91 [92mF1_eeg: 65.87 [92mF1_eog: 55.69 [92mK_combined: 0.7359 [92mK_eeg: 0.7018 [92mK_eog: 0.5689 [34mF1_perclass_combined: [88.23, 7.15, 82.35, 80.28, 76.53] [34mF1_perclass_eeg: [84.63, 14.23, 79.61, 80.12, 70.75] [34mF1_perclass_eog: [76.57, 0.0, 73.15, 70.06, 58.67] 
[37mEpoch 2 step 38 with [31mce_loss_combined : 0.478531 [31mce_loss_eeg : 0.527036 [31mce_loss_eog : 0.778570 [31mtotal : 1.784136 [94mAcc_combined: 82.56 [94mAcc_eeg: 81.09 [94mAcc_eog: 71.55 [92mF1_combined: 69.21 [92mF1_eeg: 68.40 [92mF1_eog: 56.57 [92mK_combined: 0.7539 [92mK_eeg: 0.7360 [92mK_eog: 0.5942 [34mF1_perclass_combined: [88.72, 13.2, 84.35, 82.69, 77.07] [34mF1_perclass_eeg: [87.53, 15.1, 82.6, 83.37, 73.39] [34mF1_perclass_eog: [78.77, 0.0, 75.11, 63.55, 65.4] 
[37mEpoch 3 step 52 with [31mce_loss_combined : 0.452815 [31mce_loss_eeg : 0.502874 [31mce_loss_eog : 0.735369 [31mtotal : 1.691058 [94mAcc_combined: 83.45 [94mAcc_eeg: 81.86 [94mAcc_eog: 71.48 [92mF1_combined: 71.68 [92mF1_eeg: 69.85 [92mF1_eog: 58.15 [92mK_combined: 0.7684 [92mK_eeg: 0.7453 [92mK_eog: 0.6111 [34mF1_perclass_combined: [89.11, 21.67, 85.5, 83.13, 78.99] [34mF1_perclass_eeg: [87.94, 20.26, 84.15, 82.45, 74.44] [34mF1_perclass_eog: [80.77, 0.0, 69.97, 66.99, 73.04] 
[37mEpoch 4 step 60 with [31mce_loss_combined : 0.433569 [31mce_loss_eeg : 0.483413 [31mce_loss_eog : 0.754699 [31mtotal : 1.671681 [94mAcc_combined: 84.63 [94mAcc_eeg: 82.88 [94mAcc_eog: 72.55 [92mF1_combined: 74.66 [92mF1_eeg: 72.71 [92mF1_eog: 56.28 [92mK_combined: 0.7839 [92mK_eeg: 0.7602 [92mK_eog: 0.6055 [34mF1_perclass_combined: [89.54, 32.31, 86.42, 82.78, 82.22] [34mF1_perclass_eeg: [88.48, 29.47, 84.57, 83.73, 77.3] [34mF1_perclass_eog: [76.4, 0.0, 78.09, 69.9, 57.01] 
[37mEpoch 4 step 62 with [31mce_loss_combined : 0.452431 [31mce_loss_eeg : 0.472729 [31mce_loss_eog : 0.727159 [31mtotal : 1.652319 [94mAcc_combined: 83.98 [94mAcc_eeg: 82.80 [94mAcc_eog: 72.68 [92mF1_combined: 75.01 [92mF1_eeg: 73.24 [92mF1_eog: 56.08 [92mK_combined: 0.7735 [92mK_eeg: 0.7587 [92mK_eog: 0.5960 [34mF1_perclass_combined: [89.6, 36.91, 85.93, 82.01, 80.61] [34mF1_perclass_eeg: [88.46, 32.9, 84.67, 83.55, 76.63] [34mF1_perclass_eog: [79.88, 0.05, 76.57, 52.77, 71.16] 
[37mEpoch 4 step 64 with [31mce_loss_combined : 0.448042 [31mce_loss_eeg : 0.477858 [31mce_loss_eog : 0.710383 [31mtotal : 1.636283 [94mAcc_combined: 84.37 [94mAcc_eeg: 82.80 [94mAcc_eog: 75.20 [92mF1_combined: 73.88 [92mF1_eeg: 71.56 [92mF1_eog: 59.80 [92mK_combined: 0.7801 [92mK_eeg: 0.7597 [92mK_eog: 0.6461 [34mF1_perclass_combined: [88.86, 29.47, 86.17, 81.91, 82.97] [34mF1_perclass_eeg: [88.35, 24.01, 84.48, 83.46, 77.49] [34mF1_perclass_eog: [80.39, 0.35, 78.02, 66.58, 73.66] 
[37mEpoch 4 step 65 with [31mce_loss_combined : 0.428388 [31mce_loss_eeg : 0.470970 [31mce_loss_eog : 0.685696 [31mtotal : 1.585055 [94mAcc_combined: 84.75 [94mAcc_eeg: 83.01 [94mAcc_eog: 75.76 [92mF1_combined: 73.30 [92mF1_eeg: 71.23 [92mF1_eog: 60.11 [92mK_combined: 0.7836 [92mK_eeg: 0.7599 [92mK_eog: 0.6518 [34mF1_perclass_combined: [89.81, 25.14, 86.4, 82.0, 83.17] [34mF1_perclass_eeg: [88.64, 21.78, 84.56, 83.61, 77.55] [34mF1_perclass_eog: [81.57, 0.0, 78.51, 66.48, 74.0] 
[37mEpoch 4 step 73 with [31mce_loss_combined : 0.428338 [31mce_loss_eeg : 0.474969 [31mce_loss_eog : 0.658967 [31mtotal : 1.562275 [94mAcc_combined: 84.45 [94mAcc_eeg: 83.10 [94mAcc_eog: 75.77 [92mF1_combined: 73.91 [92mF1_eeg: 74.07 [92mF1_eog: 61.02 [92mK_combined: 0.7807 [92mK_eeg: 0.7635 [92mK_eog: 0.6594 [34mF1_perclass_combined: [88.7, 29.39, 86.47, 82.72, 82.25] [34mF1_perclass_eeg: [88.35, 35.85, 84.64, 83.15, 78.38] [34mF1_perclass_eog: [81.59, 0.0, 77.41, 71.97, 74.13] 
[37mEpoch 5 step 74 with [31mce_loss_combined : 0.420334 [31mce_loss_eeg : 0.470958 [31mce_loss_eog : 0.642758 [31mtotal : 1.534049 [94mAcc_combined: 84.84 [94mAcc_eeg: 83.19 [94mAcc_eog: 76.32 [92mF1_combined: 74.56 [92mF1_eeg: 74.10 [92mF1_eog: 61.30 [92mK_combined: 0.7864 [92mK_eeg: 0.7650 [92mK_eog: 0.6656 [34mF1_perclass_combined: [89.37, 30.81, 86.61, 82.85, 83.14] [34mF1_perclass_eeg: [88.48, 35.51, 84.75, 83.3, 78.46] [34mF1_perclass_eog: [82.07, 0.0, 78.3, 71.01, 75.1] 
[37mEpoch 5 step 75 with [31mce_loss_combined : 0.413265 [31mce_loss_eeg : 0.466395 [31mce_loss_eog : 0.640591 [31mtotal : 1.520251 [94mAcc_combined: 85.10 [94mAcc_eeg: 83.38 [94mAcc_eog: 76.41 [92mF1_combined: 74.86 [92mF1_eeg: 74.29 [92mF1_eog: 61.42 [92mK_combined: 0.7903 [92mK_eeg: 0.7677 [92mK_eog: 0.6676 [34mF1_perclass_combined: [89.76, 30.86, 86.63, 83.47, 83.6] [34mF1_perclass_eeg: [88.64, 35.48, 84.87, 83.86, 78.62] [34mF1_perclass_eog: [82.31, 0.0, 78.24, 71.16, 75.41] 
[37mEpoch 6 step 91 with [31mce_loss_combined : 0.392646 [31mce_loss_eeg : 0.451396 [31mce_loss_eog : 0.626327 [31mtotal : 1.470369 [94mAcc_combined: 85.76 [94mAcc_eeg: 83.44 [94mAcc_eog: 76.79 [92mF1_combined: 77.77 [92mF1_eeg: 75.34 [92mF1_eog: 62.06 [92mK_combined: 0.8014 [92mK_eeg: 0.7687 [92mK_eog: 0.6724 [34mF1_perclass_combined: [90.98, 42.3, 87.14, 82.76, 85.66] [34mF1_perclass_eeg: [88.79, 40.77, 85.13, 82.84, 79.18] [34mF1_perclass_eog: [82.72, 0.45, 78.23, 72.08, 76.8] 
[37mEpoch 6 step 94 with [31mce_loss_combined : 0.391814 [31mce_loss_eeg : 0.446988 [31mce_loss_eog : 0.623888 [31mtotal : 1.462690 [94mAcc_combined: 85.89 [94mAcc_eeg: 83.75 [94mAcc_eog: 77.15 [92mF1_combined: 76.87 [92mF1_eeg: 74.46 [92mF1_eog: 61.69 [92mK_combined: 0.8019 [92mK_eeg: 0.7724 [92mK_eog: 0.6734 [34mF1_perclass_combined: [90.59, 37.59, 87.41, 83.06, 85.72] [34mF1_perclass_eeg: [88.88, 34.7, 85.24, 84.07, 79.41] [34mF1_perclass_eog: [82.96, 0.35, 79.45, 68.89, 76.78] 
[37mEpoch 8 step 120 with [31mce_loss_combined : 0.393843 [31mce_loss_eeg : 0.444414 [31mce_loss_eog : 0.622949 [31mtotal : 1.461206 [94mAcc_combined: 85.71 [94mAcc_eeg: 83.74 [94mAcc_eog: 77.04 [92mF1_combined: 77.05 [92mF1_eeg: 74.65 [92mF1_eog: 62.12 [92mK_combined: 0.8001 [92mK_eeg: 0.7713 [92mK_eog: 0.6745 [34mF1_perclass_combined: [90.17, 38.4, 87.17, 83.99, 85.5] [34mF1_perclass_eeg: [88.84, 36.22, 85.47, 83.88, 78.86] [34mF1_perclass_eog: [83.04, 0.35, 78.51, 72.26, 76.42] 
[37mEpoch 8 step 126 with [31mce_loss_combined : 0.381727 [31mce_loss_eeg : 0.436441 [31mce_loss_eog : 0.608720 [31mtotal : 1.426888 [94mAcc_combined: 86.23 [94mAcc_eeg: 84.18 [94mAcc_eog: 77.54 [92mF1_combined: 77.41 [92mF1_eeg: 75.59 [92mF1_eog: 62.50 [92mK_combined: 0.8076 [92mK_eeg: 0.7806 [92mK_eog: 0.6818 [34mF1_perclass_combined: [90.76, 37.85, 87.33, 84.84, 86.28] [34mF1_perclass_eeg: [89.57, 38.07, 85.37, 84.79, 80.13] [34mF1_perclass_eog: [83.51, 0.4, 79.04, 71.43, 78.09] 
[37mEpoch 8 step 128 with [31mce_loss_combined : 0.378660 [31mce_loss_eeg : 0.425209 [31mce_loss_eog : 0.614033 [31mtotal : 1.417901 [94mAcc_combined: 86.35 [94mAcc_eeg: 84.34 [94mAcc_eog: 77.42 [92mF1_combined: 77.11 [92mF1_eeg: 75.58 [92mF1_eog: 62.35 [92mK_combined: 0.8081 [92mK_eeg: 0.7808 [92mK_eog: 0.6801 [34mF1_perclass_combined: [90.81, 36.38, 87.71, 84.42, 86.24] [34mF1_perclass_eeg: [89.58, 37.94, 85.86, 84.41, 80.13] [34mF1_perclass_eog: [83.12, 0.3, 79.06, 71.11, 78.17] 
[37mEpoch 8 step 131 with [31mce_loss_combined : 0.374962 [31mce_loss_eeg : 0.427267 [31mce_loss_eog : 0.614182 [31mtotal : 1.416412 [94mAcc_combined: 86.28 [94mAcc_eeg: 84.19 [94mAcc_eog: 77.10 [92mF1_combined: 77.75 [92mF1_eeg: 75.89 [92mF1_eog: 62.30 [92mK_combined: 0.8087 [92mK_eeg: 0.7801 [92mK_eog: 0.6786 [34mF1_perclass_combined: [90.85, 39.72, 87.53, 84.4, 86.26] [34mF1_perclass_eeg: [89.33, 39.67, 85.58, 84.68, 80.19] [34mF1_perclass_eog: [82.86, 0.8, 78.45, 71.21, 78.17] 
[37mEpoch 9 step 133 with [31mce_loss_combined : 0.378101 [31mce_loss_eeg : 0.427276 [31mce_loss_eog : 0.606961 [31mtotal : 1.412338 [94mAcc_combined: 86.27 [94mAcc_eeg: 84.20 [94mAcc_eog: 77.43 [92mF1_combined: 77.68 [92mF1_eeg: 75.58 [92mF1_eog: 62.47 [92mK_combined: 0.8077 [92mK_eeg: 0.7793 [92mK_eog: 0.6815 [34mF1_perclass_combined: [90.8, 39.92, 87.67, 83.71, 86.3] [34mF1_perclass_eeg: [89.3, 38.29, 85.73, 84.23, 80.34] [34mF1_perclass_eog: [83.25, 0.99, 79.02, 70.67, 78.43] 
[37mEpoch 9 step 134 with [31mce_loss_combined : 0.372941 [31mce_loss_eeg : 0.426787 [31mce_loss_eog : 0.605585 [31mtotal : 1.405313 [94mAcc_combined: 86.40 [94mAcc_eeg: 84.28 [94mAcc_eog: 77.44 [92mF1_combined: 77.75 [92mF1_eeg: 75.80 [92mF1_eog: 62.59 [92mK_combined: 0.8099 [92mK_eeg: 0.7808 [92mK_eog: 0.6824 [34mF1_perclass_combined: [91.02, 39.34, 87.69, 84.34, 86.36] [34mF1_perclass_eeg: [89.4, 38.93, 85.71, 84.65, 80.33] [34mF1_perclass_eog: [83.39, 0.99, 78.84, 71.3, 78.45] 
[37mEpoch 9 step 135 with [31mce_loss_combined : 0.372565 [31mce_loss_eeg : 0.426749 [31mce_loss_eog : 0.604822 [31mtotal : 1.404136 [94mAcc_combined: 86.38 [94mAcc_eeg: 84.29 [94mAcc_eog: 77.47 [92mF1_combined: 77.80 [92mF1_eeg: 75.86 [92mF1_eog: 62.65 [92mK_combined: 0.8098 [92mK_eeg: 0.7810 [92mK_eog: 0.6828 [34mF1_perclass_combined: [91.02, 39.56, 87.66, 84.35, 86.39] [34mF1_perclass_eeg: [89.4, 39.22, 85.71, 84.64, 80.35] [34mF1_perclass_eog: [83.43, 1.14, 78.87, 71.35, 78.47] 
[37mEpoch 9 step 136 with [31mce_loss_combined : 0.372432 [31mce_loss_eeg : 0.426481 [31mce_loss_eog : 0.604525 [31mtotal : 1.403438 [94mAcc_combined: 86.40 [94mAcc_eeg: 84.30 [94mAcc_eog: 77.47 [92mF1_combined: 77.82 [92mF1_eeg: 75.87 [92mF1_eog: 62.66 [92mK_combined: 0.8099 [92mK_eeg: 0.7810 [92mK_eog: 0.6828 [34mF1_perclass_combined: [91.02, 39.66, 87.71, 84.35, 86.37] [34mF1_perclass_eeg: [89.39, 39.25, 85.74, 84.63, 80.36] [34mF1_perclass_eog: [83.42, 1.18, 78.9, 71.29, 78.5] 
[37mEpoch 12 step 179 with [31mce_loss_combined : 0.379163 [31mce_loss_eeg : 0.423517 [31mce_loss_eog : 0.592557 [31mtotal : 1.395237 [94mAcc_combined: 85.92 [94mAcc_eeg: 84.40 [94mAcc_eog: 78.27 [92mF1_combined: 78.06 [92mF1_eeg: 75.99 [92mF1_eog: 63.34 [92mK_combined: 0.8047 [92mK_eeg: 0.7838 [92mK_eog: 0.6891 [34mF1_perclass_combined: [90.96, 42.14, 87.1, 83.32, 86.78] [34mF1_perclass_eeg: [89.63, 39.03, 85.53, 84.53, 81.23] [34mF1_perclass_eog: [84.44, 3.1, 80.03, 69.64, 79.51] 
[37mEpoch 13 step 194 with [31mce_loss_combined : 0.369461 [31mce_loss_eeg : 0.414262 [31mce_loss_eog : 0.578363 [31mtotal : 1.362085 [94mAcc_combined: 86.35 [94mAcc_eeg: 84.60 [94mAcc_eog: 78.55 [92mF1_combined: 78.81 [92mF1_eeg: 76.61 [92mF1_eog: 64.78 [92mK_combined: 0.8099 [92mK_eeg: 0.7850 [92mK_eog: 0.6962 [34mF1_perclass_combined: [91.37, 44.65, 87.66, 83.2, 87.15] [34mF1_perclass_eeg: [89.73, 41.91, 86.02, 83.88, 81.54] [34mF1_perclass_eog: [84.78, 7.14, 79.92, 71.91, 80.17] 
[37mEpoch 13 step 204 with [31mce_loss_combined : 0.360170 [31mce_loss_eeg : 0.411726 [31mce_loss_eog : 0.586420 [31mtotal : 1.358316 [94mAcc_combined: 86.71 [94mAcc_eeg: 84.72 [94mAcc_eog: 78.37 [92mF1_combined: 78.36 [92mF1_eeg: 76.28 [92mF1_eog: 63.74 [92mK_combined: 0.8140 [92mK_eeg: 0.7865 [92mK_eog: 0.6931 [34mF1_perclass_combined: [91.13, 40.61, 87.87, 84.76, 87.42] [34mF1_perclass_eeg: [89.84, 39.4, 86.02, 85.23, 80.88] [34mF1_perclass_eog: [84.54, 4.2, 79.91, 69.58, 80.47] 
[37mEpoch 14 step 207 with [31mce_loss_combined : 0.359078 [31mce_loss_eeg : 0.412497 [31mce_loss_eog : 0.576110 [31mtotal : 1.347685 [94mAcc_combined: 86.73 [94mAcc_eeg: 84.77 [94mAcc_eog: 78.50 [92mF1_combined: 78.54 [92mF1_eeg: 76.31 [92mF1_eog: 64.45 [92mK_combined: 0.8147 [92mK_eeg: 0.7870 [92mK_eog: 0.6971 [34mF1_perclass_combined: [91.24, 41.54, 87.99, 84.7, 87.23] [34mF1_perclass_eeg: [89.73, 39.17, 86.1, 85.06, 81.5] [34mF1_perclass_eog: [84.89, 5.73, 79.67, 71.72, 80.25] 
[37mEpoch 14 step 209 with [31mce_loss_combined : 0.359702 [31mce_loss_eeg : 0.411145 [31mce_loss_eog : 0.574884 [31mtotal : 1.345731 [94mAcc_combined: 86.73 [94mAcc_eeg: 84.87 [94mAcc_eog: 78.69 [92mF1_combined: 78.95 [92mF1_eeg: 76.89 [92mF1_eog: 64.89 [92mK_combined: 0.8150 [92mK_eeg: 0.7886 [92mK_eog: 0.7000 [34mF1_perclass_combined: [91.31, 43.58, 88.0, 84.54, 87.32] [34mF1_perclass_eeg: [89.79, 41.98, 86.28, 84.8, 81.59] [34mF1_perclass_eog: [85.0, 6.44, 79.75, 72.65, 80.59] 
{'val_loss': {'ce_loss_combined': 0.35970196, 'ce_loss_eeg': 0.41114545, 'ce_loss_eog': 0.5748839, 'total': 1.3457311}, 'val_acc': {'combined': 0.867324726393612, 'eeg': 0.848696419793955, 'eog': 0.7868628808169571}, 'val_f1': {'combined': 0.7895058180894287, 'eeg': 0.7688656467772612, 'eog': 0.6488721508840374}, 'val_k': {'combined': 0.8149922535076193, 'eeg': 0.7885669263196098, 'eog': 0.6999644008463654}, 'val_perclassf1': {'combined': array([0.91312412, 0.43581081, 0.88001366, 0.84537604, 0.87320446]), 'eeg': array([0.89792519, 0.41977186, 0.86276947, 0.84797748, 0.81588423]), 'eog': array([0.85004037, 0.06439909, 0.79746229, 0.72653538, 0.80592362])}}
We are in the final state.
 THE Configuration of your experiment ..
{'agent': 'Sleep_Agent_Init_Train',
 'augmentation': {},
 'channel': 0,
 'dataset': {'cache_datasets': {'test': False, 'train': False, 'valid': False},
             'data_roots': '/esat/biomeddata/SHHS_Dataset/no_backup',
             'data_split': {'fold': 0,
                            'fold_size': 7,
                            'folds_file': '/users/sista/kkontras/Documents/Huy_shhs1/HUY '
                                          'SHHS1 CODE/data_split_eval.mat',
                            'rand_split': 0,
                            'rand_splits': 13,
                            'split_method': 'patients_huy',
                            'test_split_rate': 0.3,
                            'val_patient_num': 3,
                            'val_split_rate': 0.01692},
             'data_view_dir': [{'data_type': 'stft',
                                'list_dir': 'patient_mat_list.txt',
                                'mod': 'eeg',
                                'num_ch': 1},
                               {'data_type': 'stft',
                                'list_dir': 'patient_eog_mat_list.txt',
                                'mod': 'eog',
                                'num_ch': 1}],
             'dataloader_class': 'SleepDataLoader_mat_huy',
             'filter_windows': {'test': {'perc_threshold': 0.4,
                                         'skip_skips': True,
                                         'std_threshold': 41,
                                         'use_type': 'include_only_skipped',
                                         'whole_patient': False},
                                'train': {'perc_threshold': 0.4,
                                          'skip_skips': False,
                                          'std_threshold': 41,
                                          'subsets': {'combined': 100,
                                                      'eeg': 0,
                                                      'eog': 600},
                                          'use_type': 'subsample',
                                          'whole_patient': True},
                                'val': {'skip_skips': True,
                                        'use_type': False,
                                        'whole_patient': False}},
             'huy_data': True,
             'inner_overlap': [0.5, 0.5],
             'keep_view': [1, 0],
             'seq_length': [21, 0],
             'seq_views': [False],
             'shuffle_train': True},
 'early_stopping': {'log_interval': 10,
                    'max_epoch': 1000,
                    'n_steps_stop': 100,
                    'n_steps_stop_after': 50,
                    'save_every': 1,
                    'validate_after': 0,
                    'validate_every': 50},
 'exp_name': 'Sleep EEG-EOG BLIP Experiment',
 'lr_finder': False,
 'lr_finder_steps': 100,
 'mode': 'train',
 'model': {'args': {'augment_within': False,
                    'dmodel': 128,
                    'dropout': 0.3,
                    'fc_inner': 1024,
                    'ignore_alignment_val': True,
                    'multi_loss': {'multi_loss_weights': {'alignment_loss': 0.1,
                                                          'multi_supervised_loss': {'combined': 1,
                                                                                    'eeg': 1,
                                                                                    'eog': 1},
                                                          'order_loss': 0}},
                    'num_classes': 5,
                    'three_modes': True,
                    'training_type': 'alignment_order_multisupervised'},
           'encoders': [{'args': {'align_inner': True,
                                  'd_model': 128,
                                  'dim_feedforward': 1024,
                                  'dim_proj': 128,
                                  'dropout': 0.3,
                                  'inner_biased': False,
                                  'mod_token': False,
                                  'num_heads': 8,
                                  'num_layers': 4,
                                  'outer_biased': False,
                                  'outer_rep': False,
                                  'pos': False,
                                  'rpos': True,
                                  'shared': True,
                                  'skip_random_mod': False},
                         'encoders': [],
                         'freeze_encoder': False,
                         'model': 'SleepEnc_BLIP_EEG_EOG_shared_free_cliplike',
                         'pretrainedEncoder': {'dir': '', 'use': False},
                         'savetrainedEncoder': {'dir': '', 'save': False}}],
           'load_ongoing': False,
           'model_class': 'EEG_SLEEP_BLIP_GM_MultiMode',
           'pretrained_model': {'dir': '', 'use': False},
           'save_dir': '/esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2021_data/shhs1/multi_modal/paper_models/fourier_transformer_eeg_eog_mat_BLIP_al01_shared_b16_freetrain_rpos_nopos_nonsharedpreds_drop03_align_inner_trial1_incomplete_100p_0e_600o.pth.tar'},
 'normalization': {'calculate_metrics': False,
                   'dir': '/esat/biomeddata/SHHS_Dataset/no_backup/metrics_eeg_eog_emg_stft.pkl',
                   'metrics_type': 'train_dataset',
                   'save_metrics': False,
                   'use': True},
 'num_classes': 5,
 'num_modalities': 1,
 'optimizer': {'beta1': 0.9,
               'beta2': 0.999,
               'learning_rate': 0.0001,
               'momentum': 0.2,
               'type': 'Adam',
               'weight_decay': 0.0001},
 'plots': {'plot_stft_num': 0, 'save': False},
 'post_proc': {'post_proc_step': 15,
               'test_postprocessing': False,
               'val_postprocessing': False},
 'scheduler': {'max_lr': 0.03, 'type': 'cosanneal', 'warm_up': 55},
 'statistics': {'ce_weights': {'temp': 0.1, 'use': False}, 'print': False},
 'training_params': {'adversarial_training': {'adv_epsilon': 0.01,
                                              'use': False},
                     'async_loading': True,
                     'batch_size': 32,
                     'cuda': False,
                     'data_loader_workers': 8,
                     'gpu_device': [0],
                     'pin_memory': True,
                     'rec_test': False,
                     'res': True,
                     'seed': 28,
                     'tdqm_disable': True,
                     'test_batch_size': 32,
                     'test_on_tops': True,
                     'use_test_set': True,
                     'validation': True,
                     'verbose': True,
                     'wandb_disable': True}}
 *************************************** 
The experiment name is Sleep EEG-EOG BLIP Experiment
 *************************************** 
We are splitting dataset by huy splits
{'use_type': 'subsample', 'skip_skips': False, 'whole_patient': True, 'std_threshold': 41, 'perc_threshold': 0.4, 'subsets': {'combined': 100, 'eeg': 0, 'eog': 600}}
We subsample patients with 100 both mods, 0 only EEG and 600 only EOG and len_skipped is 700.
{'use_type': False, 'skip_skips': True, 'whole_patient': False}
{'use_type': 'include_only_skipped', 'skip_skips': True, 'whole_patient': False, 'std_threshold': 41, 'perc_threshold': 0.4}
Patients with broken modalities are 27
{'use_type': False, 'skip_skips': True}
Loading metrics from /esat/biomeddata/SHHS_Dataset/no_backup/metrics_eeg_eog_emg_stft.pkl
Weights are [1. 1. 1. 1. 1.]
1028
50
21
tensor([1., 1., 1., 1., 1.], device='cuda:0')
We are not shuffling the data
Training function is sleep_train_one_step_alignment_order_multisupervised
Loss Weights are {'combined': 1, 'eeg': 1, 'eog': 1, 'alignments': 0.1, 'order': 0, 'consistency': 0, 'reconstruction': 0}
We are not shuffling the data
<class 'graphs.models.attention_models.BLIP.SleepEnc_BLIP_EEG_EOG_shared_free_cliplike'>
Total number of trainable parameters are: 7628293
Available cuda devices: 1, current device:0
Total number of trainable parameters are: 7628293
[37mEpoch 0 step 1 with [31mce_loss_combined : 1.467224 [31mce_loss_eeg : 1.537033 [31mce_loss_eog : 1.095529 [31mtotal : 4.099786 [94mAcc_combined: 55.60 [94mAcc_eeg: 53.81 [94mAcc_eog: 56.82 [92mF1_combined: 26.68 [92mF1_eeg: 25.78 [92mF1_eog: 28.39 [92mK_combined: 0.3296 [92mK_eeg: 0.3087 [92mK_eog: 0.3208 [34mF1_perclass_combined: [68.33, 0.0, 65.05, 0.0, 0.0] [34mF1_perclass_eeg: [66.21, 0.0, 62.69, 0.0, 0.0] [34mF1_perclass_eog: [72.72, 0.0, 65.68, 3.25, 0.31] 
[37mEpoch 0 step 2 with [31mce_loss_combined : 0.995629 [31mce_loss_eeg : 1.190230 [31mce_loss_eog : 1.065557 [31mtotal : 3.251416 [94mAcc_combined: 64.60 [94mAcc_eeg: 55.26 [94mAcc_eog: 59.37 [92mF1_combined: 45.45 [92mF1_eeg: 27.25 [92mF1_eog: 42.94 [92mK_combined: 0.4987 [92mK_eeg: 0.2879 [92mK_eog: 0.4360 [34mF1_perclass_combined: [79.36, 0.0, 69.64, 56.34, 21.94] [34mF1_perclass_eeg: [72.71, 0.0, 63.57, 0.0, 0.0] [34mF1_perclass_eog: [73.11, 0.0, 62.99, 57.4, 21.19] 
[37mEpoch 0 step 4 with [31mce_loss_combined : 1.046051 [31mce_loss_eeg : 1.153039 [31mce_loss_eog : 0.889822 [31mtotal : 3.088913 [94mAcc_combined: 62.09 [94mAcc_eeg: 59.60 [94mAcc_eog: 69.11 [92mF1_combined: 37.34 [92mF1_eeg: 28.95 [92mF1_eog: 53.08 [92mK_combined: 0.4427 [92mK_eeg: 0.3803 [92mK_eog: 0.5598 [34mF1_perclass_combined: [71.52, 0.0, 73.96, 0.0, 41.22] [34mF1_perclass_eeg: [77.7, 0.0, 67.03, 0.0, 0.0] [34mF1_perclass_eog: [76.11, 0.0, 73.4, 69.04, 46.86] 
[37mEpoch 0 step 5 with [31mce_loss_combined : 0.940646 [31mce_loss_eeg : 0.985842 [31mce_loss_eog : 1.012170 [31mtotal : 2.938658 [94mAcc_combined: 66.05 [94mAcc_eeg: 61.02 [94mAcc_eog: 63.78 [92mF1_combined: 43.30 [92mF1_eeg: 32.27 [92mF1_eog: 40.67 [92mK_combined: 0.4887 [92mK_eeg: 0.4057 [92mK_eog: 0.4499 [34mF1_perclass_combined: [80.76, 0.0, 72.43, 28.94, 34.36] [34mF1_perclass_eeg: [77.8, 0.0, 68.71, 0.0, 14.86] [34mF1_perclass_eog: [76.26, 0.0, 71.14, 27.77, 28.16] 
[37mEpoch 0 step 8 with [31mce_loss_combined : 0.768201 [31mce_loss_eeg : 1.083206 [31mce_loss_eog : 0.815571 [31mtotal : 2.666978 [94mAcc_combined: 74.13 [94mAcc_eeg: 60.78 [94mAcc_eog: 71.42 [92mF1_combined: 59.03 [92mF1_eeg: 30.11 [92mF1_eog: 55.53 [92mK_combined: 0.6370 [92mK_eeg: 0.3902 [92mK_eog: 0.5903 [34mF1_perclass_combined: [82.67, 0.0, 75.49, 70.02, 67.0] [34mF1_perclass_eeg: [83.15, 0.0, 66.96, 0.0, 0.45] [34mF1_perclass_eog: [78.91, 0.0, 74.63, 56.72, 67.36] 
[37mEpoch 0 step 10 with [31mce_loss_combined : 0.712696 [31mce_loss_eeg : 0.987185 [31mce_loss_eog : 0.729188 [31mtotal : 2.429068 [94mAcc_combined: 75.14 [94mAcc_eeg: 61.24 [94mAcc_eog: 73.75 [92mF1_combined: 60.17 [92mF1_eeg: 34.52 [92mF1_eog: 59.61 [92mK_combined: 0.6566 [92mK_eeg: 0.4093 [92mK_eog: 0.6374 [34mF1_perclass_combined: [84.05, 0.0, 76.56, 71.98, 68.28] [34mF1_perclass_eeg: [83.59, 0.0, 67.69, 0.0, 21.32] [34mF1_perclass_eog: [79.16, 0.0, 74.99, 72.59, 71.32] 
[37mEpoch 0 step 12 with [31mce_loss_combined : 0.676682 [31mce_loss_eeg : 0.861247 [31mce_loss_eog : 0.749941 [31mtotal : 2.287870 [94mAcc_combined: 76.04 [94mAcc_eeg: 61.59 [94mAcc_eog: 72.76 [92mF1_combined: 60.04 [92mF1_eeg: 31.11 [92mF1_eog: 59.19 [92mK_combined: 0.6590 [92mK_eeg: 0.4055 [92mK_eog: 0.6202 [34mF1_perclass_combined: [85.68, 0.0, 76.7, 74.37, 63.47] [34mF1_perclass_eeg: [83.71, 0.0, 67.57, 3.6, 0.67] [34mF1_perclass_eog: [79.5, 0.0, 72.02, 71.86, 72.58] 
[37mEpoch 0 step 19 with [31mce_loss_combined : 0.693257 [31mce_loss_eeg : 0.846597 [31mce_loss_eog : 0.663999 [31mtotal : 2.203854 [94mAcc_combined: 74.36 [94mAcc_eeg: 66.17 [94mAcc_eog: 76.92 [92mF1_combined: 58.40 [92mF1_eeg: 52.93 [92mF1_eog: 61.66 [92mK_combined: 0.6337 [92mK_eeg: 0.5417 [92mK_eog: 0.6755 [34mF1_perclass_combined: [82.87, 0.0, 76.14, 57.99, 75.03] [34mF1_perclass_eeg: [84.11, 0.0, 62.42, 64.76, 53.36] [34mF1_perclass_eog: [81.43, 0.0, 79.09, 70.72, 77.05] 
[37mEpoch 0 step 20 with [31mce_loss_combined : 0.617609 [31mce_loss_eeg : 0.893843 [31mce_loss_eog : 0.659085 [31mtotal : 2.170537 [94mAcc_combined: 78.24 [94mAcc_eeg: 67.86 [94mAcc_eog: 76.87 [92mF1_combined: 62.77 [92mF1_eeg: 44.86 [92mF1_eog: 62.16 [92mK_combined: 0.6913 [92mK_eeg: 0.5184 [92mK_eog: 0.6789 [34mF1_perclass_combined: [83.61, 0.0, 79.82, 75.3, 75.1] [34mF1_perclass_eeg: [84.1, 0.0, 71.35, 59.77, 9.1] [34mF1_perclass_eog: [80.88, 0.0, 77.91, 75.26, 76.75] 
[37mEpoch 1 step 21 with [31mce_loss_combined : 0.593717 [31mce_loss_eeg : 0.777939 [31mce_loss_eog : 0.649320 [31mtotal : 2.020976 [94mAcc_combined: 79.78 [94mAcc_eeg: 72.16 [94mAcc_eog: 77.35 [92mF1_combined: 64.31 [92mF1_eeg: 56.86 [92mF1_eog: 61.70 [92mK_combined: 0.7179 [92mK_eeg: 0.6127 [92mK_eog: 0.6760 [34mF1_perclass_combined: [86.26, 0.0, 80.35, 75.8, 79.14] [34mF1_perclass_eeg: [84.06, 0.0, 72.0, 73.35, 54.89] [34mF1_perclass_eog: [83.07, 0.0, 79.19, 66.45, 79.8] 
[37mEpoch 1 step 31 with [31mce_loss_combined : 0.540304 [31mce_loss_eeg : 0.798760 [31mce_loss_eog : 0.660746 [31mtotal : 1.999809 [94mAcc_combined: 81.14 [94mAcc_eeg: 69.99 [94mAcc_eog: 76.11 [92mF1_combined: 65.77 [92mF1_eeg: 51.35 [92mF1_eog: 62.31 [92mK_combined: 0.7369 [92mK_eeg: 0.5604 [92mK_eog: 0.6672 [34mF1_perclass_combined: [87.3, 0.0, 81.22, 79.32, 81.01] [34mF1_perclass_eeg: [84.96, 0.0, 73.15, 47.5, 51.14] [34mF1_perclass_eog: [79.82, 0.0, 75.9, 75.61, 80.21] 
[37mEpoch 1 step 33 with [31mce_loss_combined : 0.573968 [31mce_loss_eeg : 0.793238 [31mce_loss_eog : 0.616222 [31mtotal : 1.983427 [94mAcc_combined: 79.87 [94mAcc_eeg: 69.80 [94mAcc_eog: 78.31 [92mF1_combined: 63.53 [92mF1_eeg: 52.19 [92mF1_eog: 63.34 [92mK_combined: 0.7096 [92mK_eeg: 0.5669 [92mK_eog: 0.6944 [34mF1_perclass_combined: [87.51, 0.0, 81.16, 67.92, 81.08] [34mF1_perclass_eeg: [85.76, 0.0, 72.05, 45.3, 57.82] [34mF1_perclass_eog: [82.57, 0.0, 79.69, 75.16, 79.28] 
[37mEpoch 1 step 35 with [31mce_loss_combined : 0.517079 [31mce_loss_eeg : 0.718905 [31mce_loss_eog : 0.584364 [31mtotal : 1.820348 [94mAcc_combined: 81.53 [94mAcc_eeg: 74.11 [94mAcc_eog: 79.59 [92mF1_combined: 66.77 [92mF1_eeg: 58.66 [92mF1_eog: 64.62 [92mK_combined: 0.7420 [92mK_eeg: 0.6382 [92mK_eog: 0.7137 [34mF1_perclass_combined: [87.37, 4.29, 82.32, 78.84, 81.01] [34mF1_perclass_eeg: [86.16, 0.0, 74.07, 76.2, 56.86] [34mF1_perclass_eog: [84.4, 0.06, 80.22, 76.67, 81.75] 
[37mEpoch 2 step 57 with [31mce_loss_combined : 0.500547 [31mce_loss_eeg : 0.704643 [31mce_loss_eog : 0.574788 [31mtotal : 1.779978 [94mAcc_combined: 82.22 [94mAcc_eeg: 74.51 [94mAcc_eog: 79.57 [92mF1_combined: 71.88 [92mF1_eeg: 60.04 [92mF1_eog: 66.46 [92mK_combined: 0.7498 [92mK_eeg: 0.6483 [92mK_eog: 0.7107 [34mF1_perclass_combined: [88.34, 28.18, 83.56, 75.46, 83.88] [34mF1_perclass_eeg: [85.88, 2.22, 74.56, 76.28, 61.24] [34mF1_perclass_eog: [85.42, 13.23, 80.95, 69.48, 83.2] 
[37mEpoch 3 step 64 with [31mce_loss_combined : 0.484054 [31mce_loss_eeg : 0.688849 [31mce_loss_eog : 0.539384 [31mtotal : 1.712287 [94mAcc_combined: 82.98 [94mAcc_eeg: 75.59 [94mAcc_eog: 80.77 [92mF1_combined: 71.15 [92mF1_eeg: 59.72 [92mF1_eog: 67.69 [92mK_combined: 0.7636 [92mK_eeg: 0.6568 [92mK_eog: 0.7301 [34mF1_perclass_combined: [88.37, 19.07, 83.36, 81.27, 83.69] [34mF1_perclass_eeg: [83.72, 0.55, 76.53, 79.11, 58.68] [34mF1_perclass_eog: [85.97, 11.05, 81.32, 75.86, 84.26] 
[37mEpoch 3 step 72 with [31mce_loss_combined : 0.463483 [31mce_loss_eeg : 0.666073 [31mce_loss_eog : 0.534796 [31mtotal : 1.664352 [94mAcc_combined: 83.23 [94mAcc_eeg: 76.46 [94mAcc_eog: 80.88 [92mF1_combined: 68.81 [92mF1_eeg: 60.63 [92mF1_eog: 66.34 [92mK_combined: 0.7662 [92mK_eeg: 0.6707 [92mK_eog: 0.7306 [34mF1_perclass_combined: [88.79, 5.34, 82.99, 81.51, 85.42] [34mF1_perclass_eeg: [86.72, 0.0, 76.67, 80.81, 58.94] [34mF1_perclass_eog: [85.79, 2.81, 81.15, 76.89, 85.04] 
[37mEpoch 4 step 91 with [31mce_loss_combined : 0.452909 [31mce_loss_eeg : 0.646341 [31mce_loss_eog : 0.531479 [31mtotal : 1.630729 [94mAcc_combined: 84.06 [94mAcc_eeg: 76.94 [94mAcc_eog: 80.97 [92mF1_combined: 70.82 [92mF1_eeg: 61.64 [92mF1_eog: 67.07 [92mK_combined: 0.7769 [92mK_eeg: 0.6802 [92mK_eog: 0.7306 [34mF1_perclass_combined: [88.65, 12.85, 84.56, 82.58, 85.47] [34mF1_perclass_eeg: [85.93, 0.11, 77.41, 81.54, 63.23] [34mF1_perclass_eog: [85.93, 6.89, 81.48, 76.2, 84.84] 
[37mEpoch 4 step 92 with [31mce_loss_combined : 0.452434 [31mce_loss_eeg : 0.638906 [31mce_loss_eog : 0.532990 [31mtotal : 1.624330 [94mAcc_combined: 84.12 [94mAcc_eeg: 77.17 [94mAcc_eog: 80.96 [92mF1_combined: 73.64 [92mF1_eeg: 61.76 [92mF1_eog: 69.05 [92mK_combined: 0.7792 [92mK_eeg: 0.6826 [92mK_eog: 0.7321 [34mF1_perclass_combined: [88.59, 26.57, 84.65, 82.7, 85.69] [34mF1_perclass_eeg: [85.9, 0.72, 77.57, 81.61, 62.99] [34mF1_perclass_eog: [85.56, 17.33, 81.91, 76.19, 84.29] 
[37mEpoch 4 step 93 with [31mce_loss_combined : 0.440375 [31mce_loss_eeg : 0.635686 [31mce_loss_eog : 0.519795 [31mtotal : 1.595856 [94mAcc_combined: 84.47 [94mAcc_eeg: 77.39 [94mAcc_eog: 81.25 [92mF1_combined: 72.94 [92mF1_eeg: 61.88 [92mF1_eog: 68.59 [92mK_combined: 0.7832 [92mK_eeg: 0.6847 [92mK_eog: 0.7354 [34mF1_perclass_combined: [89.13, 21.84, 84.96, 83.01, 85.76] [34mF1_perclass_eeg: [85.93, 0.66, 78.04, 81.78, 63.01] [34mF1_perclass_eog: [86.13, 13.29, 81.82, 76.52, 85.21] 
[37mEpoch 4 step 94 with [31mce_loss_combined : 0.439250 [31mce_loss_eeg : 0.636025 [31mce_loss_eog : 0.517434 [31mtotal : 1.592709 [94mAcc_combined: 84.62 [94mAcc_eeg: 77.45 [94mAcc_eog: 81.30 [92mF1_combined: 72.94 [92mF1_eeg: 61.88 [92mF1_eog: 68.49 [92mK_combined: 0.7849 [92mK_eeg: 0.6846 [92mK_eog: 0.7359 [34mF1_perclass_combined: [89.17, 21.49, 85.28, 82.86, 85.87] [34mF1_perclass_eeg: [85.89, 0.55, 78.39, 81.38, 63.2] [34mF1_perclass_eog: [86.19, 12.68, 81.84, 76.28, 85.46] 
[37mEpoch 5 step 122 with [31mce_loss_combined : 0.426717 [31mce_loss_eeg : 0.609072 [31mce_loss_eog : 0.506292 [31mtotal : 1.542081 [94mAcc_combined: 84.98 [94mAcc_eeg: 78.51 [94mAcc_eog: 81.84 [92mF1_combined: 74.06 [92mF1_eeg: 63.19 [92mF1_eog: 69.60 [92mK_combined: 0.7897 [92mK_eeg: 0.6979 [92mK_eog: 0.7446 [34mF1_perclass_combined: [90.1, 25.31, 85.42, 82.91, 86.54] [34mF1_perclass_eeg: [86.51, 3.07, 79.86, 82.67, 63.82] [34mF1_perclass_eog: [87.59, 15.63, 82.02, 77.3, 85.44] 
[37mEpoch 5 step 123 with [31mce_loss_combined : 0.431829 [31mce_loss_eeg : 0.605008 [31mce_loss_eog : 0.498671 [31mtotal : 1.535508 [94mAcc_combined: 84.89 [94mAcc_eeg: 78.77 [94mAcc_eog: 82.03 [92mF1_combined: 74.21 [92mF1_eeg: 63.42 [92mF1_eog: 70.72 [92mK_combined: 0.7891 [92mK_eeg: 0.7019 [92mK_eog: 0.7491 [34mF1_perclass_combined: [89.48, 26.24, 85.4, 83.3, 86.62] [34mF1_perclass_eeg: [86.53, 2.91, 79.72, 82.82, 65.11] [34mF1_perclass_eog: [87.41, 20.34, 82.22, 77.57, 86.07] 
[37mEpoch 6 step 128 with [31mce_loss_combined : 0.418763 [31mce_loss_eeg : 0.607467 [31mce_loss_eog : 0.492842 [31mtotal : 1.519072 [94mAcc_combined: 85.48 [94mAcc_eeg: 78.75 [94mAcc_eog: 82.14 [92mF1_combined: 75.22 [92mF1_eeg: 63.29 [92mF1_eog: 70.65 [92mK_combined: 0.7970 [92mK_eeg: 0.6998 [92mK_eog: 0.7495 [34mF1_perclass_combined: [89.94, 29.89, 86.29, 83.68, 86.3] [34mF1_perclass_eeg: [85.41, 3.26, 80.48, 81.87, 65.44] [34mF1_perclass_eog: [87.75, 19.87, 82.45, 77.19, 86.0] 
[37mEpoch 6 step 132 with [31mce_loss_combined : 0.414527 [31mce_loss_eeg : 0.611105 [31mce_loss_eog : 0.490837 [31mtotal : 1.516469 [94mAcc_combined: 85.62 [94mAcc_eeg: 78.05 [94mAcc_eog: 82.15 [92mF1_combined: 75.44 [92mF1_eeg: 63.30 [92mF1_eog: 70.05 [92mK_combined: 0.7992 [92mK_eeg: 0.6968 [92mK_eog: 0.7486 [34mF1_perclass_combined: [90.12, 30.46, 86.35, 83.62, 86.64] [34mF1_perclass_eeg: [86.47, 2.67, 78.45, 82.94, 65.97] [34mF1_perclass_eog: [87.74, 17.21, 82.52, 76.71, 86.05] 
[37mEpoch 6 step 133 with [31mce_loss_combined : 0.416520 [31mce_loss_eeg : 0.606155 [31mce_loss_eog : 0.490444 [31mtotal : 1.513118 [94mAcc_combined: 85.58 [94mAcc_eeg: 78.31 [94mAcc_eog: 82.16 [92mF1_combined: 75.85 [92mF1_eeg: 63.62 [92mF1_eog: 70.56 [92mK_combined: 0.7992 [92mK_eeg: 0.7002 [92mK_eog: 0.7492 [34mF1_perclass_combined: [90.0, 32.48, 86.28, 83.77, 86.72] [34mF1_perclass_eeg: [86.44, 3.4, 78.69, 83.1, 66.5] [34mF1_perclass_eog: [87.63, 19.85, 82.61, 76.63, 86.09] 
[37mEpoch 6 step 134 with [31mce_loss_combined : 0.413307 [31mce_loss_eeg : 0.603763 [31mce_loss_eog : 0.489480 [31mtotal : 1.506551 [94mAcc_combined: 85.60 [94mAcc_eeg: 78.44 [94mAcc_eog: 82.19 [92mF1_combined: 75.89 [92mF1_eeg: 63.70 [92mF1_eog: 70.61 [92mK_combined: 0.7993 [92mK_eeg: 0.7017 [92mK_eog: 0.7495 [34mF1_perclass_combined: [90.1, 32.57, 86.24, 83.82, 86.72] [34mF1_perclass_eeg: [86.44, 3.34, 78.87, 83.09, 66.73] [34mF1_perclass_eog: [87.8, 19.84, 82.57, 76.8, 86.03] 
[37mEpoch 6 step 135 with [31mce_loss_combined : 0.413188 [31mce_loss_eeg : 0.602504 [31mce_loss_eog : 0.489370 [31mtotal : 1.505061 [94mAcc_combined: 85.62 [94mAcc_eeg: 78.55 [94mAcc_eog: 82.19 [92mF1_combined: 75.87 [92mF1_eeg: 63.78 [92mF1_eog: 70.57 [92mK_combined: 0.7994 [92mK_eeg: 0.7028 [92mK_eog: 0.7494 [34mF1_perclass_combined: [90.12, 32.44, 86.31, 83.74, 86.73] [34mF1_perclass_eeg: [86.44, 3.45, 79.1, 83.09, 66.82] [34mF1_perclass_eog: [87.8, 19.63, 82.6, 76.75, 86.05] 
[37mEpoch 6 step 136 with [31mce_loss_combined : 0.412789 [31mce_loss_eeg : 0.602560 [31mce_loss_eog : 0.489391 [31mtotal : 1.504740 [94mAcc_combined: 85.63 [94mAcc_eeg: 78.54 [94mAcc_eog: 82.18 [92mF1_combined: 75.81 [92mF1_eeg: 63.76 [92mF1_eog: 70.50 [92mK_combined: 0.7994 [92mK_eeg: 0.7026 [92mK_eog: 0.7492 [34mF1_perclass_combined: [90.14, 32.15, 86.3, 83.71, 86.75] [34mF1_perclass_eeg: [86.43, 3.4, 79.12, 83.04, 66.81] [34mF1_perclass_eog: [87.83, 19.31, 82.55, 76.76, 86.07] 
[37mEpoch 8 step 183 with [31mce_loss_combined : 0.418740 [31mce_loss_eeg : 0.587768 [31mce_loss_eog : 0.485288 [31mtotal : 1.491795 [94mAcc_combined: 85.30 [94mAcc_eeg: 79.60 [94mAcc_eog: 82.67 [92mF1_combined: 75.14 [92mF1_eeg: 64.57 [92mF1_eog: 70.47 [92mK_combined: 0.7936 [92mK_eeg: 0.7121 [92mK_eog: 0.7558 [34mF1_perclass_combined: [90.55, 31.17, 86.14, 80.94, 86.89] [34mF1_perclass_eeg: [86.65, 5.01, 81.25, 81.11, 68.82] [34mF1_perclass_eog: [88.79, 17.6, 82.99, 76.35, 86.65] 
[37mEpoch 8 step 185 with [31mce_loss_combined : 0.414217 [31mce_loss_eeg : 0.596211 [31mce_loss_eog : 0.472866 [31mtotal : 1.483294 [94mAcc_combined: 85.90 [94mAcc_eeg: 79.36 [94mAcc_eog: 82.78 [92mF1_combined: 76.50 [92mF1_eeg: 65.19 [92mF1_eog: 72.20 [92mK_combined: 0.8035 [92mK_eeg: 0.7133 [92mK_eog: 0.7588 [34mF1_perclass_combined: [90.03, 34.43, 86.69, 84.11, 87.26] [34mF1_perclass_eeg: [86.25, 7.2, 80.15, 83.55, 68.79] [34mF1_perclass_eog: [88.32, 25.57, 83.25, 77.11, 86.75] 
[37mEpoch 9 step 187 with [31mce_loss_combined : 0.415037 [31mce_loss_eeg : 0.567248 [31mce_loss_eog : 0.486585 [31mtotal : 1.468871 [94mAcc_combined: 85.41 [94mAcc_eeg: 80.24 [94mAcc_eog: 82.28 [92mF1_combined: 76.96 [92mF1_eeg: 66.56 [92mF1_eog: 72.27 [92mK_combined: 0.7984 [92mK_eeg: 0.7249 [92mK_eog: 0.7528 [34mF1_perclass_combined: [90.1, 38.34, 86.05, 83.92, 86.42] [34mF1_perclass_eeg: [86.85, 10.53, 81.06, 83.68, 70.7] [34mF1_perclass_eog: [88.3, 28.16, 82.66, 76.44, 85.77] 
[37mEpoch 9 step 194 with [31mce_loss_combined : 0.413872 [31mce_loss_eeg : 0.568592 [31mce_loss_eog : 0.480989 [31mtotal : 1.463453 [94mAcc_combined: 85.82 [94mAcc_eeg: 80.20 [94mAcc_eog: 82.47 [92mF1_combined: 76.03 [92mF1_eeg: 66.17 [92mF1_eog: 70.65 [92mK_combined: 0.8016 [92mK_eeg: 0.7237 [92mK_eog: 0.7532 [34mF1_perclass_combined: [90.12, 32.31, 86.56, 83.74, 87.42] [34mF1_perclass_eeg: [87.14, 8.61, 81.31, 83.39, 70.4] [34mF1_perclass_eog: [87.97, 18.94, 82.9, 76.93, 86.49] 
[37mEpoch 9 step 203 with [31mce_loss_combined : 0.411327 [31mce_loss_eeg : 0.573931 [31mce_loss_eog : 0.474862 [31mtotal : 1.460119 [94mAcc_combined: 85.91 [94mAcc_eeg: 80.00 [94mAcc_eog: 82.57 [92mF1_combined: 77.08 [92mF1_eeg: 67.05 [92mF1_eog: 71.47 [92mK_combined: 0.8042 [92mK_eeg: 0.7212 [92mK_eog: 0.7543 [34mF1_perclass_combined: [90.52, 37.28, 86.63, 83.95, 87.02] [34mF1_perclass_eeg: [87.3, 14.32, 80.79, 83.13, 69.7] [34mF1_perclass_eog: [88.9, 24.17, 83.2, 74.25, 86.83] 
[37mEpoch 9 step 204 with [31mce_loss_combined : 0.405921 [31mce_loss_eeg : 0.563311 [31mce_loss_eog : 0.461580 [31mtotal : 1.430812 [94mAcc_combined: 85.98 [94mAcc_eeg: 80.44 [94mAcc_eog: 83.13 [92mF1_combined: 77.13 [92mF1_eeg: 67.44 [92mF1_eog: 71.83 [92mK_combined: 0.8052 [92mK_eeg: 0.7273 [92mK_eog: 0.7642 [34mF1_perclass_combined: [90.52, 37.28, 86.63, 84.09, 87.12] [34mF1_perclass_eeg: [87.29, 14.0, 81.43, 83.65, 70.84] [34mF1_perclass_eog: [89.06, 21.81, 83.29, 77.99, 87.0] 
{'val_loss': {'ce_loss_combined': 0.40592077, 'ce_loss_eeg': 0.5633106, 'ce_loss_eog': 0.46158046, 'total': 1.4308118}, 'val_acc': {'combined': 0.859824356788979, 'eeg': 0.804380115035338, 'eog': 0.8313346690989563}, 'val_f1': {'combined': 0.77127140405892, 'eeg': 0.6744003590758203, 'eog': 0.7183024592087429}, 'val_k': {'combined': 0.805203092303604, 'eeg': 0.7273010382198835, 'eog': 0.764227301911162}, 'val_perclassf1': {'combined': array([0.90522969, 0.37275242, 0.8662862 , 0.84093326, 0.87115544]), 'eeg': array([0.87286581, 0.13995897, 0.81427925, 0.83650389, 0.70839388]), 'eog': array([0.89057641, 0.2181215 , 0.8329163 , 0.77992074, 0.86997735])}}
We are in the final state.
 THE Configuration of your experiment ..
{'agent': 'Sleep_Agent_Init_Train',
 'augmentation': {},
 'channel': 0,
 'dataset': {'cache_datasets': {'test': False, 'train': False, 'valid': False},
             'data_roots': '/esat/biomeddata/SHHS_Dataset/no_backup',
             'data_split': {'split_method': 'patients_test',
                            'test_split_rate': 0.3,
                            'val_split_rate': 0.026},
             'data_view_dir': [{'data_type': 'stft',
                                'list_dir': 'patient_mat_list.txt',
                                'mod': 'eeg',
                                'num_ch': 1},
                               {'data_type': 'stft',
                                'list_dir': 'patient_eog_mat_list.txt',
                                'mod': 'eog',
                                'num_ch': 1}],
             'dataloader_class': 'SleepDataLoader_mat_huy',
             'filter_windows': {'test': {'perc_threshold': 0.4,
                                         'skip_skips': True,
                                         'std_threshold': 41,
                                         'use_type': 'include_only_skipped',
                                         'whole_patient': False},
                                'train': {'perc_threshold': 0.4,
                                          'skip_skips': False,
                                          'std_threshold': 41,
                                          'subsets': {'combined': 100,
                                                      'eeg': 0,
                                                      'eog': 600},
                                          'use_type': 'subsample',
                                          'whole_patient': True},
                                'val': {'skip_skips': True,
                                        'use_type': False,
                                        'whole_patient': False}},
             'huy_data': True,
             'inner_overlap': [0.5, 0.5],
             'keep_view': [1, 0],
             'seq_length': [21, 0],
             'seq_views': [False],
             'shuffle_train': True},
 'early_stopping': {'log_interval': 10,
                    'max_epoch': 1000,
                    'n_steps_stop': 100,
                    'n_steps_stop_after': 50,
                    'save_every': 1,
                    'validate_after': 0,
                    'validate_every': 50},
 'exp_name': 'Sleep EEG-EOG BLIP Experiment',
 'lr_finder': False,
 'lr_finder_steps': 100,
 'mode': 'train',
 'model': {'args': {'augment_within': False,
                    'dmodel': 128,
                    'dropout': 0.3,
                    'fc_inner': 1024,
                    'ignore_alignment_val': True,
                    'multi_loss': {'multi_loss_weights': {'alignment_loss': 0.1,
                                                          'multi_supervised_loss': {'combined': 1,
                                                                                    'eeg': 1,
                                                                                    'eog': 1},
                                                          'order_loss': 0}},
                    'num_classes': 5,
                    'three_modes': True,
                    'training_type': 'alignment_order_multisupervised'},
           'encoders': [{'args': {'align_inner': True,
                                  'd_model': 128,
                                  'dim_feedforward': 1024,
                                  'dim_proj': 128,
                                  'dropout': 0.3,
                                  'inner_biased': False,
                                  'mod_token': False,
                                  'num_heads': 8,
                                  'num_layers': 4,
                                  'outer_biased': False,
                                  'outer_rep': False,
                                  'pos': False,
                                  'rpos': True,
                                  'shared': True,
                                  'skip_random_mod': False},
                         'encoders': [],
                         'freeze_encoder': False,
                         'model': 'SleepEnc_BLIP_EEG_EOG_shared_free_cliplike',
                         'pretrainedEncoder': {'dir': '', 'use': False},
                         'savetrainedEncoder': {'dir': '', 'save': False}}],
           'load_ongoing': False,
           'model_class': 'EEG_SLEEP_BLIP_GM_MultiMode',
           'pretrained_model': {'dir': '', 'use': False},
           'save_dir': '/esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2021_data/shhs1/multi_modal/paper_models/fourier_transformer_eeg_eog_mat_BLIP_al01_shared_b16_freetrain_rpos_nopos_nonsharedpreds_drop03_align_inner_trial1_pt_incomplete_100p_0e_600o.pth.tar'},
 'normalization': {'calculate_metrics': False,
                   'dir': '/esat/biomeddata/SHHS_Dataset/no_backup/metrics_eeg_eog_emg_stft.pkl',
                   'metrics_type': 'train_dataset',
                   'save_metrics': False,
                   'use': True},
 'num_classes': 5,
 'num_modalities': 1,
 'optimizer': {'beta1': 0.9,
               'beta2': 0.999,
               'learning_rate': 0.0001,
               'momentum': 0.2,
               'type': 'Adam',
               'weight_decay': 0.0001},
 'plots': {'plot_stft_num': 0, 'save': False},
 'post_proc': {'post_proc_step': 15,
               'test_postprocessing': False,
               'val_postprocessing': False},
 'scheduler': {'max_lr': 0.03, 'type': 'cosanneal', 'warm_up': 55},
 'statistics': {'ce_weights': {'temp': 0.1, 'use': False}, 'print': False},
 'training_params': {'adversarial_training': {'adv_epsilon': 0.01,
                                              'use': False},
                     'async_loading': True,
                     'batch_size': 32,
                     'cuda': False,
                     'data_loader_workers': 8,
                     'gpu_device': [0],
                     'pin_memory': True,
                     'rec_test': False,
                     'res': True,
                     'seed': 28,
                     'tdqm_disable': True,
                     'test_batch_size': 32,
                     'test_on_tops': True,
                     'use_test_set': True,
                     'validation': True,
                     'verbose': True,
                     'wandb_disable': True}}
 *************************************** 
The experiment name is Sleep EEG-EOG BLIP Experiment
 *************************************** 
stft_eeg Train 3724 validation 100 test 1639
stft_eog Train 3724 validation 100 test 1639
{'use_type': 'subsample', 'skip_skips': False, 'whole_patient': True, 'std_threshold': 41, 'perc_threshold': 0.4, 'subsets': {'combined': 100, 'eeg': 0, 'eog': 600}}
We subsample patients with 100 both mods, 0 only EEG and 600 only EOG and len_skipped is 700.
{'use_type': False, 'skip_skips': True, 'whole_patient': False}
{'use_type': 'include_only_skipped', 'skip_skips': True, 'whole_patient': False, 'std_threshold': 41, 'perc_threshold': 0.4}
Patients with broken modalities are 24
{'use_type': False, 'skip_skips': True}
Loading metrics from /esat/biomeddata/SHHS_Dataset/no_backup/metrics_eeg_eog_emg_stft.pkl
Weights are [1. 1. 1. 1. 1.]
1035
50
21
tensor([1., 1., 1., 1., 1.], device='cuda:0')
We are not shuffling the data
Training function is sleep_train_one_step_alignment_order_multisupervised
Loss Weights are {'combined': 1, 'eeg': 1, 'eog': 1, 'alignments': 0.1, 'order': 0, 'consistency': 0, 'reconstruction': 0}
We are not shuffling the data
<class 'graphs.models.attention_models.BLIP.SleepEnc_BLIP_EEG_EOG_shared_free_cliplike'>
Total number of trainable parameters are: 7628293
Available cuda devices: 1, current device:0
Total number of trainable parameters are: 7628293
[37mEpoch 0 step 1 with [31mce_loss_combined : 1.164375 [31mce_loss_eeg : 1.275105 [31mce_loss_eog : 1.086422 [31mtotal : 3.525902 [94mAcc_combined: 52.76 [94mAcc_eeg: 49.03 [94mAcc_eog: 57.44 [92mF1_combined: 25.37 [92mF1_eeg: 23.54 [92mF1_eog: 29.48 [92mK_combined: 0.2964 [92mK_eeg: 0.2508 [92mK_eog: 0.3328 [34mF1_perclass_combined: [63.55, 0.0, 63.3, 0.01, 0.0] [34mF1_perclass_eeg: [60.55, 0.0, 57.16, 0.0, 0.0] [34mF1_perclass_eog: [75.13, 0.0, 65.93, 0.0, 6.32] 
[37mEpoch 0 step 5 with [31mce_loss_combined : 0.882083 [31mce_loss_eeg : 1.182082 [31mce_loss_eog : 0.897059 [31mtotal : 2.961223 [94mAcc_combined: 67.15 [94mAcc_eeg: 50.10 [94mAcc_eog: 69.69 [92mF1_combined: 52.45 [92mF1_eeg: 24.07 [92mF1_eog: 53.03 [92mK_combined: 0.5433 [92mK_eeg: 0.2660 [92mK_eog: 0.5668 [34mF1_perclass_combined: [75.55, 0.0, 73.69, 57.85, 55.14] [34mF1_perclass_eeg: [61.4, 0.0, 58.93, 0.0, 0.0] [34mF1_perclass_eog: [77.78, 0.0, 75.33, 55.17, 56.86] 
[37mEpoch 0 step 6 with [31mce_loss_combined : 0.922697 [31mce_loss_eeg : 1.059505 [31mce_loss_eog : 0.888858 [31mtotal : 2.871061 [94mAcc_combined: 67.82 [94mAcc_eeg: 60.28 [94mAcc_eog: 68.12 [92mF1_combined: 52.95 [92mF1_eeg: 29.70 [92mF1_eog: 53.35 [92mK_combined: 0.5539 [92mK_eeg: 0.3843 [92mK_eog: 0.5578 [34mF1_perclass_combined: [75.1, 0.0, 69.02, 69.51, 51.1] [34mF1_perclass_eeg: [80.39, 0.0, 68.12, 0.0, 0.0] [34mF1_perclass_eog: [74.64, 0.0, 69.99, 69.13, 53.01] 
[37mEpoch 0 step 10 with [31mce_loss_combined : 0.853486 [31mce_loss_eeg : 1.039262 [31mce_loss_eog : 0.727089 [31mtotal : 2.619837 [94mAcc_combined: 66.65 [94mAcc_eeg: 59.34 [94mAcc_eog: 73.92 [92mF1_combined: 50.79 [92mF1_eeg: 28.91 [92mF1_eog: 59.15 [92mK_combined: 0.5175 [92mK_eeg: 0.3786 [92mK_eog: 0.6305 [34mF1_perclass_combined: [72.6, 0.0, 72.18, 54.1, 55.07] [34mF1_perclass_eeg: [76.88, 0.0, 67.67, 0.0, 0.0] [34mF1_perclass_eog: [78.15, 0.0, 76.67, 70.77, 70.15] 
[37mEpoch 0 step 11 with [31mce_loss_combined : 0.780816 [31mce_loss_eeg : 1.064065 [31mce_loss_eog : 0.770309 [31mtotal : 2.615190 [94mAcc_combined: 68.88 [94mAcc_eeg: 60.03 [94mAcc_eog: 71.02 [92mF1_combined: 49.35 [92mF1_eeg: 30.77 [92mF1_eog: 53.73 [92mK_combined: 0.5360 [92mK_eeg: 0.3769 [92mK_eog: 0.5851 [34mF1_perclass_combined: [82.09, 0.0, 73.6, 39.97, 51.1] [34mF1_perclass_eeg: [82.3, 0.0, 67.51, 0.46, 3.56] [34mF1_perclass_eog: [78.66, 0.0, 74.95, 43.28, 71.77] 
[37mEpoch 0 step 12 with [31mce_loss_combined : 0.771466 [31mce_loss_eeg : 0.989073 [31mce_loss_eog : 0.738246 [31mtotal : 2.498785 [94mAcc_combined: 72.54 [94mAcc_eeg: 63.63 [94mAcc_eog: 72.18 [92mF1_combined: 58.41 [92mF1_eeg: 39.21 [92mF1_eog: 57.01 [92mK_combined: 0.6267 [92mK_eeg: 0.4597 [92mK_eog: 0.6071 [34mF1_perclass_combined: [78.34, 0.0, 72.65, 72.58, 68.47] [34mF1_perclass_eeg: [79.31, 0.0, 69.64, 0.03, 47.07] [34mF1_perclass_eog: [78.53, 0.0, 73.79, 74.44, 58.28] 
[37mEpoch 0 step 13 with [31mce_loss_combined : 0.820474 [31mce_loss_eeg : 0.915578 [31mce_loss_eog : 0.731456 [31mtotal : 2.467507 [94mAcc_combined: 74.63 [94mAcc_eeg: 65.56 [94mAcc_eog: 74.27 [92mF1_combined: 58.90 [92mF1_eeg: 41.58 [92mF1_eog: 59.55 [92mK_combined: 0.6423 [92mK_eeg: 0.4903 [92mK_eog: 0.6388 [34mF1_perclass_combined: [79.02, 0.0, 78.2, 73.41, 63.87] [34mF1_perclass_eeg: [81.83, 0.0, 70.77, 0.0, 55.31] [34mF1_perclass_eog: [76.85, 0.0, 77.25, 73.84, 69.84] 
[37mEpoch 0 step 14 with [31mce_loss_combined : 0.691789 [31mce_loss_eeg : 0.950992 [31mce_loss_eog : 0.672209 [31mtotal : 2.314990 [94mAcc_combined: 74.87 [94mAcc_eeg: 61.92 [94mAcc_eog: 74.78 [92mF1_combined: 57.99 [92mF1_eeg: 39.10 [92mF1_eog: 58.67 [92mK_combined: 0.6357 [92mK_eeg: 0.4477 [92mK_eog: 0.6359 [34mF1_perclass_combined: [82.19, 0.0, 78.31, 59.01, 70.44] [34mF1_perclass_eeg: [78.17, 0.0, 66.77, 0.0, 50.55] [34mF1_perclass_eog: [81.49, 0.0, 77.29, 58.95, 75.6] 
[37mEpoch 0 step 15 with [31mce_loss_combined : 0.643430 [31mce_loss_eeg : 0.885965 [31mce_loss_eog : 0.668646 [31mtotal : 2.198041 [94mAcc_combined: 75.90 [94mAcc_eeg: 59.43 [94mAcc_eog: 74.78 [92mF1_combined: 61.36 [92mF1_eeg: 29.97 [92mF1_eog: 60.86 [92mK_combined: 0.6682 [92mK_eeg: 0.3637 [92mK_eog: 0.6525 [34mF1_perclass_combined: [83.41, 0.0, 75.36, 73.56, 74.45] [34mF1_perclass_eeg: [83.51, 0.0, 65.85, 0.48, 0.0] [34mF1_perclass_eog: [77.62, 0.0, 75.19, 73.97, 77.51] 
[37mEpoch 1 step 30 with [31mce_loss_combined : 0.588362 [31mce_loss_eeg : 0.912675 [31mce_loss_eog : 0.606597 [31mtotal : 2.107634 [94mAcc_combined: 78.14 [94mAcc_eeg: 66.43 [94mAcc_eog: 77.51 [92mF1_combined: 61.54 [92mF1_eeg: 46.32 [92mF1_eog: 61.83 [92mK_combined: 0.6859 [92mK_eeg: 0.5195 [92mK_eog: 0.6820 [34mF1_perclass_combined: [84.76, 0.0, 80.52, 62.95, 79.46] [34mF1_perclass_eeg: [75.83, 0.0, 72.43, 64.63, 18.74] [34mF1_perclass_eog: [82.62, 0.0, 79.4, 66.79, 80.34] 
[37mEpoch 1 step 31 with [31mce_loss_combined : 0.621725 [31mce_loss_eeg : 0.854391 [31mce_loss_eog : 0.628276 [31mtotal : 2.104392 [94mAcc_combined: 75.01 [94mAcc_eeg: 65.92 [94mAcc_eog: 74.64 [92mF1_combined: 54.64 [92mF1_eeg: 41.54 [92mF1_eog: 55.87 [92mK_combined: 0.6365 [92mK_eeg: 0.4883 [92mK_eog: 0.6326 [34mF1_perclass_combined: [87.02, 0.0, 77.04, 27.25, 81.89] [34mF1_perclass_eeg: [84.91, 0.0, 70.41, 0.2, 52.18] [34mF1_perclass_eog: [84.31, 0.0, 76.9, 36.55, 81.61] 
[37mEpoch 1 step 32 with [31mce_loss_combined : 0.574864 [31mce_loss_eeg : 0.908987 [31mce_loss_eog : 0.591255 [31mtotal : 2.075105 [94mAcc_combined: 79.77 [94mAcc_eeg: 64.65 [94mAcc_eog: 78.43 [92mF1_combined: 64.88 [92mF1_eeg: 39.17 [92mF1_eog: 63.49 [92mK_combined: 0.7136 [92mK_eeg: 0.4624 [92mK_eog: 0.6935 [34mF1_perclass_combined: [87.69, 3.21, 80.02, 76.4, 77.09] [34mF1_perclass_eeg: [85.87, 0.0, 69.88, 0.39, 39.73] [34mF1_perclass_eog: [82.95, 0.0, 79.41, 74.69, 80.38] 
[37mEpoch 1 step 33 with [31mce_loss_combined : 0.529157 [31mce_loss_eeg : 0.882518 [31mce_loss_eog : 0.596246 [31mtotal : 2.007921 [94mAcc_combined: 81.06 [94mAcc_eeg: 67.72 [94mAcc_eog: 78.97 [92mF1_combined: 65.77 [92mF1_eeg: 46.09 [92mF1_eog: 64.02 [92mK_combined: 0.7356 [92mK_eeg: 0.5278 [92mK_eog: 0.6998 [34mF1_perclass_combined: [87.34, 0.0, 81.01, 77.9, 82.6] [34mF1_perclass_eeg: [81.97, 0.0, 71.29, 66.93, 10.28] [34mF1_perclass_eog: [83.87, 0.0, 79.74, 75.53, 80.97] 
[37mEpoch 1 step 34 with [31mce_loss_combined : 0.515202 [31mce_loss_eeg : 0.828214 [31mce_loss_eog : 0.574052 [31mtotal : 1.917468 [94mAcc_combined: 81.21 [94mAcc_eeg: 67.18 [94mAcc_eog: 79.05 [92mF1_combined: 67.54 [92mF1_eeg: 45.11 [92mF1_eog: 63.80 [92mK_combined: 0.7346 [92mK_eeg: 0.5229 [92mK_eog: 0.6999 [34mF1_perclass_combined: [87.77, 8.51, 81.54, 76.89, 82.96] [34mF1_perclass_eeg: [84.08, 0.0, 70.21, 8.47, 62.79] [34mF1_perclass_eog: [84.3, 0.48, 80.12, 71.07, 83.03] 
[37mEpoch 2 step 46 with [31mce_loss_combined : 0.555429 [31mce_loss_eeg : 0.764263 [31mce_loss_eog : 0.576310 [31mtotal : 1.896002 [94mAcc_combined: 79.58 [94mAcc_eeg: 70.30 [94mAcc_eog: 79.67 [92mF1_combined: 63.47 [92mF1_eeg: 50.95 [92mF1_eog: 65.05 [92mK_combined: 0.7084 [92mK_eeg: 0.5679 [92mK_eog: 0.7128 [34mF1_perclass_combined: [88.52, 0.86, 80.46, 66.81, 80.7] [34mF1_perclass_eeg: [86.29, 0.0, 72.56, 29.52, 66.38] [34mF1_perclass_eog: [84.42, 3.35, 81.0, 74.84, 81.65] 
[37mEpoch 2 step 52 with [31mce_loss_combined : 0.452875 [31mce_loss_eeg : 0.757707 [31mce_loss_eog : 0.531282 [31mtotal : 1.741864 [94mAcc_combined: 83.31 [94mAcc_eeg: 71.27 [94mAcc_eog: 80.84 [92mF1_combined: 68.95 [92mF1_eeg: 52.42 [92mF1_eog: 66.40 [92mK_combined: 0.7651 [92mK_eeg: 0.5755 [92mK_eog: 0.7316 [34mF1_perclass_combined: [89.4, 6.83, 83.4, 80.13, 84.98] [34mF1_perclass_eeg: [86.22, 0.05, 74.02, 44.12, 57.67] [34mF1_perclass_eog: [85.65, 2.3, 80.74, 78.59, 84.74] 
[37mEpoch 2 step 60 with [31mce_loss_combined : 0.472287 [31mce_loss_eeg : 0.739762 [31mce_loss_eog : 0.512815 [31mtotal : 1.724864 [94mAcc_combined: 82.97 [94mAcc_eeg: 74.59 [94mAcc_eog: 81.42 [92mF1_combined: 67.48 [92mF1_eeg: 58.30 [92mF1_eog: 66.20 [92mK_combined: 0.7626 [92mK_eeg: 0.6399 [92mK_eog: 0.7400 [34mF1_perclass_combined: [88.64, 0.16, 82.94, 80.43, 85.24] [34mF1_perclass_eeg: [85.7, 0.0, 75.06, 77.61, 53.14] [34mF1_perclass_eog: [85.92, 0.27, 81.86, 78.01, 84.94] 
[37mEpoch 3 step 64 with [31mce_loss_combined : 0.453617 [31mce_loss_eeg : 0.726567 [31mce_loss_eog : 0.510548 [31mtotal : 1.690732 [94mAcc_combined: 83.29 [94mAcc_eeg: 74.85 [94mAcc_eog: 81.01 [92mF1_combined: 67.65 [92mF1_eeg: 57.73 [92mF1_eog: 65.79 [92mK_combined: 0.7636 [92mK_eeg: 0.6349 [92mK_eog: 0.7305 [34mF1_perclass_combined: [89.89, 0.0, 83.18, 80.38, 84.8] [34mF1_perclass_eeg: [86.29, 0.0, 76.9, 74.01, 51.44] [34mF1_perclass_eog: [85.82, 0.54, 81.54, 75.71, 85.36] 
[37mEpoch 3 step 65 with [31mce_loss_combined : 0.445011 [31mce_loss_eeg : 0.723044 [31mce_loss_eog : 0.506722 [31mtotal : 1.674776 [94mAcc_combined: 83.60 [94mAcc_eeg: 75.02 [94mAcc_eog: 81.24 [92mF1_combined: 67.93 [92mF1_eeg: 57.97 [92mF1_eog: 66.04 [92mK_combined: 0.7688 [92mK_eeg: 0.6383 [92mK_eog: 0.7352 [34mF1_perclass_combined: [90.0, 0.16, 83.52, 80.59, 85.38] [34mF1_perclass_eeg: [86.41, 0.0, 76.83, 75.76, 50.85] [34mF1_perclass_eog: [85.8, 0.43, 81.73, 76.89, 85.34] 
[37mEpoch 3 step 70 with [31mce_loss_combined : 0.458544 [31mce_loss_eeg : 0.705182 [31mce_loss_eog : 0.504507 [31mtotal : 1.668233 [94mAcc_combined: 83.25 [94mAcc_eeg: 77.67 [94mAcc_eog: 81.28 [92mF1_combined: 69.73 [92mF1_eeg: 62.30 [92mF1_eog: 66.91 [92mK_combined: 0.7668 [92mK_eeg: 0.6890 [92mK_eog: 0.7355 [34mF1_perclass_combined: [88.56, 10.92, 83.46, 80.41, 85.33] [34mF1_perclass_eeg: [85.53, 0.05, 78.58, 79.71, 67.63] [34mF1_perclass_eog: [86.02, 4.94, 81.76, 76.79, 85.04] 
[37mEpoch 3 step 73 with [31mce_loss_combined : 0.424791 [31mce_loss_eeg : 0.692725 [31mce_loss_eog : 0.484306 [31mtotal : 1.601822 [94mAcc_combined: 84.37 [94mAcc_eeg: 77.04 [94mAcc_eog: 82.08 [92mF1_combined: 71.04 [92mF1_eeg: 60.74 [92mF1_eog: 68.36 [92mK_combined: 0.7808 [92mK_eeg: 0.6724 [92mK_eog: 0.7470 [34mF1_perclass_combined: [90.15, 13.48, 84.75, 81.08, 85.73] [34mF1_perclass_eeg: [86.12, 0.43, 78.53, 80.12, 58.47] [34mF1_perclass_eog: [86.94, 8.49, 82.41, 77.44, 86.51] 
[37mEpoch 3 step 74 with [31mce_loss_combined : 0.424593 [31mce_loss_eeg : 0.692504 [31mce_loss_eog : 0.482428 [31mtotal : 1.599524 [94mAcc_combined: 84.34 [94mAcc_eeg: 77.12 [94mAcc_eog: 82.10 [92mF1_combined: 71.14 [92mF1_eeg: 60.84 [92mF1_eog: 68.52 [92mK_combined: 0.7803 [92mK_eeg: 0.6730 [92mK_eog: 0.7475 [34mF1_perclass_combined: [90.01, 14.26, 84.83, 80.96, 85.65] [34mF1_perclass_eeg: [86.07, 0.7, 78.79, 79.63, 59.0] [34mF1_perclass_eog: [86.9, 9.28, 82.45, 77.55, 86.44] 
[37mEpoch 3 step 75 with [31mce_loss_combined : 0.425302 [31mce_loss_eeg : 0.689449 [31mce_loss_eog : 0.481559 [31mtotal : 1.596310 [94mAcc_combined: 84.28 [94mAcc_eeg: 77.45 [94mAcc_eog: 82.11 [92mF1_combined: 70.88 [92mF1_eeg: 61.36 [92mF1_eog: 68.48 [92mK_combined: 0.7799 [92mK_eeg: 0.6791 [92mK_eog: 0.7482 [34mF1_perclass_combined: [89.86, 13.02, 84.72, 81.12, 85.7] [34mF1_perclass_eeg: [85.91, 0.65, 79.08, 79.89, 61.25] [34mF1_perclass_eog: [86.89, 8.63, 82.32, 78.07, 86.47] 
[37mEpoch 4 step 88 with [31mce_loss_combined : 0.426052 [31mce_loss_eeg : 0.667790 [31mce_loss_eog : 0.494596 [31mtotal : 1.588438 [94mAcc_combined: 84.46 [94mAcc_eeg: 77.08 [94mAcc_eog: 81.66 [92mF1_combined: 72.07 [92mF1_eeg: 62.53 [92mF1_eog: 69.84 [92mK_combined: 0.7839 [92mK_eeg: 0.6839 [92mK_eog: 0.7445 [34mF1_perclass_combined: [89.42, 17.7, 84.79, 81.67, 86.75] [34mF1_perclass_eeg: [86.39, 1.39, 77.77, 79.32, 67.79] [34mF1_perclass_eog: [85.4, 17.55, 82.25, 77.45, 86.55] 
[37mEpoch 4 step 89 with [31mce_loss_combined : 0.421908 [31mce_loss_eeg : 0.662176 [31mce_loss_eog : 0.475909 [31mtotal : 1.559992 [94mAcc_combined: 84.54 [94mAcc_eeg: 77.30 [94mAcc_eog: 82.28 [92mF1_combined: 70.73 [92mF1_eeg: 61.37 [92mF1_eog: 68.80 [92mK_combined: 0.7846 [92mK_eeg: 0.6795 [92mK_eog: 0.7521 [34mF1_perclass_combined: [89.78, 10.04, 84.61, 82.57, 86.62] [34mF1_perclass_eeg: [85.81, 0.54, 78.34, 81.26, 60.89] [34mF1_perclass_eog: [86.83, 9.38, 82.42, 79.02, 86.34] 
[37mEpoch 4 step 91 with [31mce_loss_combined : 0.405639 [31mce_loss_eeg : 0.643745 [31mce_loss_eog : 0.468987 [31mtotal : 1.518372 [94mAcc_combined: 84.92 [94mAcc_eeg: 78.53 [94mAcc_eog: 82.50 [92mF1_combined: 72.78 [92mF1_eeg: 63.21 [92mF1_eog: 69.82 [92mK_combined: 0.7900 [92mK_eeg: 0.6991 [92mK_eog: 0.7535 [34mF1_perclass_combined: [90.56, 18.85, 84.88, 82.57, 87.03] [34mF1_perclass_eeg: [86.44, 1.95, 79.47, 81.73, 66.47] [34mF1_perclass_eog: [87.39, 14.24, 82.86, 78.26, 86.34] 
[37mEpoch 4 step 92 with [31mce_loss_combined : 0.404226 [31mce_loss_eeg : 0.645688 [31mce_loss_eog : 0.466779 [31mtotal : 1.516693 [94mAcc_combined: 85.02 [94mAcc_eeg: 78.47 [94mAcc_eog: 82.66 [92mF1_combined: 73.36 [92mF1_eeg: 63.20 [92mF1_eog: 70.50 [92mK_combined: 0.7920 [92mK_eeg: 0.6979 [92mK_eog: 0.7571 [34mF1_perclass_combined: [90.6, 21.36, 84.88, 82.45, 87.52] [34mF1_perclass_eeg: [86.17, 2.47, 79.53, 81.77, 66.05] [34mF1_perclass_eog: [87.52, 16.56, 82.84, 78.84, 86.73] 
[37mEpoch 4 step 94 with [31mce_loss_combined : 0.396192 [31mce_loss_eeg : 0.645248 [31mce_loss_eog : 0.469440 [31mtotal : 1.510880 [94mAcc_combined: 85.32 [94mAcc_eeg: 78.49 [94mAcc_eog: 82.44 [92mF1_combined: 73.53 [92mF1_eeg: 63.10 [92mF1_eog: 70.03 [92mK_combined: 0.7948 [92mK_eeg: 0.6968 [92mK_eog: 0.7521 [34mF1_perclass_combined: [90.49, 21.58, 85.6, 82.43, 87.56] [34mF1_perclass_eeg: [86.13, 2.62, 79.83, 81.72, 65.22] [34mF1_perclass_eog: [87.55, 16.89, 83.03, 75.7, 86.98] 
[37mEpoch 4 step 95 with [31mce_loss_combined : 0.396114 [31mce_loss_eeg : 0.645303 [31mce_loss_eog : 0.467939 [31mtotal : 1.509356 [94mAcc_combined: 85.30 [94mAcc_eeg: 78.50 [94mAcc_eog: 82.49 [92mF1_combined: 73.44 [92mF1_eeg: 63.09 [92mF1_eog: 70.00 [92mK_combined: 0.7946 [92mK_eeg: 0.6967 [92mK_eog: 0.7528 [34mF1_perclass_combined: [90.5, 21.18, 85.58, 82.43, 87.52] [34mF1_perclass_eeg: [86.1, 2.62, 79.92, 81.68, 65.12] [34mF1_perclass_eog: [87.58, 16.28, 83.05, 76.2, 86.89] 
[37mEpoch 5 step 122 with [31mce_loss_combined : 0.400066 [31mce_loss_eeg : 0.630264 [31mce_loss_eog : 0.467042 [31mtotal : 1.497373 [94mAcc_combined: 85.08 [94mAcc_eeg: 79.70 [94mAcc_eog: 82.65 [92mF1_combined: 74.31 [92mF1_eeg: 64.84 [92mF1_eog: 70.13 [92mK_combined: 0.7927 [92mK_eeg: 0.7158 [92mK_eog: 0.7579 [34mF1_perclass_combined: [90.32, 26.27, 85.33, 83.17, 86.46] [34mF1_perclass_eeg: [85.99, 4.44, 81.28, 82.03, 70.46] [34mF1_perclass_eog: [87.93, 14.04, 82.33, 79.54, 86.81] 
[37mEpoch 6 step 125 with [31mce_loss_combined : 0.393959 [31mce_loss_eeg : 0.632612 [31mce_loss_eog : 0.469878 [31mtotal : 1.496449 [94mAcc_combined: 85.29 [94mAcc_eeg: 78.72 [94mAcc_eog: 82.15 [92mF1_combined: 71.73 [92mF1_eeg: 62.79 [92mF1_eog: 68.37 [92mK_combined: 0.7945 [92mK_eeg: 0.6997 [92mK_eog: 0.7491 [34mF1_perclass_combined: [91.15, 11.55, 85.02, 83.47, 87.46] [34mF1_perclass_eeg: [85.37, 0.96, 80.46, 82.53, 64.62] [34mF1_perclass_eog: [87.38, 6.36, 81.64, 79.15, 87.32] 
[37mEpoch 6 step 126 with [31mce_loss_combined : 0.384211 [31mce_loss_eeg : 0.628563 [31mce_loss_eog : 0.457767 [31mtotal : 1.470541 [94mAcc_combined: 85.78 [94mAcc_eeg: 78.86 [94mAcc_eog: 82.58 [92mF1_combined: 72.65 [92mF1_eeg: 63.10 [92mF1_eog: 69.23 [92mK_combined: 0.8004 [92mK_eeg: 0.6993 [92mK_eog: 0.7540 [34mF1_perclass_combined: [91.58, 14.32, 85.64, 84.0, 87.74] [34mF1_perclass_eeg: [87.21, 1.55, 79.93, 82.44, 64.35] [34mF1_perclass_eog: [87.93, 10.89, 82.69, 77.39, 87.26] 
[37mEpoch 6 step 128 with [31mce_loss_combined : 0.377841 [31mce_loss_eeg : 0.617637 [31mce_loss_eog : 0.453119 [31mtotal : 1.448596 [94mAcc_combined: 85.79 [94mAcc_eeg: 79.58 [94mAcc_eog: 83.09 [92mF1_combined: 74.07 [92mF1_eeg: 64.61 [92mF1_eog: 70.19 [92mK_combined: 0.8031 [92mK_eeg: 0.7133 [92mK_eog: 0.7637 [34mF1_perclass_combined: [91.65, 21.55, 85.45, 83.59, 88.11] [34mF1_perclass_eeg: [87.06, 3.55, 80.4, 82.53, 69.53] [34mF1_perclass_eog: [88.05, 13.57, 83.2, 79.11, 87.0] 
[37mEpoch 6 step 129 with [31mce_loss_combined : 0.372036 [31mce_loss_eeg : 0.615884 [31mce_loss_eog : 0.454054 [31mtotal : 1.441974 [94mAcc_combined: 86.16 [94mAcc_eeg: 79.71 [94mAcc_eog: 82.77 [92mF1_combined: 74.74 [92mF1_eeg: 64.68 [92mF1_eog: 70.16 [92mK_combined: 0.8060 [92mK_eeg: 0.7136 [92mK_eog: 0.7566 [34mF1_perclass_combined: [91.58, 24.63, 86.47, 82.93, 88.09] [34mF1_perclass_eeg: [87.0, 3.77, 81.1, 80.46, 71.08] [34mF1_perclass_eog: [88.01, 16.27, 83.27, 75.66, 87.59] 
[37mEpoch 6 step 130 with [31mce_loss_combined : 0.369875 [31mce_loss_eeg : 0.613908 [31mce_loss_eog : 0.450466 [31mtotal : 1.434250 [94mAcc_combined: 86.16 [94mAcc_eeg: 79.89 [94mAcc_eog: 83.08 [92mF1_combined: 74.50 [92mF1_eeg: 64.86 [92mF1_eog: 70.40 [92mK_combined: 0.8062 [92mK_eeg: 0.7176 [92mK_eog: 0.7616 [34mF1_perclass_combined: [91.19, 23.42, 86.63, 83.12, 88.13] [34mF1_perclass_eeg: [87.03, 3.25, 81.24, 80.39, 72.39] [34mF1_perclass_eog: [87.91, 15.51, 83.5, 77.29, 87.77] 
[37mEpoch 6 step 131 with [31mce_loss_combined : 0.369169 [31mce_loss_eeg : 0.609365 [31mce_loss_eog : 0.448020 [31mtotal : 1.426554 [94mAcc_combined: 86.24 [94mAcc_eeg: 80.10 [94mAcc_eog: 83.24 [92mF1_combined: 75.10 [92mF1_eeg: 65.34 [92mF1_eog: 71.06 [92mK_combined: 0.8080 [92mK_eeg: 0.7205 [92mK_eog: 0.7648 [34mF1_perclass_combined: [91.34, 25.58, 86.5, 83.92, 88.14] [34mF1_perclass_eeg: [87.15, 4.7, 81.28, 82.3, 71.27] [34mF1_perclass_eog: [87.96, 17.24, 83.48, 78.97, 87.65] 
[37mEpoch 6 step 135 with [31mce_loss_combined : 0.369598 [31mce_loss_eeg : 0.610587 [31mce_loss_eog : 0.445854 [31mtotal : 1.426039 [94mAcc_combined: 86.20 [94mAcc_eeg: 80.06 [94mAcc_eog: 83.32 [92mF1_combined: 75.54 [92mF1_eeg: 65.43 [92mF1_eog: 71.55 [92mK_combined: 0.8081 [92mK_eeg: 0.7205 [92mK_eog: 0.7664 [34mF1_perclass_combined: [91.37, 27.82, 86.36, 83.99, 88.15] [34mF1_perclass_eeg: [87.03, 5.34, 81.13, 82.8, 70.87] [34mF1_perclass_eog: [88.14, 19.17, 83.47, 79.23, 87.73] 
[37mEpoch 6 step 136 with [31mce_loss_combined : 0.369360 [31mce_loss_eeg : 0.610496 [31mce_loss_eog : 0.445795 [31mtotal : 1.425651 [94mAcc_combined: 86.21 [94mAcc_eeg: 80.05 [94mAcc_eog: 83.33 [92mF1_combined: 75.53 [92mF1_eeg: 65.42 [92mF1_eog: 71.53 [92mK_combined: 0.8081 [92mK_eeg: 0.7203 [92mK_eog: 0.7663 [34mF1_perclass_combined: [91.39, 27.81, 86.37, 83.94, 88.15] [34mF1_perclass_eeg: [87.03, 5.34, 81.14, 82.76, 70.85] [34mF1_perclass_eog: [88.17, 19.14, 83.49, 79.16, 87.71] 
[37mEpoch 9 step 188 with [31mce_loss_combined : 0.380524 [31mce_loss_eeg : 0.601789 [31mce_loss_eog : 0.443131 [31mtotal : 1.425445 [94mAcc_combined: 86.04 [94mAcc_eeg: 79.99 [94mAcc_eog: 83.08 [92mF1_combined: 73.81 [92mF1_eeg: 64.94 [92mF1_eog: 70.84 [92mK_combined: 0.8046 [92mK_eeg: 0.7167 [92mK_eog: 0.7620 [34mF1_perclass_combined: [91.87, 18.76, 85.71, 84.09, 88.63] [34mF1_perclass_eeg: [87.22, 3.15, 80.95, 82.68, 70.68] [34mF1_perclass_eog: [88.26, 15.75, 82.81, 79.31, 88.07] 
[37mEpoch 9 step 190 with [31mce_loss_combined : 0.362670 [31mce_loss_eeg : 0.610515 [31mce_loss_eog : 0.438573 [31mtotal : 1.411758 [94mAcc_combined: 86.55 [94mAcc_eeg: 79.89 [94mAcc_eog: 83.59 [92mF1_combined: 76.53 [92mF1_eeg: 66.80 [92mF1_eog: 71.77 [92mK_combined: 0.8146 [92mK_eeg: 0.7224 [92mK_eog: 0.7721 [34mF1_perclass_combined: [92.42, 31.39, 86.42, 84.02, 88.39] [34mF1_perclass_eeg: [86.89, 10.22, 80.16, 82.89, 73.85] [34mF1_perclass_eog: [88.61, 18.94, 83.42, 80.24, 87.65] 
[37mEpoch 9 step 191 with [31mce_loss_combined : 0.363492 [31mce_loss_eeg : 0.605478 [31mce_loss_eog : 0.442599 [31mtotal : 1.411569 [94mAcc_combined: 86.63 [94mAcc_eeg: 79.88 [94mAcc_eog: 83.02 [92mF1_combined: 76.52 [92mF1_eeg: 66.48 [92mF1_eog: 71.52 [92mK_combined: 0.8132 [92mK_eeg: 0.7195 [92mK_eog: 0.7600 [34mF1_perclass_combined: [92.33, 32.2, 86.98, 82.16, 88.94] [34mF1_perclass_eeg: [86.97, 10.05, 80.82, 81.02, 73.52] [34mF1_perclass_eog: [88.7, 22.62, 83.54, 74.44, 88.28] 
[37mEpoch 9 step 192 with [31mce_loss_combined : 0.361544 [31mce_loss_eeg : 0.595393 [31mce_loss_eog : 0.434949 [31mtotal : 1.391887 [94mAcc_combined: 86.80 [94mAcc_eeg: 80.49 [94mAcc_eog: 83.63 [92mF1_combined: 75.70 [92mF1_eeg: 66.73 [92mF1_eog: 71.52 [92mK_combined: 0.8155 [92mK_eeg: 0.7275 [92mK_eog: 0.7693 [34mF1_perclass_combined: [91.56, 26.67, 87.28, 84.12, 88.85] [34mF1_perclass_eeg: [87.0, 9.19, 81.68, 82.28, 73.5] [34mF1_perclass_eog: [88.87, 18.41, 83.84, 78.61, 87.86] 
[37mEpoch 9 step 193 with [31mce_loss_combined : 0.354508 [31mce_loss_eeg : 0.599298 [31mce_loss_eog : 0.431354 [31mtotal : 1.385160 [94mAcc_combined: 86.86 [94mAcc_eeg: 80.08 [94mAcc_eog: 83.77 [92mF1_combined: 77.24 [92mF1_eeg: 66.58 [92mF1_eog: 72.97 [92mK_combined: 0.8174 [92mK_eeg: 0.7190 [92mK_eog: 0.7726 [34mF1_perclass_combined: [92.13, 33.85, 87.07, 84.23, 88.9] [34mF1_perclass_eeg: [87.57, 11.73, 81.13, 83.17, 69.31] [34mF1_perclass_eog: [88.83, 24.77, 83.98, 79.05, 88.23] 
[37mEpoch 9 step 197 with [31mce_loss_combined : 0.351506 [31mce_loss_eeg : 0.597926 [31mce_loss_eog : 0.431270 [31mtotal : 1.380702 [94mAcc_combined: 87.04 [94mAcc_eeg: 80.17 [94mAcc_eog: 83.55 [92mF1_combined: 77.22 [92mF1_eeg: 66.30 [92mF1_eog: 71.96 [92mK_combined: 0.8197 [92mK_eeg: 0.7216 [92mK_eog: 0.7679 [34mF1_perclass_combined: [92.34, 33.23, 87.2, 84.19, 89.14] [34mF1_perclass_eeg: [86.79, 9.9, 81.48, 83.22, 70.12] [34mF1_perclass_eog: [89.12, 21.9, 83.88, 76.79, 88.12] 
[37mEpoch 9 step 199 with [31mce_loss_combined : 0.350717 [31mce_loss_eeg : 0.583795 [31mce_loss_eog : 0.427039 [31mtotal : 1.361551 [94mAcc_combined: 87.01 [94mAcc_eeg: 80.70 [94mAcc_eog: 83.94 [92mF1_combined: 77.00 [92mF1_eeg: 67.20 [92mF1_eog: 71.97 [92mK_combined: 0.8195 [92mK_eeg: 0.7310 [92mK_eog: 0.7752 [34mF1_perclass_combined: [92.23, 32.23, 87.22, 84.19, 89.15] [34mF1_perclass_eeg: [87.14, 10.61, 81.92, 82.6, 73.73] [34mF1_perclass_eog: [89.15, 18.31, 83.74, 80.24, 88.4] 
[37mEpoch 9 step 202 with [31mce_loss_combined : 0.347998 [31mce_loss_eeg : 0.577019 [31mce_loss_eog : 0.424060 [31mtotal : 1.349076 [94mAcc_combined: 87.17 [94mAcc_eeg: 80.98 [94mAcc_eog: 83.83 [92mF1_combined: 77.62 [92mF1_eeg: 67.63 [92mF1_eog: 72.33 [92mK_combined: 0.8220 [92mK_eeg: 0.7360 [92mK_eog: 0.7730 [34mF1_perclass_combined: [92.69, 34.52, 87.23, 84.32, 89.33] [34mF1_perclass_eeg: [87.72, 10.91, 81.86, 83.15, 74.5] [34mF1_perclass_eog: [89.22, 21.57, 83.93, 78.43, 88.49] 
[37mEpoch 14 step 301 with [31mce_loss_combined : 0.347573 [31mce_loss_eeg : 0.558922 [31mce_loss_eog : 0.441599 [31mtotal : 1.348094 [94mAcc_combined: 87.12 [94mAcc_eeg: 82.10 [94mAcc_eog: 83.03 [92mF1_combined: 78.61 [92mF1_eeg: 69.16 [92mF1_eog: 71.95 [92mK_combined: 0.8213 [92mK_eeg: 0.7501 [92mK_eog: 0.7616 [34mF1_perclass_combined: [92.55, 40.08, 87.45, 84.11, 88.84] [34mF1_perclass_eeg: [88.93, 14.64, 83.08, 83.29, 75.88] [34mF1_perclass_eog: [88.79, 24.63, 83.32, 74.96, 88.04] 
[37mEpoch 15 step 323 with [31mce_loss_combined : 0.353004 [31mce_loss_eeg : 0.553639 [31mce_loss_eog : 0.434163 [31mtotal : 1.340806 [94mAcc_combined: 87.12 [94mAcc_eeg: 82.20 [94mAcc_eog: 83.75 [92mF1_combined: 77.68 [92mF1_eeg: 70.25 [92mF1_eog: 71.21 [92mK_combined: 0.8212 [92mK_eeg: 0.7532 [92mK_eog: 0.7721 [34mF1_perclass_combined: [92.6, 35.39, 87.33, 84.42, 88.65] [34mF1_perclass_eeg: [88.53, 19.14, 83.14, 83.4, 77.05] [34mF1_perclass_eog: [89.19, 14.85, 83.39, 80.53, 88.11] 
[37mEpoch 15 step 324 with [31mce_loss_combined : 0.349499 [31mce_loss_eeg : 0.564893 [31mce_loss_eog : 0.418768 [31mtotal : 1.333160 [94mAcc_combined: 87.26 [94mAcc_eeg: 81.44 [94mAcc_eog: 84.13 [92mF1_combined: 79.11 [92mF1_eeg: 70.53 [92mF1_eog: 73.03 [92mK_combined: 0.8236 [92mK_eeg: 0.7447 [92mK_eog: 0.7780 [34mF1_perclass_combined: [92.69, 41.75, 87.61, 84.69, 88.82] [34mF1_perclass_eeg: [88.41, 22.96, 82.09, 83.43, 75.76] [34mF1_perclass_eog: [89.56, 22.83, 83.94, 80.39, 88.41] 
[37mEpoch 15 step 326 with [31mce_loss_combined : 0.352136 [31mce_loss_eeg : 0.558023 [31mce_loss_eog : 0.422180 [31mtotal : 1.332339 [94mAcc_combined: 87.39 [94mAcc_eeg: 82.08 [94mAcc_eog: 84.03 [92mF1_combined: 78.24 [92mF1_eeg: 69.61 [92mF1_eog: 72.51 [92mK_combined: 0.8251 [92mK_eeg: 0.7515 [92mK_eog: 0.7750 [34mF1_perclass_combined: [92.9, 36.83, 87.58, 84.5, 89.41] [34mF1_perclass_eeg: [88.5, 15.85, 82.95, 83.63, 77.11] [34mF1_perclass_eog: [89.59, 22.55, 84.21, 77.26, 88.97] 
[37mEpoch 16 step 338 with [31mce_loss_combined : 0.346096 [31mce_loss_eeg : 0.556614 [31mce_loss_eog : 0.413675 [31mtotal : 1.316386 [94mAcc_combined: 87.40 [94mAcc_eeg: 81.94 [94mAcc_eog: 84.42 [92mF1_combined: 78.80 [92mF1_eeg: 69.56 [92mF1_eog: 73.98 [92mK_combined: 0.8252 [92mK_eeg: 0.7462 [92mK_eog: 0.7829 [34mF1_perclass_combined: [92.53, 39.89, 87.75, 84.51, 89.33] [34mF1_perclass_eeg: [88.46, 17.85, 83.21, 83.2, 75.06] [34mF1_perclass_eog: [89.72, 27.03, 84.45, 80.1, 88.62] 
[37mEpoch 16 step 344 with [31mce_loss_combined : 0.347573 [31mce_loss_eeg : 0.548890 [31mce_loss_eog : 0.415466 [31mtotal : 1.311929 [94mAcc_combined: 87.29 [94mAcc_eeg: 82.34 [94mAcc_eog: 84.36 [92mF1_combined: 78.31 [92mF1_eeg: 70.37 [92mF1_eog: 72.77 [92mK_combined: 0.8241 [92mK_eeg: 0.7557 [92mK_eog: 0.7814 [34mF1_perclass_combined: [92.59, 37.78, 87.49, 84.44, 89.25] [34mF1_perclass_eeg: [88.67, 19.0, 83.17, 83.51, 77.49] [34mF1_perclass_eog: [89.76, 20.83, 84.13, 80.53, 88.58] 
[37mEpoch 16 step 345 with [31mce_loss_combined : 0.347497 [31mce_loss_eeg : 0.551670 [31mce_loss_eog : 0.412420 [31mtotal : 1.311587 [94mAcc_combined: 87.34 [94mAcc_eeg: 82.19 [94mAcc_eog: 84.42 [92mF1_combined: 78.85 [92mF1_eeg: 70.63 [92mF1_eog: 73.21 [92mK_combined: 0.8249 [92mK_eeg: 0.7538 [92mK_eog: 0.7820 [34mF1_perclass_combined: [92.71, 40.24, 87.59, 84.51, 89.18] [34mF1_perclass_eeg: [88.57, 20.8, 83.03, 83.53, 77.23] [34mF1_perclass_eog: [89.89, 23.02, 84.27, 80.24, 88.63] 
[37mEpoch 16 step 347 with [31mce_loss_combined : 0.346458 [31mce_loss_eeg : 0.547021 [31mce_loss_eog : 0.412549 [31mtotal : 1.306028 [94mAcc_combined: 87.47 [94mAcc_eeg: 82.42 [94mAcc_eog: 84.31 [92mF1_combined: 78.52 [92mF1_eeg: 70.24 [92mF1_eog: 73.03 [92mK_combined: 0.8266 [92mK_eeg: 0.7567 [92mK_eog: 0.7798 [34mF1_perclass_combined: [93.0, 38.17, 87.67, 84.37, 89.39] [34mF1_perclass_eeg: [88.83, 17.89, 83.29, 83.46, 77.72] [34mF1_perclass_eog: [90.1, 23.54, 84.35, 78.3, 88.85] 
[37mEpoch 17 step 359 with [31mce_loss_combined : 0.345144 [31mce_loss_eeg : 0.547544 [31mce_loss_eog : 0.410196 [31mtotal : 1.302884 [94mAcc_combined: 87.48 [94mAcc_eeg: 82.55 [94mAcc_eog: 84.51 [92mF1_combined: 78.73 [92mF1_eeg: 70.31 [92mF1_eog: 73.31 [92mK_combined: 0.8262 [92mK_eeg: 0.7560 [92mK_eog: 0.7840 [34mF1_perclass_combined: [92.66, 39.28, 87.83, 84.51, 89.39] [34mF1_perclass_eeg: [88.74, 18.38, 83.72, 83.18, 77.54] [34mF1_perclass_eog: [89.79, 23.17, 84.48, 80.3, 88.82] 
[37mEpoch 17 step 368 with [31mce_loss_combined : 0.343688 [31mce_loss_eeg : 0.545974 [31mce_loss_eog : 0.408252 [31mtotal : 1.297914 [94mAcc_combined: 87.48 [94mAcc_eeg: 82.63 [94mAcc_eog: 84.55 [92mF1_combined: 78.83 [92mF1_eeg: 70.53 [92mF1_eog: 73.58 [92mK_combined: 0.8267 [92mK_eeg: 0.7585 [92mK_eog: 0.7839 [34mF1_perclass_combined: [92.84, 39.56, 87.68, 84.64, 89.43] [34mF1_perclass_eeg: [88.72, 18.86, 83.67, 83.69, 77.73] [34mF1_perclass_eog: [90.05, 24.74, 84.51, 79.77, 88.83] 
[37mEpoch 17 step 369 with [31mce_loss_combined : 0.341749 [31mce_loss_eeg : 0.545726 [31mce_loss_eog : 0.407910 [31mtotal : 1.295385 [94mAcc_combined: 87.53 [94mAcc_eeg: 82.60 [94mAcc_eog: 84.51 [92mF1_combined: 78.96 [92mF1_eeg: 70.48 [92mF1_eog: 73.59 [92mK_combined: 0.8275 [92mK_eeg: 0.7585 [92mK_eog: 0.7830 [34mF1_perclass_combined: [92.92, 39.96, 87.73, 84.75, 89.42] [34mF1_perclass_eeg: [88.76, 18.57, 83.58, 83.76, 77.75] [34mF1_perclass_eog: [90.13, 25.3, 84.53, 79.06, 88.91] 
{'val_loss': {'ce_loss_combined': 0.341749, 'ce_loss_eeg': 0.54572576, 'ce_loss_eog': 0.40791023, 'total': 1.2953851}, 'val_acc': {'combined': 0.8753489753489754, 'eeg': 0.826037026037026, 'eog': 0.8450945450945451}, 'val_f1': {'combined': 0.7895504733995649, 'eeg': 0.7048279805274105, 'eog': 0.7358507909680576}, 'val_k': {'combined': 0.8274766924307172, 'eeg': 0.7584726042442591, 'eog': 0.7829871866531424}, 'val_perclassf1': {'combined': array([0.92916864, 0.39959973, 0.87725997, 0.84752541, 0.89419861]), 'eeg': array([0.88757963, 0.18568746, 0.83583924, 0.83757812, 0.77745545]), 'eog': array([0.9013498 , 0.2529565 , 0.84530188, 0.7905505 , 0.88909528])}}
We are in the final state.
 THE Configuration of your experiment ..
{'agent': 'Sleep_Agent_Init_Train',
 'augmentation': {},
 'channel': 0,
 'dataset': {'cache_datasets': {'test': False, 'train': False, 'valid': False},
             'data_roots': '/esat/biomeddata/SHHS_Dataset/no_backup',
             'data_split': {'split_method': 'patients_test',
                            'test_split_rate': 0.3,
                            'val_split_rate': 0.026},
             'data_view_dir': [{'data_type': 'stft',
                                'list_dir': 'patient_mat_list.txt',
                                'mod': 'eeg',
                                'num_ch': 1},
                               {'data_type': 'stft',
                                'list_dir': 'patient_eog_mat_list.txt',
                                'mod': 'eog',
                                'num_ch': 1}],
             'dataloader_class': 'SleepDataLoader_mat_huy',
             'filter_windows': {'test': {'perc_threshold': 0.4,
                                         'skip_skips': True,
                                         'std_threshold': 41,
                                         'use_type': 'include_only_skipped',
                                         'whole_patient': False},
                                'train': {'perc_threshold': 0.4,
                                          'skip_skips': False,
                                          'std_threshold': 41,
                                          'subsets': {'combined': 100,
                                                      'eeg': 0,
                                                      'eog': 600},
                                          'use_type': 'subsample',
                                          'whole_patient': True},
                                'val': {'skip_skips': True,
                                        'use_type': False,
                                        'whole_patient': False}},
             'huy_data': True,
             'inner_overlap': [0.5, 0.5],
             'keep_view': [1, 0],
             'seq_length': [21, 0],
             'seq_views': [False],
             'shuffle_train': True},
 'early_stopping': {'log_interval': 10,
                    'max_epoch': 1000,
                    'n_steps_stop': 100,
                    'n_steps_stop_after': 50,
                    'save_every': 1,
                    'validate_after': 0,
                    'validate_every': 50},
 'exp_name': 'Sleep EEG-EOG BLIP Experiment',
 'lr_finder': False,
 'lr_finder_steps': 100,
 'mode': 'train',
 'model': {'args': {'augment_within': False,
                    'dmodel': 128,
                    'dropout': 0.3,
                    'fc_inner': 1024,
                    'ignore_alignment_val': True,
                    'multi_loss': {'multi_loss_weights': {'alignment_loss': 0.1,
                                                          'multi_supervised_loss': {'combined': 1,
                                                                                    'eeg': 1,
                                                                                    'eog': 1},
                                                          'order_loss': 0}},
                    'num_classes': 5,
                    'three_modes': True,
                    'training_type': 'alignment_order_multisupervised'},
           'encoders': [{'args': {'align_inner': True,
                                  'd_model': 128,
                                  'dim_feedforward': 1024,
                                  'dim_proj': 128,
                                  'dropout': 0.3,
                                  'inner_biased': False,
                                  'mod_token': False,
                                  'num_heads': 8,
                                  'num_layers': 4,
                                  'outer_biased': False,
                                  'outer_rep': False,
                                  'pos': False,
                                  'rpos': True,
                                  'shared': True,
                                  'skip_random_mod': False},
                         'encoders': [],
                         'freeze_encoder': False,
                         'model': 'SleepEnc_BLIP_EEG_EOG_shared_free_cliplike',
                         'pretrainedEncoder': {'dir': '', 'use': False},
                         'savetrainedEncoder': {'dir': '', 'save': False}}],
           'load_ongoing': False,
           'model_class': 'EEG_SLEEP_BLIP_GM_MultiMode',
           'pretrained_model': {'dir': '', 'use': False},
           'save_dir': '/esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2021_data/shhs1/multi_modal/paper_models/fourier_transformer_eeg_eog_mat_BLIP_al01_shared_b16_freetrain_rpos_nopos_nonsharedpreds_drop03_align_inner_trial2_pt_incomplete_100p_0e_600o.pth.tar'},
 'normalization': {'calculate_metrics': False,
                   'dir': '/esat/biomeddata/SHHS_Dataset/no_backup/metrics_eeg_eog_emg_stft.pkl',
                   'metrics_type': 'train_dataset',
                   'save_metrics': False,
                   'use': True},
 'num_classes': 5,
 'num_modalities': 1,
 'optimizer': {'beta1': 0.9,
               'beta2': 0.999,
               'learning_rate': 0.0001,
               'momentum': 0.2,
               'type': 'Adam',
               'weight_decay': 0.0001},
 'plots': {'plot_stft_num': 0, 'save': False},
 'post_proc': {'post_proc_step': 15,
               'test_postprocessing': False,
               'val_postprocessing': False},
 'scheduler': {'max_lr': 0.03, 'type': 'cosanneal', 'warm_up': 55},
 'statistics': {'ce_weights': {'temp': 0.1, 'use': False}, 'print': False},
 'training_params': {'adversarial_training': {'adv_epsilon': 0.01,
                                              'use': False},
                     'async_loading': True,
                     'batch_size': 32,
                     'cuda': False,
                     'data_loader_workers': 8,
                     'gpu_device': [0],
                     'pin_memory': True,
                     'rec_test': False,
                     'res': True,
                     'seed': 35,
                     'tdqm_disable': True,
                     'test_batch_size': 32,
                     'test_on_tops': True,
                     'use_test_set': True,
                     'validation': True,
                     'verbose': True,
                     'wandb_disable': True}}
 *************************************** 
The experiment name is Sleep EEG-EOG BLIP Experiment
 *************************************** 
stft_eeg Train 3724 validation 100 test 1639
stft_eog Train 3724 validation 100 test 1639
{'use_type': 'subsample', 'skip_skips': False, 'whole_patient': True, 'std_threshold': 41, 'perc_threshold': 0.4, 'subsets': {'combined': 100, 'eeg': 0, 'eog': 600}}
We subsample patients with 100 both mods, 0 only EEG and 600 only EOG and len_skipped is 700.
{'use_type': False, 'skip_skips': True, 'whole_patient': False}
{'use_type': 'include_only_skipped', 'skip_skips': True, 'whole_patient': False, 'std_threshold': 41, 'perc_threshold': 0.4}
Patients with broken modalities are 14
{'use_type': False, 'skip_skips': True}
Loading metrics from /esat/biomeddata/SHHS_Dataset/no_backup/metrics_eeg_eog_emg_stft.pkl
Weights are [1. 1. 1. 1. 1.]
1030
50
21
tensor([1., 1., 1., 1., 1.], device='cuda:0')
We are not shuffling the data
Training function is sleep_train_one_step_alignment_order_multisupervised
Loss Weights are {'combined': 1, 'eeg': 1, 'eog': 1, 'alignments': 0.1, 'order': 0, 'consistency': 0, 'reconstruction': 0}
We are not shuffling the data
<class 'graphs.models.attention_models.BLIP.SleepEnc_BLIP_EEG_EOG_shared_free_cliplike'>
Total number of trainable parameters are: 7628293
Available cuda devices: 1, current device:0
Total number of trainable parameters are: 7628293
[37mEpoch 0 step 1 with [31mce_loss_combined : 1.250779 [31mce_loss_eeg : 1.342845 [31mce_loss_eog : 1.043223 [31mtotal : 3.636847 [94mAcc_combined: 55.34 [94mAcc_eeg: 49.44 [94mAcc_eog: 62.97 [92mF1_combined: 26.93 [92mF1_eeg: 23.60 [92mF1_eog: 40.45 [92mK_combined: 0.3267 [92mK_eeg: 0.2495 [92mK_eog: 0.4444 [34mF1_perclass_combined: [66.94, 0.0, 65.07, 2.65, 0.0] [34mF1_perclass_eeg: [62.17, 0.0, 55.81, 0.0, 0.0] [34mF1_perclass_eog: [73.57, 0.0, 69.58, 59.12, 0.0] 
[37mEpoch 0 step 2 with [31mce_loss_combined : 1.014637 [31mce_loss_eeg : 1.076075 [31mce_loss_eog : 0.978233 [31mtotal : 3.068944 [94mAcc_combined: 60.30 [94mAcc_eeg: 57.69 [94mAcc_eog: 64.30 [92mF1_combined: 39.89 [92mF1_eeg: 28.15 [92mF1_eog: 42.28 [92mK_combined: 0.4303 [92mK_eeg: 0.3417 [92mK_eog: 0.4744 [34mF1_perclass_combined: [78.27, 0.0, 61.55, 59.66, 0.0] [34mF1_perclass_eeg: [76.27, 0.0, 64.49, 0.0, 0.0] [34mF1_perclass_eog: [77.04, 0.0, 69.15, 65.2, 0.03] 
[37mEpoch 0 step 3 with [31mce_loss_combined : 0.938519 [31mce_loss_eeg : 1.063743 [31mce_loss_eog : 1.016167 [31mtotal : 3.018429 [94mAcc_combined: 64.40 [94mAcc_eeg: 59.48 [94mAcc_eog: 60.72 [92mF1_combined: 42.45 [92mF1_eeg: 29.07 [92mF1_eog: 36.01 [92mK_combined: 0.4724 [92mK_eeg: 0.3683 [92mK_eog: 0.4029 [34mF1_perclass_combined: [76.11, 0.0, 70.54, 59.19, 6.43] [34mF1_perclass_eeg: [78.91, 0.0, 66.43, 0.0, 0.0] [34mF1_perclass_eog: [71.25, 0.0, 70.53, 35.84, 2.44] 
[37mEpoch 0 step 4 with [31mce_loss_combined : 0.937827 [31mce_loss_eeg : 1.055372 [31mce_loss_eog : 0.903314 [31mtotal : 2.896514 [94mAcc_combined: 65.39 [94mAcc_eeg: 59.20 [94mAcc_eog: 65.97 [92mF1_combined: 43.45 [92mF1_eeg: 28.72 [92mF1_eog: 48.13 [92mK_combined: 0.4689 [92mK_eeg: 0.3694 [92mK_eog: 0.4935 [34mF1_perclass_combined: [80.36, 0.0, 70.81, 54.83, 11.25] [34mF1_perclass_eeg: [76.86, 0.0, 66.73, 0.0, 0.0] [34mF1_perclass_eog: [75.87, 0.0, 70.99, 65.72, 28.08] 
[37mEpoch 0 step 6 with [31mce_loss_combined : 0.874732 [31mce_loss_eeg : 1.040539 [31mce_loss_eog : 0.882787 [31mtotal : 2.798058 [94mAcc_combined: 66.29 [94mAcc_eeg: 59.85 [94mAcc_eog: 68.02 [92mF1_combined: 43.47 [92mF1_eeg: 29.13 [92mF1_eog: 52.36 [92mK_combined: 0.5037 [92mK_eeg: 0.3770 [92mK_eog: 0.5459 [34mF1_perclass_combined: [80.68, 0.0, 69.95, 66.65, 0.04] [34mF1_perclass_eeg: [78.49, 0.0, 67.14, 0.0, 0.0] [34mF1_perclass_eog: [77.44, 0.0, 71.21, 65.17, 47.97] 
[37mEpoch 0 step 8 with [31mce_loss_combined : 0.874282 [31mce_loss_eeg : 1.124504 [31mce_loss_eog : 0.781486 [31mtotal : 2.780272 [94mAcc_combined: 67.88 [94mAcc_eeg: 58.74 [94mAcc_eog: 70.64 [92mF1_combined: 46.56 [92mF1_eeg: 28.27 [92mF1_eog: 56.32 [92mK_combined: 0.5198 [92mK_eeg: 0.3680 [92mK_eog: 0.5939 [34mF1_perclass_combined: [78.01, 0.0, 74.71, 42.41, 37.64] [34mF1_perclass_eeg: [73.88, 0.0, 67.48, 0.0, 0.0] [34mF1_perclass_eog: [78.16, 0.0, 71.58, 68.21, 63.65] 
[37mEpoch 0 step 11 with [31mce_loss_combined : 0.901037 [31mce_loss_eeg : 0.889246 [31mce_loss_eog : 0.879475 [31mtotal : 2.669758 [94mAcc_combined: 61.41 [94mAcc_eeg: 67.56 [94mAcc_eog: 66.48 [92mF1_combined: 48.91 [92mF1_eeg: 44.91 [92mF1_eog: 52.75 [92mK_combined: 0.4628 [92mK_eeg: 0.5149 [92mK_eog: 0.5224 [34mF1_perclass_combined: [82.02, 0.0, 56.51, 59.2, 46.85] [34mF1_perclass_eeg: [82.33, 0.0, 70.55, 71.68, 0.0] [34mF1_perclass_eog: [79.36, 0.0, 65.73, 66.87, 51.81] 
[37mEpoch 0 step 12 with [31mce_loss_combined : 0.636743 [31mce_loss_eeg : 0.864748 [31mce_loss_eog : 0.719505 [31mtotal : 2.220995 [94mAcc_combined: 76.70 [94mAcc_eeg: 64.08 [94mAcc_eog: 72.84 [92mF1_combined: 61.13 [92mF1_eeg: 42.56 [92mF1_eog: 59.11 [92mK_combined: 0.6716 [92mK_eeg: 0.4907 [92mK_eog: 0.6246 [34mF1_perclass_combined: [86.13, 0.0, 78.22, 71.44, 69.83] [34mF1_perclass_eeg: [76.99, 0.0, 65.77, 69.98, 0.07] [34mF1_perclass_eog: [81.69, 0.0, 72.46, 68.53, 72.86] 
[37mEpoch 0 step 18 with [31mce_loss_combined : 0.602833 [31mce_loss_eeg : 0.864550 [31mce_loss_eog : 0.687432 [31mtotal : 2.154815 [94mAcc_combined: 77.87 [94mAcc_eeg: 67.18 [94mAcc_eog: 75.06 [92mF1_combined: 62.46 [92mF1_eeg: 52.04 [92mF1_eog: 59.88 [92mK_combined: 0.6866 [92mK_eeg: 0.5347 [92mK_eog: 0.6451 [34mF1_perclass_combined: [85.44, 0.0, 79.14, 71.79, 75.91] [34mF1_perclass_eeg: [81.09, 0.0, 70.14, 70.46, 38.51] [34mF1_perclass_eog: [79.53, 0.0, 77.8, 71.99, 70.09] 
[37mEpoch 1 step 23 with [31mce_loss_combined : 0.596301 [31mce_loss_eeg : 0.839208 [31mce_loss_eog : 0.672168 [31mtotal : 2.107678 [94mAcc_combined: 77.44 [94mAcc_eeg: 62.35 [94mAcc_eog: 74.33 [92mF1_combined: 62.64 [92mF1_eeg: 32.55 [92mF1_eog: 60.24 [92mK_combined: 0.6834 [92mK_eeg: 0.4090 [92mK_eog: 0.6345 [34mF1_perclass_combined: [86.52, 0.0, 77.2, 71.73, 77.77] [34mF1_perclass_eeg: [83.79, 0.0, 68.99, 9.98, 0.0] [34mF1_perclass_eog: [76.63, 0.0, 76.48, 71.81, 76.3] 
[37mEpoch 1 step 28 with [31mce_loss_combined : 0.570851 [31mce_loss_eeg : 0.908360 [31mce_loss_eog : 0.610273 [31mtotal : 2.089484 [94mAcc_combined: 79.13 [94mAcc_eeg: 61.83 [94mAcc_eog: 77.44 [92mF1_combined: 63.03 [92mF1_eeg: 34.47 [92mF1_eog: 62.74 [92mK_combined: 0.6972 [92mK_eeg: 0.3989 [92mK_eog: 0.6796 [34mF1_perclass_combined: [88.5, 0.0, 80.49, 69.63, 76.54] [34mF1_perclass_eeg: [83.7, 0.0, 68.36, 16.51, 3.79] [34mF1_perclass_eog: [84.09, 0.0, 78.02, 72.59, 79.02] 
[37mEpoch 1 step 32 with [31mce_loss_combined : 0.572709 [31mce_loss_eeg : 0.746873 [31mce_loss_eog : 0.623571 [31mtotal : 1.943153 [94mAcc_combined: 78.55 [94mAcc_eeg: 72.73 [94mAcc_eog: 76.94 [92mF1_combined: 63.69 [92mF1_eeg: 56.47 [92mF1_eog: 62.78 [92mK_combined: 0.6991 [92mK_eeg: 0.6090 [92mK_eog: 0.6777 [34mF1_perclass_combined: [86.32, 0.1, 78.29, 73.24, 80.48] [34mF1_perclass_eeg: [84.57, 0.0, 75.21, 73.23, 49.33] [34mF1_perclass_eog: [84.25, 0.0, 76.26, 72.21, 81.18] 
[37mEpoch 1 step 33 with [31mce_loss_combined : 0.557429 [31mce_loss_eeg : 0.763835 [31mce_loss_eog : 0.603951 [31mtotal : 1.925214 [94mAcc_combined: 79.58 [94mAcc_eeg: 71.57 [94mAcc_eog: 78.37 [92mF1_combined: 63.78 [92mF1_eeg: 55.04 [92mF1_eog: 62.99 [92mK_combined: 0.7063 [92mK_eeg: 0.5908 [92mK_eog: 0.6894 [34mF1_perclass_combined: [87.21, 0.0, 80.86, 73.01, 77.83] [34mF1_perclass_eeg: [84.86, 0.0, 74.33, 58.94, 57.08] [34mF1_perclass_eog: [83.7, 0.0, 80.18, 72.17, 78.92] 
[37mEpoch 2 step 53 with [31mce_loss_combined : 0.544113 [31mce_loss_eeg : 0.743395 [31mce_loss_eog : 0.554517 [31mtotal : 1.842024 [94mAcc_combined: 79.99 [94mAcc_eeg: 71.23 [94mAcc_eog: 79.61 [92mF1_combined: 68.21 [92mF1_eeg: 56.71 [92mF1_eog: 64.57 [92mK_combined: 0.7201 [92mK_eeg: 0.6028 [92mK_eog: 0.7108 [34mF1_perclass_combined: [89.0, 19.54, 80.69, 72.77, 79.05] [34mF1_perclass_eeg: [82.43, 1.65, 70.2, 74.29, 54.97] [34mF1_perclass_eog: [85.76, 2.65, 80.88, 71.32, 82.23] 
[37mEpoch 2 step 54 with [31mce_loss_combined : 0.513756 [31mce_loss_eeg : 0.713375 [31mce_loss_eog : 0.588971 [31mtotal : 1.816101 [94mAcc_combined: 80.63 [94mAcc_eeg: 73.79 [94mAcc_eog: 77.93 [92mF1_combined: 67.46 [92mF1_eeg: 57.76 [92mF1_eog: 63.02 [92mK_combined: 0.7267 [92mK_eeg: 0.6248 [92mK_eog: 0.6880 [34mF1_perclass_combined: [86.34, 13.03, 82.19, 73.83, 81.91] [34mF1_perclass_eeg: [83.4, 0.05, 76.37, 72.57, 56.43] [34mF1_perclass_eog: [81.2, 0.56, 79.8, 71.64, 81.89] 
[37mEpoch 2 step 57 with [31mce_loss_combined : 0.491781 [31mce_loss_eeg : 0.715102 [31mce_loss_eog : 0.557292 [31mtotal : 1.764176 [94mAcc_combined: 81.44 [94mAcc_eeg: 72.51 [94mAcc_eog: 79.14 [92mF1_combined: 71.87 [92mF1_eeg: 60.51 [92mF1_eog: 65.45 [92mK_combined: 0.7395 [92mK_eeg: 0.6270 [92mK_eog: 0.7022 [34mF1_perclass_combined: [88.69, 30.67, 82.96, 73.96, 83.1] [34mF1_perclass_eeg: [84.66, 9.78, 71.19, 77.38, 59.52] [34mF1_perclass_eog: [84.76, 11.12, 81.19, 67.78, 82.41] 
[37mEpoch 2 step 59 with [31mce_loss_combined : 0.486161 [31mce_loss_eeg : 0.694790 [31mce_loss_eog : 0.547566 [31mtotal : 1.728516 [94mAcc_combined: 81.75 [94mAcc_eeg: 74.00 [94mAcc_eog: 79.72 [92mF1_combined: 67.01 [92mF1_eeg: 58.65 [92mF1_eog: 65.03 [92mK_combined: 0.7388 [92mK_eeg: 0.6355 [92mK_eog: 0.7139 [34mF1_perclass_combined: [88.42, 5.07, 82.59, 74.74, 84.22] [34mF1_perclass_eeg: [84.05, 0.0, 74.63, 78.34, 56.25] [34mF1_perclass_eog: [86.11, 1.51, 80.11, 73.77, 83.68] 
[37mEpoch 2 step 60 with [31mce_loss_combined : 0.477360 [31mce_loss_eeg : 0.692701 [31mce_loss_eog : 0.543552 [31mtotal : 1.713613 [94mAcc_combined: 82.08 [94mAcc_eeg: 74.12 [94mAcc_eog: 79.59 [92mF1_combined: 68.55 [92mF1_eeg: 59.18 [92mF1_eog: 65.50 [92mK_combined: 0.7457 [92mK_eeg: 0.6406 [92mK_eog: 0.7134 [34mF1_perclass_combined: [88.2, 11.67, 83.16, 75.84, 83.89] [34mF1_perclass_eeg: [83.81, 0.0, 74.5, 78.37, 59.21] [34mF1_perclass_eog: [85.06, 4.53, 80.17, 74.13, 83.6] 
[37mEpoch 3 step 63 with [31mce_loss_combined : 0.471043 [31mce_loss_eeg : 0.691051 [31mce_loss_eog : 0.549239 [31mtotal : 1.711333 [94mAcc_combined: 82.65 [94mAcc_eeg: 73.75 [94mAcc_eog: 79.91 [92mF1_combined: 68.34 [92mF1_eeg: 57.36 [92mF1_eog: 64.97 [92mK_combined: 0.7527 [92mK_eeg: 0.6189 [92mK_eog: 0.7143 [34mF1_perclass_combined: [89.38, 9.11, 83.79, 75.37, 84.06] [34mF1_perclass_eeg: [83.68, 3.56, 76.88, 74.6, 48.1] [34mF1_perclass_eog: [86.45, 0.96, 80.43, 73.44, 83.57] 
[37mEpoch 3 step 64 with [31mce_loss_combined : 0.462316 [31mce_loss_eeg : 0.681646 [31mce_loss_eog : 0.530576 [31mtotal : 1.674537 [94mAcc_combined: 82.91 [94mAcc_eeg: 73.74 [94mAcc_eog: 80.23 [92mF1_combined: 73.02 [92mF1_eeg: 59.25 [92mF1_eog: 66.87 [92mK_combined: 0.7615 [92mK_eeg: 0.6274 [92mK_eog: 0.7197 [34mF1_perclass_combined: [89.32, 29.49, 83.67, 78.41, 84.18] [34mF1_perclass_eeg: [85.23, 7.93, 74.99, 77.76, 50.33] [34mF1_perclass_eog: [85.79, 11.26, 81.46, 71.83, 84.01] 
[37mEpoch 3 step 65 with [31mce_loss_combined : 0.456348 [31mce_loss_eeg : 0.678417 [31mce_loss_eog : 0.524013 [31mtotal : 1.658778 [94mAcc_combined: 83.16 [94mAcc_eeg: 74.02 [94mAcc_eog: 80.35 [92mF1_combined: 72.79 [92mF1_eeg: 59.47 [92mF1_eog: 66.86 [92mK_combined: 0.7637 [92mK_eeg: 0.6290 [92mK_eog: 0.7201 [34mF1_perclass_combined: [89.74, 27.5, 84.0, 78.2, 84.52] [34mF1_perclass_eeg: [85.2, 9.18, 75.68, 78.18, 49.09] [34mF1_perclass_eog: [86.47, 10.02, 81.29, 72.03, 84.48] 
[37mEpoch 3 step 74 with [31mce_loss_combined : 0.445747 [31mce_loss_eeg : 0.674973 [31mce_loss_eog : 0.510247 [31mtotal : 1.630967 [94mAcc_combined: 83.46 [94mAcc_eeg: 75.07 [94mAcc_eog: 80.76 [92mF1_combined: 72.44 [92mF1_eeg: 60.21 [92mF1_eog: 67.84 [92mK_combined: 0.7682 [92mK_eeg: 0.6475 [92mK_eog: 0.7293 [34mF1_perclass_combined: [89.83, 24.3, 84.11, 79.33, 84.6] [34mF1_perclass_eeg: [85.0, 3.62, 76.65, 79.38, 56.38] [34mF1_perclass_eog: [87.03, 11.59, 81.06, 74.49, 85.04] 
[37mEpoch 3 step 75 with [31mce_loss_combined : 0.444925 [31mce_loss_eeg : 0.675203 [31mce_loss_eog : 0.509264 [31mtotal : 1.629393 [94mAcc_combined: 83.52 [94mAcc_eeg: 75.13 [94mAcc_eog: 80.80 [92mF1_combined: 72.45 [92mF1_eeg: 60.20 [92mF1_eog: 67.81 [92mK_combined: 0.7687 [92mK_eeg: 0.6479 [92mK_eog: 0.7296 [34mF1_perclass_combined: [89.74, 24.23, 84.26, 79.43, 84.57] [34mF1_perclass_eeg: [84.96, 3.39, 76.85, 79.19, 56.63] [34mF1_perclass_eog: [87.0, 11.42, 81.17, 74.38, 85.05] 
[37mEpoch 4 step 92 with [31mce_loss_combined : 0.441829 [31mce_loss_eeg : 0.678287 [31mce_loss_eog : 0.507103 [31mtotal : 1.627218 [94mAcc_combined: 83.49 [94mAcc_eeg: 74.88 [94mAcc_eog: 80.83 [92mF1_combined: 71.66 [92mF1_eeg: 59.80 [92mF1_eog: 67.39 [92mK_combined: 0.7647 [92mK_eeg: 0.6431 [92mK_eog: 0.7264 [34mF1_perclass_combined: [90.25, 23.49, 84.85, 74.08, 85.6] [34mF1_perclass_eeg: [83.94, 4.8, 76.56, 79.8, 53.9] [34mF1_perclass_eog: [87.06, 12.15, 81.95, 70.62, 85.15] 
[37mEpoch 4 step 93 with [31mce_loss_combined : 0.435739 [31mce_loss_eeg : 0.666694 [31mce_loss_eog : 0.503548 [31mtotal : 1.605981 [94mAcc_combined: 83.76 [94mAcc_eeg: 75.34 [94mAcc_eog: 80.97 [92mF1_combined: 72.29 [92mF1_eeg: 60.34 [92mF1_eog: 67.85 [92mK_combined: 0.7690 [92mK_eeg: 0.6495 [92mK_eog: 0.7286 [34mF1_perclass_combined: [90.52, 24.88, 85.04, 75.48, 85.52] [34mF1_perclass_eeg: [84.58, 5.04, 77.01, 79.87, 55.22] [34mF1_perclass_eog: [87.22, 13.22, 81.98, 71.6, 85.21] 
[37mEpoch 4 step 94 with [31mce_loss_combined : 0.424815 [31mce_loss_eeg : 0.666524 [31mce_loss_eog : 0.499234 [31mtotal : 1.590574 [94mAcc_combined: 84.09 [94mAcc_eeg: 75.25 [94mAcc_eog: 81.07 [92mF1_combined: 72.98 [92mF1_eeg: 60.48 [92mF1_eog: 68.20 [92mK_combined: 0.7758 [92mK_eeg: 0.6499 [92mK_eog: 0.7322 [34mF1_perclass_combined: [90.58, 25.24, 85.03, 78.41, 85.65] [34mF1_perclass_eeg: [84.44, 5.17, 76.65, 79.81, 56.35] [34mF1_perclass_eog: [87.32, 12.85, 81.64, 73.9, 85.28] 
[37mEpoch 4 step 95 with [31mce_loss_combined : 0.424305 [31mce_loss_eeg : 0.664949 [31mce_loss_eog : 0.498980 [31mtotal : 1.588234 [94mAcc_combined: 84.11 [94mAcc_eeg: 75.32 [94mAcc_eog: 81.06 [92mF1_combined: 73.03 [92mF1_eeg: 60.63 [92mF1_eog: 68.23 [92mK_combined: 0.7762 [92mK_eeg: 0.6511 [92mK_eog: 0.7323 [34mF1_perclass_combined: [90.59, 25.34, 85.03, 78.52, 85.68] [34mF1_perclass_eeg: [84.49, 5.32, 76.72, 79.83, 56.77] [34mF1_perclass_eog: [87.33, 12.94, 81.6, 74.01, 85.27] 
[37mEpoch 5 step 115 with [31mce_loss_combined : 0.423563 [31mce_loss_eeg : 0.654411 [31mce_loss_eog : 0.501534 [31mtotal : 1.579508 [94mAcc_combined: 83.89 [94mAcc_eeg: 75.77 [94mAcc_eog: 81.00 [92mF1_combined: 73.46 [92mF1_eeg: 61.78 [92mF1_eog: 68.02 [92mK_combined: 0.7757 [92mK_eeg: 0.6621 [92mK_eog: 0.7323 [34mF1_perclass_combined: [89.83, 27.14, 84.52, 79.85, 85.94] [34mF1_perclass_eeg: [84.89, 7.09, 76.57, 79.83, 60.51] [34mF1_perclass_eog: [86.74, 11.91, 81.68, 74.75, 85.03] 
[37mEpoch 5 step 121 with [31mce_loss_combined : 0.428915 [31mce_loss_eeg : 0.632176 [31mce_loss_eog : 0.509659 [31mtotal : 1.570750 [94mAcc_combined: 83.83 [94mAcc_eeg: 76.56 [94mAcc_eog: 80.82 [92mF1_combined: 73.92 [92mF1_eeg: 62.07 [92mF1_eog: 69.17 [92mK_combined: 0.7726 [92mK_eeg: 0.6726 [92mK_eog: 0.7287 [34mF1_perclass_combined: [89.51, 30.14, 84.72, 80.41, 84.84] [34mF1_perclass_eeg: [86.28, 4.47, 77.3, 80.05, 62.23] [34mF1_perclass_eog: [87.22, 18.35, 81.29, 74.5, 84.47] 
[37mEpoch 5 step 123 with [31mce_loss_combined : 0.416863 [31mce_loss_eeg : 0.611216 [31mce_loss_eog : 0.511166 [31mtotal : 1.539245 [94mAcc_combined: 84.14 [94mAcc_eeg: 77.61 [94mAcc_eog: 80.61 [92mF1_combined: 73.06 [92mF1_eeg: 62.63 [92mF1_eog: 68.80 [92mK_combined: 0.7782 [92mK_eeg: 0.6850 [92mK_eog: 0.7285 [34mF1_perclass_combined: [89.52, 24.52, 85.03, 80.62, 85.59] [34mF1_perclass_eeg: [86.47, 3.29, 79.37, 81.36, 62.67] [34mF1_perclass_eog: [86.9, 16.99, 80.89, 73.76, 85.44] 
[37mEpoch 6 step 125 with [31mce_loss_combined : 0.416083 [31mce_loss_eeg : 0.624424 [31mce_loss_eog : 0.494601 [31mtotal : 1.535108 [94mAcc_combined: 84.21 [94mAcc_eeg: 77.04 [94mAcc_eog: 81.30 [92mF1_combined: 73.93 [92mF1_eeg: 63.30 [92mF1_eog: 69.25 [92mK_combined: 0.7773 [92mK_eeg: 0.6741 [92mK_eog: 0.7352 [34mF1_perclass_combined: [89.79, 30.33, 85.51, 78.34, 85.67] [34mF1_perclass_eeg: [85.39, 10.83, 79.47, 77.84, 62.98] [34mF1_perclass_eog: [87.65, 17.78, 81.91, 73.15, 85.78] 
[37mEpoch 6 step 126 with [31mce_loss_combined : 0.406594 [31mce_loss_eeg : 0.615935 [31mce_loss_eog : 0.491624 [31mtotal : 1.514153 [94mAcc_combined: 84.66 [94mAcc_eeg: 77.19 [94mAcc_eog: 81.22 [92mF1_combined: 75.37 [92mF1_eeg: 64.40 [92mF1_eog: 69.69 [92mK_combined: 0.7861 [92mK_eeg: 0.6793 [92mK_eog: 0.7336 [34mF1_perclass_combined: [90.34, 33.38, 85.39, 81.21, 86.5] [34mF1_perclass_eeg: [86.12, 14.82, 78.69, 80.92, 61.43] [34mF1_perclass_eog: [87.59, 20.19, 81.88, 72.9, 85.87] 
[37mEpoch 6 step 131 with [31mce_loss_combined : 0.401249 [31mce_loss_eeg : 0.616592 [31mce_loss_eog : 0.488650 [31mtotal : 1.506491 [94mAcc_combined: 84.76 [94mAcc_eeg: 77.48 [94mAcc_eog: 81.24 [92mF1_combined: 75.30 [92mF1_eeg: 63.78 [92mF1_eog: 69.79 [92mK_combined: 0.7869 [92mK_eeg: 0.6788 [92mK_eog: 0.7375 [34mF1_perclass_combined: [90.08, 33.35, 85.81, 81.01, 86.27] [34mF1_perclass_eeg: [85.62, 12.75, 79.91, 80.19, 60.45] [34mF1_perclass_eog: [87.5, 19.39, 81.49, 74.73, 85.84] 
[37mEpoch 6 step 132 with [31mce_loss_combined : 0.400332 [31mce_loss_eeg : 0.616356 [31mce_loss_eog : 0.486339 [31mtotal : 1.503027 [94mAcc_combined: 84.94 [94mAcc_eeg: 77.34 [94mAcc_eog: 81.40 [92mF1_combined: 75.01 [92mF1_eeg: 63.38 [92mF1_eog: 69.60 [92mK_combined: 0.7882 [92mK_eeg: 0.6767 [92mK_eog: 0.7379 [34mF1_perclass_combined: [90.24, 31.55, 86.11, 80.76, 86.39] [34mF1_perclass_eeg: [85.73, 11.62, 79.57, 80.64, 59.35] [34mF1_perclass_eog: [87.62, 18.33, 81.89, 74.34, 85.84] 
[37mEpoch 6 step 133 with [31mce_loss_combined : 0.399789 [31mce_loss_eeg : 0.615479 [31mce_loss_eog : 0.485126 [31mtotal : 1.500394 [94mAcc_combined: 84.88 [94mAcc_eeg: 77.40 [94mAcc_eog: 81.48 [92mF1_combined: 75.00 [92mF1_eeg: 63.45 [92mF1_eog: 69.56 [92mK_combined: 0.7872 [92mK_eeg: 0.6782 [92mK_eog: 0.7380 [34mF1_perclass_combined: [90.26, 32.04, 86.06, 80.27, 86.37] [34mF1_perclass_eeg: [85.66, 11.27, 79.55, 81.0, 59.79] [34mF1_perclass_eog: [87.65, 18.73, 82.21, 73.4, 85.82] 
[37mEpoch 6 step 134 with [31mce_loss_combined : 0.400090 [31mce_loss_eeg : 0.614353 [31mce_loss_eog : 0.485434 [31mtotal : 1.499877 [94mAcc_combined: 84.86 [94mAcc_eeg: 77.47 [94mAcc_eog: 81.46 [92mF1_combined: 74.99 [92mF1_eeg: 63.52 [92mF1_eog: 69.55 [92mK_combined: 0.7867 [92mK_eeg: 0.6790 [92mK_eog: 0.7372 [34mF1_perclass_combined: [90.33, 32.23, 86.09, 79.96, 86.37] [34mF1_perclass_eeg: [85.8, 11.29, 79.65, 80.82, 60.04] [34mF1_perclass_eog: [87.69, 19.06, 82.23, 72.96, 85.83] 
[37mEpoch 6 step 135 with [31mce_loss_combined : 0.398875 [31mce_loss_eeg : 0.614300 [31mce_loss_eog : 0.484585 [31mtotal : 1.497759 [94mAcc_combined: 84.92 [94mAcc_eeg: 77.48 [94mAcc_eog: 81.50 [92mF1_combined: 75.02 [92mF1_eeg: 63.51 [92mF1_eog: 69.52 [92mK_combined: 0.7877 [92mK_eeg: 0.6795 [92mK_eog: 0.7380 [34mF1_perclass_combined: [90.36, 31.96, 86.09, 80.32, 86.39] [34mF1_perclass_eeg: [85.77, 11.07, 79.6, 81.06, 60.05] [34mF1_perclass_eog: [87.71, 18.43, 82.22, 73.41, 85.82] 
[37mEpoch 6 step 136 with [31mce_loss_combined : 0.398630 [31mce_loss_eeg : 0.613967 [31mce_loss_eog : 0.484452 [31mtotal : 1.497048 [94mAcc_combined: 84.95 [94mAcc_eeg: 77.50 [94mAcc_eog: 81.47 [92mF1_combined: 75.05 [92mF1_eeg: 63.55 [92mF1_eog: 69.51 [92mK_combined: 0.7882 [92mK_eeg: 0.6798 [92mK_eog: 0.7378 [34mF1_perclass_combined: [90.36, 31.91, 86.12, 80.48, 86.39] [34mF1_perclass_eeg: [85.78, 11.11, 79.61, 81.09, 60.14] [34mF1_perclass_eog: [87.69, 18.44, 82.18, 73.45, 85.81] 
[37mEpoch 8 step 177 with [31mce_loss_combined : 0.400552 [31mce_loss_eeg : 0.598826 [31mce_loss_eog : 0.482190 [31mtotal : 1.481568 [94mAcc_combined: 85.18 [94mAcc_eeg: 78.32 [94mAcc_eog: 81.60 [92mF1_combined: 74.65 [92mF1_eeg: 65.04 [92mF1_eog: 68.78 [92mK_combined: 0.7925 [92mK_eeg: 0.6949 [92mK_eog: 0.7411 [34mF1_perclass_combined: [90.23, 27.9, 86.09, 82.42, 86.59] [34mF1_perclass_eeg: [85.96, 11.93, 80.11, 82.11, 65.1] [34mF1_perclass_eog: [87.88, 12.73, 81.9, 75.3, 86.08] 
[37mEpoch 8 step 183 with [31mce_loss_combined : 0.393015 [31mce_loss_eeg : 0.588158 [31mce_loss_eog : 0.495983 [31mtotal : 1.477155 [94mAcc_combined: 85.12 [94mAcc_eeg: 78.56 [94mAcc_eog: 81.44 [92mF1_combined: 76.50 [92mF1_eeg: 65.24 [92mF1_eog: 71.30 [92mK_combined: 0.7918 [92mK_eeg: 0.7002 [92mK_eog: 0.7400 [34mF1_perclass_combined: [90.35, 37.18, 86.01, 82.68, 86.29] [34mF1_perclass_eeg: [86.93, 10.61, 80.23, 82.37, 66.05] [34mF1_perclass_eog: [87.92, 25.75, 81.59, 75.31, 85.95] 
[37mEpoch 8 step 184 with [31mce_loss_combined : 0.388459 [31mce_loss_eeg : 0.583193 [31mce_loss_eog : 0.489213 [31mtotal : 1.460864 [94mAcc_combined: 85.26 [94mAcc_eeg: 78.69 [94mAcc_eog: 81.54 [92mF1_combined: 75.69 [92mF1_eeg: 65.47 [92mF1_eog: 70.73 [92mK_combined: 0.7932 [92mK_eeg: 0.6987 [92mK_eog: 0.7400 [34mF1_perclass_combined: [90.4, 32.98, 86.2, 82.08, 86.77] [34mF1_perclass_eeg: [86.45, 14.32, 80.6, 82.54, 63.43] [34mF1_perclass_eog: [88.09, 23.84, 82.08, 73.41, 86.25] 
[37mEpoch 9 step 187 with [31mce_loss_combined : 0.386276 [31mce_loss_eeg : 0.588024 [31mce_loss_eog : 0.479053 [31mtotal : 1.453353 [94mAcc_combined: 85.67 [94mAcc_eeg: 78.64 [94mAcc_eog: 81.74 [92mF1_combined: 76.23 [92mF1_eeg: 66.18 [92mF1_eog: 70.09 [92mK_combined: 0.7987 [92mK_eeg: 0.6952 [92mK_eog: 0.7413 [34mF1_perclass_combined: [91.04, 34.59, 86.66, 81.63, 87.24] [34mF1_perclass_eeg: [86.87, 18.52, 80.89, 81.19, 63.45] [34mF1_perclass_eog: [88.22, 20.93, 82.51, 72.74, 86.04] 
[37mEpoch 9 step 195 with [31mce_loss_combined : 0.382110 [31mce_loss_eeg : 0.582886 [31mce_loss_eog : 0.481742 [31mtotal : 1.446739 [94mAcc_combined: 85.73 [94mAcc_eeg: 78.94 [94mAcc_eog: 81.70 [92mF1_combined: 75.66 [92mF1_eeg: 64.69 [92mF1_eog: 69.39 [92mK_combined: 0.7994 [92mK_eeg: 0.7023 [92mK_eog: 0.7413 [34mF1_perclass_combined: [91.22, 31.17, 86.67, 81.89, 87.34] [34mF1_perclass_eeg: [86.4, 8.35, 80.71, 82.47, 65.54] [34mF1_perclass_eog: [87.81, 17.12, 82.49, 73.64, 85.9] 
[37mEpoch 9 step 196 with [31mce_loss_combined : 0.380680 [31mce_loss_eeg : 0.576205 [31mce_loss_eog : 0.474551 [31mtotal : 1.431436 [94mAcc_combined: 85.85 [94mAcc_eeg: 79.14 [94mAcc_eog: 81.88 [92mF1_combined: 75.64 [92mF1_eeg: 64.78 [92mF1_eog: 69.43 [92mK_combined: 0.8005 [92mK_eeg: 0.7046 [92mK_eog: 0.7422 [34mF1_perclass_combined: [91.16, 30.55, 86.86, 82.24, 87.36] [34mF1_perclass_eeg: [86.83, 8.04, 80.91, 82.46, 65.64] [34mF1_perclass_eog: [88.25, 16.73, 82.66, 73.26, 86.26] 
[37mEpoch 9 step 198 with [31mce_loss_combined : 0.382053 [31mce_loss_eeg : 0.570548 [31mce_loss_eog : 0.472030 [31mtotal : 1.424631 [94mAcc_combined: 85.90 [94mAcc_eeg: 79.35 [94mAcc_eog: 82.03 [92mF1_combined: 76.10 [92mF1_eeg: 65.69 [92mF1_eog: 70.20 [92mK_combined: 0.8019 [92mK_eeg: 0.7078 [92mK_eog: 0.7468 [34mF1_perclass_combined: [91.06, 32.41, 86.84, 82.81, 87.38] [34mF1_perclass_eeg: [86.95, 10.89, 81.36, 81.34, 67.93] [34mF1_perclass_eog: [88.49, 18.4, 82.37, 75.4, 86.33] 
[37mEpoch 9 step 203 with [31mce_loss_combined : 0.378523 [31mce_loss_eeg : 0.566105 [31mce_loss_eog : 0.471091 [31mtotal : 1.415719 [94mAcc_combined: 85.77 [94mAcc_eeg: 79.49 [94mAcc_eog: 81.99 [92mF1_combined: 76.45 [92mF1_eeg: 66.24 [92mF1_eog: 70.41 [92mK_combined: 0.7997 [92mK_eeg: 0.7094 [92mK_eog: 0.7445 [34mF1_perclass_combined: [90.88, 35.23, 86.98, 81.82, 87.34] [34mF1_perclass_eeg: [87.16, 13.06, 81.57, 81.41, 68.02] [34mF1_perclass_eog: [88.38, 21.96, 82.91, 72.38, 86.43] 
[37mEpoch 10 step 207 with [31mce_loss_combined : 0.376961 [31mce_loss_eeg : 0.566833 [31mce_loss_eog : 0.471701 [31mtotal : 1.415494 [94mAcc_combined: 85.80 [94mAcc_eeg: 79.31 [94mAcc_eog: 82.06 [92mF1_combined: 76.44 [92mF1_eeg: 66.50 [92mF1_eog: 70.69 [92mK_combined: 0.8005 [92mK_eeg: 0.7071 [92mK_eog: 0.7477 [34mF1_perclass_combined: [90.91, 35.08, 86.96, 81.96, 87.29] [34mF1_perclass_eeg: [86.59, 15.6, 81.61, 80.89, 67.79] [34mF1_perclass_eog: [88.56, 21.35, 82.5, 74.71, 86.35] 
[37mEpoch 10 step 208 with [31mce_loss_combined : 0.374256 [31mce_loss_eeg : 0.561933 [31mce_loss_eog : 0.468523 [31mtotal : 1.404713 [94mAcc_combined: 85.86 [94mAcc_eeg: 79.49 [94mAcc_eog: 82.10 [92mF1_combined: 76.76 [92mF1_eeg: 66.91 [92mF1_eog: 70.93 [92mK_combined: 0.8022 [92mK_eeg: 0.7106 [92mK_eog: 0.7483 [34mF1_perclass_combined: [90.89, 35.92, 86.88, 82.75, 87.39] [34mF1_perclass_eeg: [86.77, 16.32, 81.54, 81.97, 67.98] [34mF1_perclass_eog: [88.46, 22.59, 82.6, 74.6, 86.42] 
[37mEpoch 10 step 209 with [31mce_loss_combined : 0.374390 [31mce_loss_eeg : 0.562234 [31mce_loss_eog : 0.467622 [31mtotal : 1.404247 [94mAcc_combined: 85.87 [94mAcc_eeg: 79.51 [94mAcc_eog: 82.17 [92mF1_combined: 77.03 [92mF1_eeg: 67.09 [92mF1_eog: 71.23 [92mK_combined: 0.8026 [92mK_eeg: 0.7108 [92mK_eog: 0.7489 [34mF1_perclass_combined: [90.88, 36.92, 86.84, 82.98, 87.54] [34mF1_perclass_eeg: [86.75, 17.31, 81.53, 82.33, 67.52] [34mF1_perclass_eog: [88.52, 23.75, 82.68, 74.65, 86.57] 
[37mEpoch 10 step 210 with [31mce_loss_combined : 0.373810 [31mce_loss_eeg : 0.561837 [31mce_loss_eog : 0.467311 [31mtotal : 1.402958 [94mAcc_combined: 85.94 [94mAcc_eeg: 79.49 [94mAcc_eog: 82.09 [92mF1_combined: 77.09 [92mF1_eeg: 67.03 [92mF1_eog: 71.00 [92mK_combined: 0.8033 [92mK_eeg: 0.7102 [92mK_eog: 0.7468 [34mF1_perclass_combined: [90.86, 37.09, 87.0, 82.98, 87.54] [34mF1_perclass_eeg: [86.62, 17.36, 81.58, 82.37, 67.21] [34mF1_perclass_eog: [88.46, 23.89, 82.87, 73.26, 86.51] 
[37mEpoch 10 step 211 with [31mce_loss_combined : 0.374261 [31mce_loss_eeg : 0.561923 [31mce_loss_eog : 0.466767 [31mtotal : 1.402950 [94mAcc_combined: 85.93 [94mAcc_eeg: 79.49 [94mAcc_eog: 82.16 [92mF1_combined: 77.13 [92mF1_eeg: 67.05 [92mF1_eog: 71.20 [92mK_combined: 0.8031 [92mK_eeg: 0.7101 [92mK_eog: 0.7481 [34mF1_perclass_combined: [90.84, 37.28, 87.04, 82.93, 87.56] [34mF1_perclass_eeg: [86.64, 17.48, 81.63, 82.22, 67.27] [34mF1_perclass_eog: [88.46, 24.29, 82.9, 73.77, 86.59] 
[37mEpoch 14 step 299 with [31mce_loss_combined : 0.369826 [31mce_loss_eeg : 0.559578 [31mce_loss_eog : 0.462335 [31mtotal : 1.391739 [94mAcc_combined: 86.31 [94mAcc_eeg: 79.94 [94mAcc_eog: 82.44 [92mF1_combined: 76.58 [92mF1_eeg: 65.96 [92mF1_eog: 70.15 [92mK_combined: 0.8085 [92mK_eeg: 0.7160 [92mK_eog: 0.7515 [34mF1_perclass_combined: [91.51, 32.88, 87.06, 83.27, 88.17] [34mF1_perclass_eeg: [88.05, 10.02, 81.24, 83.23, 67.28] [34mF1_perclass_eog: [88.68, 17.7, 83.11, 74.26, 86.98] 
[37mEpoch 14 step 306 with [31mce_loss_combined : 0.375724 [31mce_loss_eeg : 0.541375 [31mce_loss_eog : 0.466830 [31mtotal : 1.383928 [94mAcc_combined: 86.04 [94mAcc_eeg: 80.47 [94mAcc_eog: 82.33 [92mF1_combined: 76.21 [92mF1_eeg: 67.73 [92mF1_eog: 70.92 [92mK_combined: 0.8024 [92mK_eeg: 0.7236 [92mK_eog: 0.7496 [34mF1_perclass_combined: [91.18, 32.59, 87.02, 83.08, 87.18] [34mF1_perclass_eeg: [87.55, 15.97, 82.15, 83.33, 69.67] [34mF1_perclass_eog: [89.04, 21.85, 82.91, 74.45, 86.35] 
[37mEpoch 15 step 321 with [31mce_loss_combined : 0.373272 [31mce_loss_eeg : 0.545378 [31mce_loss_eog : 0.455328 [31mtotal : 1.373978 [94mAcc_combined: 86.33 [94mAcc_eeg: 80.76 [94mAcc_eog: 82.61 [92mF1_combined: 77.57 [92mF1_eeg: 68.01 [92mF1_eog: 71.47 [92mK_combined: 0.8092 [92mK_eeg: 0.7284 [92mK_eog: 0.7552 [34mF1_perclass_combined: [91.44, 37.75, 87.26, 83.49, 87.91] [34mF1_perclass_eeg: [87.63, 15.96, 82.47, 83.12, 70.86] [34mF1_perclass_eog: [89.29, 22.87, 83.03, 75.05, 87.09] 
[37mEpoch 15 step 327 with [31mce_loss_combined : 0.369528 [31mce_loss_eeg : 0.532833 [31mce_loss_eog : 0.463427 [31mtotal : 1.365788 [94mAcc_combined: 86.31 [94mAcc_eeg: 80.78 [94mAcc_eog: 82.43 [92mF1_combined: 76.91 [92mF1_eeg: 68.15 [92mF1_eog: 71.55 [92mK_combined: 0.8068 [92mK_eeg: 0.7273 [92mK_eog: 0.7523 [34mF1_perclass_combined: [91.51, 34.59, 87.2, 83.86, 87.37] [34mF1_perclass_eeg: [88.02, 16.42, 82.36, 83.33, 70.63] [34mF1_perclass_eog: [89.0, 24.04, 82.86, 75.41, 86.45] 
[37mEpoch 16 step 333 with [31mce_loss_combined : 0.366419 [31mce_loss_eeg : 0.537937 [31mce_loss_eog : 0.459196 [31mtotal : 1.363552 [94mAcc_combined: 86.52 [94mAcc_eeg: 80.62 [94mAcc_eog: 82.50 [92mF1_combined: 77.88 [92mF1_eeg: 69.40 [92mF1_eog: 71.66 [92mK_combined: 0.8119 [92mK_eeg: 0.7277 [92mK_eog: 0.7517 [34mF1_perclass_combined: [91.48, 38.22, 87.33, 83.87, 88.51] [34mF1_perclass_eeg: [87.53, 23.45, 82.17, 83.39, 70.46] [34mF1_perclass_eog: [89.35, 26.4, 83.3, 71.9, 87.33] 
[37mEpoch 16 step 340 with [31mce_loss_combined : 0.362297 [31mce_loss_eeg : 0.535794 [31mce_loss_eog : 0.464765 [31mtotal : 1.362856 [94mAcc_combined: 86.58 [94mAcc_eeg: 80.97 [94mAcc_eog: 82.30 [92mF1_combined: 77.15 [92mF1_eeg: 67.51 [92mF1_eog: 70.63 [92mK_combined: 0.8108 [92mK_eeg: 0.7297 [92mK_eog: 0.7481 [34mF1_perclass_combined: [91.9, 34.96, 87.5, 82.95, 88.42] [34mF1_perclass_eeg: [88.02, 13.12, 82.54, 83.42, 70.46] [34mF1_perclass_eog: [89.02, 21.37, 83.11, 73.07, 86.57] 
[37mEpoch 16 step 342 with [31mce_loss_combined : 0.364457 [31mce_loss_eeg : 0.533087 [31mce_loss_eog : 0.454140 [31mtotal : 1.351684 [94mAcc_combined: 86.60 [94mAcc_eeg: 81.06 [94mAcc_eog: 82.66 [92mF1_combined: 77.26 [92mF1_eeg: 67.93 [92mF1_eog: 71.19 [92mK_combined: 0.8123 [92mK_eeg: 0.7315 [92mK_eog: 0.7561 [34mF1_perclass_combined: [91.73, 35.18, 87.47, 83.66, 88.29] [34mF1_perclass_eeg: [88.07, 14.33, 82.71, 83.01, 71.52] [34mF1_perclass_eog: [89.36, 21.09, 82.96, 75.47, 87.08] 
[37mEpoch 16 step 348 with [31mce_loss_combined : 0.361834 [31mce_loss_eeg : 0.527796 [31mce_loss_eog : 0.457502 [31mtotal : 1.347132 [94mAcc_combined: 86.60 [94mAcc_eeg: 80.95 [94mAcc_eog: 82.58 [92mF1_combined: 78.05 [92mF1_eeg: 68.49 [92mF1_eog: 72.62 [92mK_combined: 0.8122 [92mK_eeg: 0.7305 [92mK_eog: 0.7561 [34mF1_perclass_combined: [91.68, 39.15, 87.61, 83.7, 88.13] [34mF1_perclass_eeg: [87.9, 17.59, 82.72, 82.79, 71.46] [34mF1_perclass_eog: [89.15, 28.32, 82.87, 75.83, 86.92] 
[37mEpoch 17 step 352 with [31mce_loss_combined : 0.360314 [31mce_loss_eeg : 0.525478 [31mce_loss_eog : 0.455957 [31mtotal : 1.341749 [94mAcc_combined: 86.65 [94mAcc_eeg: 80.95 [94mAcc_eog: 82.62 [92mF1_combined: 77.58 [92mF1_eeg: 68.69 [92mF1_eog: 71.63 [92mK_combined: 0.8126 [92mK_eeg: 0.7300 [92mK_eog: 0.7554 [34mF1_perclass_combined: [91.78, 36.92, 87.61, 83.25, 88.35] [34mF1_perclass_eeg: [88.01, 18.89, 82.86, 81.64, 72.05] [34mF1_perclass_eog: [89.31, 23.89, 83.08, 74.78, 87.07] 
[37mEpoch 17 step 353 with [31mce_loss_combined : 0.361444 [31mce_loss_eeg : 0.526503 [31mce_loss_eog : 0.452845 [31mtotal : 1.340791 [94mAcc_combined: 86.61 [94mAcc_eeg: 81.03 [94mAcc_eog: 82.75 [92mF1_combined: 78.07 [92mF1_eeg: 69.11 [92mF1_eog: 72.39 [92mK_combined: 0.8131 [92mK_eeg: 0.7320 [92mK_eog: 0.7572 [34mF1_perclass_combined: [91.75, 38.86, 87.42, 83.84, 88.5] [34mF1_perclass_eeg: [88.05, 20.21, 82.66, 83.22, 71.41] [34mF1_perclass_eog: [89.3, 27.29, 83.22, 74.89, 87.25] 
[37mEpoch 17 step 354 with [31mce_loss_combined : 0.361574 [31mce_loss_eeg : 0.524791 [31mce_loss_eog : 0.454281 [31mtotal : 1.340646 [94mAcc_combined: 86.72 [94mAcc_eeg: 81.10 [94mAcc_eog: 82.61 [92mF1_combined: 78.22 [92mF1_eeg: 69.33 [92mF1_eog: 71.90 [92mK_combined: 0.8145 [92mK_eeg: 0.7334 [92mK_eog: 0.7538 [34mF1_perclass_combined: [91.67, 39.32, 87.61, 84.02, 88.48] [34mF1_perclass_eeg: [87.79, 21.05, 82.81, 83.39, 71.61] [34mF1_perclass_eog: [89.3, 26.86, 83.38, 72.68, 87.28] 
[37mEpoch 17 step 355 with [31mce_loss_combined : 0.362062 [31mce_loss_eeg : 0.525432 [31mce_loss_eog : 0.452322 [31mtotal : 1.339816 [94mAcc_combined: 86.68 [94mAcc_eeg: 81.10 [94mAcc_eog: 82.68 [92mF1_combined: 78.38 [92mF1_eeg: 69.44 [92mF1_eog: 72.36 [92mK_combined: 0.8141 [92mK_eeg: 0.7333 [92mK_eog: 0.7556 [34mF1_perclass_combined: [91.71, 40.27, 87.64, 83.83, 88.44] [34mF1_perclass_eeg: [87.68, 21.81, 82.94, 83.15, 71.64] [34mF1_perclass_eog: [89.34, 28.18, 83.34, 73.7, 87.26] 
[37mEpoch 17 step 359 with [31mce_loss_combined : 0.358716 [31mce_loss_eeg : 0.527609 [31mce_loss_eog : 0.451949 [31mtotal : 1.338274 [94mAcc_combined: 86.76 [94mAcc_eeg: 81.03 [94mAcc_eog: 82.78 [92mF1_combined: 77.76 [92mF1_eeg: 68.28 [92mF1_eog: 71.95 [92mK_combined: 0.8144 [92mK_eeg: 0.7301 [92mK_eog: 0.7576 [34mF1_perclass_combined: [91.83, 37.05, 87.65, 83.67, 88.6] [34mF1_perclass_eeg: [88.09, 16.81, 82.72, 83.06, 70.72] [34mF1_perclass_eog: [89.19, 25.0, 83.23, 75.05, 87.27] 
[37mEpoch 17 step 360 with [31mce_loss_combined : 0.356460 [31mce_loss_eeg : 0.527004 [31mce_loss_eog : 0.453291 [31mtotal : 1.336755 [94mAcc_combined: 86.77 [94mAcc_eeg: 81.05 [94mAcc_eog: 82.66 [92mF1_combined: 77.78 [92mF1_eeg: 68.19 [92mF1_eog: 71.64 [92mK_combined: 0.8146 [92mK_eeg: 0.7308 [92mK_eog: 0.7553 [34mF1_perclass_combined: [91.99, 37.17, 87.62, 83.55, 88.57] [34mF1_perclass_eeg: [87.98, 16.06, 82.75, 83.05, 71.08] [34mF1_perclass_eog: [89.25, 24.57, 83.3, 74.0, 87.09] 
[37mEpoch 17 step 361 with [31mce_loss_combined : 0.356713 [31mce_loss_eeg : 0.527500 [31mce_loss_eog : 0.452266 [31mtotal : 1.336479 [94mAcc_combined: 86.80 [94mAcc_eeg: 81.07 [94mAcc_eog: 82.69 [92mF1_combined: 77.81 [92mF1_eeg: 68.20 [92mF1_eog: 71.61 [92mK_combined: 0.8149 [92mK_eeg: 0.7312 [92mK_eog: 0.7555 [34mF1_perclass_combined: [92.0, 37.2, 87.62, 83.63, 88.59] [34mF1_perclass_eeg: [87.97, 15.98, 82.73, 83.29, 71.04] [34mF1_perclass_eog: [89.27, 24.14, 83.3, 74.22, 87.13] 
[37mEpoch 17 step 369 with [31mce_loss_combined : 0.358986 [31mce_loss_eeg : 0.525124 [31mce_loss_eog : 0.450267 [31mtotal : 1.334377 [94mAcc_combined: 86.76 [94mAcc_eeg: 81.06 [94mAcc_eog: 82.80 [92mF1_combined: 77.98 [92mF1_eeg: 68.64 [92mF1_eog: 72.15 [92mK_combined: 0.8143 [92mK_eeg: 0.7312 [92mK_eog: 0.7580 [34mF1_perclass_combined: [91.87, 38.41, 87.73, 83.38, 88.5] [34mF1_perclass_eeg: [87.85, 18.27, 82.9, 82.59, 71.57] [34mF1_perclass_eog: [89.34, 25.99, 83.3, 74.94, 87.17] 
[37mEpoch 17 step 370 with [31mce_loss_combined : 0.358782 [31mce_loss_eeg : 0.524305 [31mce_loss_eog : 0.450838 [31mtotal : 1.333926 [94mAcc_combined: 86.76 [94mAcc_eeg: 81.11 [94mAcc_eog: 82.79 [92mF1_combined: 78.03 [92mF1_eeg: 68.73 [92mF1_eog: 72.22 [92mK_combined: 0.8146 [92mK_eeg: 0.7322 [92mK_eog: 0.7583 [34mF1_perclass_combined: [91.86, 38.51, 87.69, 83.63, 88.47] [34mF1_perclass_eeg: [87.81, 18.37, 82.93, 82.91, 71.62] [34mF1_perclass_eog: [89.33, 26.11, 83.23, 75.23, 87.18] 
[37mEpoch 18 step 373 with [31mce_loss_combined : 0.358652 [31mce_loss_eeg : 0.523625 [31mce_loss_eog : 0.451228 [31mtotal : 1.333504 [94mAcc_combined: 86.76 [94mAcc_eeg: 81.15 [94mAcc_eog: 82.74 [92mF1_combined: 77.96 [92mF1_eeg: 68.79 [92mF1_eog: 72.06 [92mK_combined: 0.8147 [92mK_eeg: 0.7329 [92mK_eog: 0.7577 [34mF1_perclass_combined: [91.86, 38.1, 87.67, 83.71, 88.47] [34mF1_perclass_eeg: [87.89, 18.42, 82.95, 82.87, 71.84] [34mF1_perclass_eog: [89.32, 25.47, 83.15, 75.3, 87.08] 
[37mEpoch 18 step 374 with [31mce_loss_combined : 0.358567 [31mce_loss_eeg : 0.523550 [31mce_loss_eog : 0.451061 [31mtotal : 1.333177 [94mAcc_combined: 86.77 [94mAcc_eeg: 81.13 [94mAcc_eog: 82.75 [92mF1_combined: 78.01 [92mF1_eeg: 68.82 [92mF1_eog: 72.13 [92mK_combined: 0.8149 [92mK_eeg: 0.7327 [92mK_eog: 0.7578 [34mF1_perclass_combined: [91.89, 38.28, 87.66, 83.73, 88.51] [34mF1_perclass_eeg: [87.88, 18.59, 82.92, 82.94, 71.75] [34mF1_perclass_eog: [89.36, 25.75, 83.16, 75.26, 87.12] 
[37mEpoch 18 step 375 with [31mce_loss_combined : 0.358670 [31mce_loss_eeg : 0.523579 [31mce_loss_eog : 0.450552 [31mtotal : 1.332802 [94mAcc_combined: 86.77 [94mAcc_eeg: 81.14 [94mAcc_eog: 82.74 [92mF1_combined: 78.01 [92mF1_eeg: 68.84 [92mF1_eog: 72.09 [92mK_combined: 0.8148 [92mK_eeg: 0.7328 [92mK_eog: 0.7574 [34mF1_perclass_combined: [91.88, 38.26, 87.68, 83.72, 88.5] [34mF1_perclass_eeg: [87.88, 18.7, 82.94, 82.93, 71.76] [34mF1_perclass_eog: [89.35, 25.76, 83.19, 75.05, 87.11] 
{'val_loss': {'ce_loss_combined': 0.35867, 'ce_loss_eeg': 0.5235794, 'ce_loss_eog': 0.4505522, 'total': 1.3328017}, 'val_acc': {'combined': 0.867705919528123, 'eeg': 0.8113896496032582, 'eog': 0.8274198240492743}, 'val_f1': {'combined': 0.7800838849048539, 'eeg': 0.6884044868681084, 'eog': 0.7209139641578185}, 'val_k': {'combined': 0.8148390050098209, 'eeg': 0.7327905993694745, 'eog': 0.7573913528841342}, 'val_perclassf1': {'combined': array([0.91876509, 0.38262731, 0.87681694, 0.83716965, 0.88504043]), 'eeg': array([0.87877047, 0.18703045, 0.82938737, 0.82927745, 0.7175567 ]), 'eog': array([0.89345118, 0.25763952, 0.83192693, 0.7504864 , 0.87106578])}}
We are in the final state.
Job finished
