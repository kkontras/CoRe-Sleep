Starting Job
/users/sista/kkontras/Documents/Sleep_Project/main_paper_5.py
/esat/smcdata/users/kkontras/Image_Dataset/no_backup/envs/gl_env/bin/python
Python 3.7.10
/users/sista/kkontras/Documents/Sleep_Project
0
 THE Configuration of your experiment ..
{'agent': 'Sleep_Agent_Init_Train',
 'augmentation': {},
 'channel': 0,
 'dataset': {'cache_datasets': {'test': False, 'train': False, 'valid': False},
             'data_roots': '/esat/biomeddata/SHHS_Dataset/no_backup',
             'data_split': {'split_method': 'patients_test',
                            'test_split_rate': 0.3,
                            'val_split_rate': 0.026},
             'data_view_dir': [{'data_type': 'stft',
                                'list_dir': 'patient_mat_list.txt',
                                'mod': 'eeg',
                                'num_ch': 1},
                               {'data_type': 'stft',
                                'list_dir': 'patient_eog_mat_list.txt',
                                'mod': 'eog',
                                'num_ch': 1}],
             'dataloader_class': 'SleepDataLoader_mat_huy',
             'filter_windows': {'test': {'perc_threshold': 0.4,
                                         'skip_skips': True,
                                         'std_threshold': 41,
                                         'use_type': 'include_only_skipped',
                                         'whole_patient': False},
                                'train': {'perc_threshold': 0.4,
                                          'skip_skips': False,
                                          'std_threshold': 41,
                                          'subsets': {'combined': 100,
                                                      'eeg': 100,
                                                      'eog': 100},
                                          'use_type': 'subsample',
                                          'whole_patient': True},
                                'val': {'skip_skips': True,
                                        'use_type': False,
                                        'whole_patient': False}},
             'huy_data': True,
             'inner_overlap': [0.5, 0.5],
             'keep_view': [1, 0],
             'seq_length': [21, 0],
             'seq_views': [False],
             'shuffle_train': True},
 'early_stopping': {'log_interval': 10,
                    'max_epoch': 1000,
                    'n_steps_stop': 50,
                    'n_steps_stop_after': 30,
                    'save_every': 1,
                    'validate_after': 0,
                    'validate_every': 50},
 'exp_name': 'Sleep EEG-EOG BLIP Experiment',
 'lr_finder': False,
 'lr_finder_steps': 100,
 'mode': 'train',
 'model': {'args': {'augment_within': False,
                    'dmodel': 128,
                    'dropout': 0.3,
                    'fc_inner': 1024,
                    'ignore_alignment_val': True,
                    'multi_loss': {'multi_loss_weights': {'alignment_loss': 0.1,
                                                          'multi_supervised_loss': {'combined': 1,
                                                                                    'eeg': 1,
                                                                                    'eog': 1},
                                                          'order_loss': 0}},
                    'num_classes': 5,
                    'three_modes': True,
                    'training_type': 'alignment_order_multisupervised'},
           'encoders': [{'args': {'align_inner': True,
                                  'd_model': 128,
                                  'dim_feedforward': 1024,
                                  'dim_proj': 128,
                                  'dropout': 0.3,
                                  'inner_biased': False,
                                  'mod_token': False,
                                  'num_heads': 8,
                                  'num_layers': 4,
                                  'outer_biased': False,
                                  'outer_rep': False,
                                  'pos': False,
                                  'rpos': True,
                                  'shared': True,
                                  'skip_random_mod': False},
                         'encoders': [],
                         'freeze_encoder': False,
                         'model': 'SleepEnc_BLIP_EEG_EOG_shared_free_cliplike',
                         'pretrainedEncoder': {'dir': '', 'use': False},
                         'savetrainedEncoder': {'dir': '', 'save': False}}],
           'load_ongoing': False,
           'model_class': 'EEG_SLEEP_BLIP_GM_MultiMode',
           'pretrained_model': {'dir': '', 'use': False},
           'save_dir': '/esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2021_data/shhs1/multi_modal/paper_models/fourier_transformer_eeg_eog_mat_BLIP_al01_shared_b16_freetrain_rpos_nopos_nonsharedpreds_drop03_align_inner_trial2_pt_incomplete_100p_100e_100o.pth.tar'},
 'normalization': {'calculate_metrics': False,
                   'dir': '/esat/biomeddata/SHHS_Dataset/no_backup/metrics_eeg_eog_emg_stft.pkl',
                   'metrics_type': 'train_dataset',
                   'save_metrics': False,
                   'use': True},
 'num_classes': 5,
 'num_modalities': 1,
 'optimizer': {'beta1': 0.9,
               'beta2': 0.999,
               'learning_rate': 0.0001,
               'momentum': 0.2,
               'type': 'Adam',
               'weight_decay': 0.0001},
 'plots': {'plot_stft_num': 0, 'save': False},
 'post_proc': {'post_proc_step': 15,
               'test_postprocessing': False,
               'val_postprocessing': False},
 'scheduler': {'max_lr': 0.03, 'type': 'cosanneal', 'warm_up': 55},
 'statistics': {'ce_weights': {'temp': 0.1, 'use': False}, 'print': False},
 'training_params': {'adversarial_training': {'adv_epsilon': 0.01,
                                              'use': False},
                     'async_loading': True,
                     'batch_size': 32,
                     'cuda': False,
                     'data_loader_workers': 8,
                     'gpu_device': [0],
                     'pin_memory': True,
                     'rec_test': False,
                     'res': True,
                     'seed': 35,
                     'tdqm_disable': True,
                     'test_batch_size': 32,
                     'test_on_tops': True,
                     'use_test_set': True,
                     'validation': True,
                     'verbose': True,
                     'wandb_disable': True}}
 *************************************** 
The experiment name is Sleep EEG-EOG BLIP Experiment
 *************************************** 
stft_eeg Train 3724 validation 100 test 1639
stft_eog Train 3724 validation 100 test 1639
{'use_type': 'subsample', 'skip_skips': False, 'whole_patient': True, 'std_threshold': 41, 'perc_threshold': 0.4, 'subsets': {'combined': 100, 'eeg': 100, 'eog': 100}}
We subsample patients with 100 both mods, 100 only EEG and 100 only EOG and len_skipped is 294.
{'use_type': False, 'skip_skips': True, 'whole_patient': False}
{'use_type': 'include_only_skipped', 'skip_skips': True, 'whole_patient': False, 'std_threshold': 41, 'perc_threshold': 0.4}
Patients with broken modalities are 14
{'use_type': False, 'skip_skips': True}
Loading metrics from /esat/biomeddata/SHHS_Dataset/no_backup/metrics_eeg_eog_emg_stft.pkl
Weights are [1. 1. 1. 1. 1.]
433
50
9
tensor([1., 1., 1., 1., 1.], device='cuda:0')
We are not shuffling the data
Training function is sleep_train_one_step_alignment_order_multisupervised
Loss Weights are {'combined': 1, 'eeg': 1, 'eog': 1, 'alignments': 0.1, 'order': 0, 'consistency': 0, 'reconstruction': 0}
We are not shuffling the data
<class 'graphs.models.attention_models.BLIP.SleepEnc_BLIP_EEG_EOG_shared_free_cliplike'>
Total number of trainable parameters are: 7628293
Available cuda devices: 1, current device:0
Total number of trainable parameters are: 7628293
[37mEpoch 0 step 1 with [31mce_loss_combined : 0.938918 [31mce_loss_eeg : 0.910716 [31mce_loss_eog : 1.217353 [31mtotal : 3.066987 [94mAcc_combined: 60.15 [94mAcc_eeg: 65.57 [94mAcc_eog: 53.56 [92mF1_combined: 34.57 [92mF1_eeg: 42.29 [92mF1_eog: 25.71 [92mK_combined: 0.3665 [92mK_eeg: 0.4727 [92mK_eog: 0.2428 [34mF1_perclass_combined: [77.89, 0.0, 66.9, 28.07, 0.0] [34mF1_perclass_eeg: [81.74, 0.0, 69.67, 60.06, 0.0] [34mF1_perclass_eog: [64.9, 0.0, 63.65, 0.0, 0.0] 
[37mEpoch 0 step 2 with [31mce_loss_combined : 0.891205 [31mce_loss_eeg : 1.190813 [31mce_loss_eog : 0.978906 [31mtotal : 3.060925 [94mAcc_combined: 61.98 [94mAcc_eeg: 49.21 [94mAcc_eog: 64.10 [92mF1_combined: 41.63 [92mF1_eeg: 26.03 [92mF1_eog: 41.58 [92mK_combined: 0.4204 [92mK_eeg: 0.1874 [92mK_eog: 0.4571 [34mF1_perclass_combined: [75.28, 0.0, 71.53, 31.83, 29.53] [34mF1_perclass_eeg: [40.72, 0.0, 64.11, 19.79, 5.53] [34mF1_perclass_eog: [76.84, 0.0, 69.68, 61.36, 0.0] 
[37mEpoch 0 step 3 with [31mce_loss_combined : 0.892238 [31mce_loss_eeg : 0.784366 [31mce_loss_eog : 1.124105 [31mtotal : 2.800708 [94mAcc_combined: 64.81 [94mAcc_eeg: 69.05 [94mAcc_eog: 56.86 [92mF1_combined: 41.47 [92mF1_eeg: 51.99 [92mF1_eog: 29.01 [92mK_combined: 0.4559 [92mK_eeg: 0.5499 [92mK_eog: 0.3077 [34mF1_perclass_combined: [84.7, 0.0, 70.3, 41.25, 11.09] [34mF1_perclass_eeg: [84.04, 0.0, 73.42, 64.89, 37.6] [34mF1_perclass_eog: [73.45, 0.0, 65.77, 5.84, 0.0] 
[37mEpoch 0 step 4 with [31mce_loss_combined : 0.872126 [31mce_loss_eeg : 0.949830 [31mce_loss_eog : 0.953678 [31mtotal : 2.775634 [94mAcc_combined: 66.65 [94mAcc_eeg: 64.23 [94mAcc_eog: 64.57 [92mF1_combined: 49.27 [92mF1_eeg: 45.09 [92mF1_eog: 43.81 [92mK_combined: 0.5043 [92mK_eeg: 0.4858 [92mK_eog: 0.4641 [34mF1_perclass_combined: [80.34, 0.0, 69.78, 68.89, 27.34] [34mF1_perclass_eeg: [84.29, 0.0, 63.5, 69.25, 8.4] [34mF1_perclass_eog: [76.7, 0.0, 69.34, 65.64, 7.38] 
[37mEpoch 0 step 5 with [31mce_loss_combined : 0.742855 [31mce_loss_eeg : 0.785182 [31mce_loss_eog : 0.903977 [31mtotal : 2.432014 [94mAcc_combined: 73.23 [94mAcc_eeg: 69.97 [94mAcc_eog: 64.94 [92mF1_combined: 57.76 [92mF1_eeg: 54.55 [92mF1_eog: 49.24 [92mK_combined: 0.6270 [92mK_eeg: 0.5850 [92mK_eog: 0.4862 [34mF1_perclass_combined: [84.94, 0.0, 73.31, 73.18, 57.35] [34mF1_perclass_eeg: [81.06, 0.0, 70.2, 74.04, 47.47] [34mF1_perclass_eog: [74.73, 0.0, 68.76, 67.74, 34.99] 
[37mEpoch 0 step 6 with [31mce_loss_combined : 0.749578 [31mce_loss_eeg : 0.752060 [31mce_loss_eog : 0.869187 [31mtotal : 2.370825 [94mAcc_combined: 71.83 [94mAcc_eeg: 71.96 [94mAcc_eog: 66.32 [92mF1_combined: 53.94 [92mF1_eeg: 57.72 [92mF1_eog: 49.80 [92mK_combined: 0.5904 [92mK_eeg: 0.6116 [92mK_eog: 0.5084 [34mF1_perclass_combined: [81.56, 0.0, 76.15, 51.23, 60.74] [34mF1_perclass_eeg: [84.23, 0.0, 73.07, 74.61, 56.7] [34mF1_perclass_eog: [77.79, 0.0, 71.52, 56.85, 42.85] 
[37mEpoch 0 step 8 with [31mce_loss_combined : 0.681289 [31mce_loss_eeg : 0.755465 [31mce_loss_eog : 0.870761 [31mtotal : 2.307514 [94mAcc_combined: 74.89 [94mAcc_eeg: 71.44 [94mAcc_eog: 68.57 [92mF1_combined: 59.32 [92mF1_eeg: 56.65 [92mF1_eog: 52.37 [92mK_combined: 0.6484 [92mK_eeg: 0.6058 [92mK_eog: 0.5452 [34mF1_perclass_combined: [85.22, 0.0, 76.59, 71.04, 63.76] [34mF1_perclass_eeg: [81.66, 0.0, 73.8, 72.1, 55.7] [34mF1_perclass_eog: [73.72, 0.0, 74.81, 62.49, 50.85] 
[37mEpoch 1 step 9 with [31mce_loss_combined : 0.645362 [31mce_loss_eeg : 0.764129 [31mce_loss_eog : 0.778186 [31mtotal : 2.187677 [94mAcc_combined: 76.91 [94mAcc_eeg: 70.90 [94mAcc_eog: 72.14 [92mF1_combined: 61.52 [92mF1_eeg: 57.81 [92mF1_eog: 57.00 [92mK_combined: 0.6750 [92mK_eeg: 0.6080 [92mK_eog: 0.6044 [34mF1_perclass_combined: [87.32, 0.0, 78.72, 75.33, 66.24] [34mF1_perclass_eeg: [83.01, 0.0, 71.41, 77.09, 57.55] [34mF1_perclass_eog: [79.19, 0.0, 75.31, 68.22, 62.26] 
[37mEpoch 1 step 13 with [31mce_loss_combined : 0.612182 [31mce_loss_eeg : 0.715920 [31mce_loss_eog : 0.779736 [31mtotal : 2.107839 [94mAcc_combined: 77.85 [94mAcc_eeg: 73.65 [94mAcc_eog: 71.63 [92mF1_combined: 61.82 [92mF1_eeg: 56.52 [92mF1_eog: 56.48 [92mK_combined: 0.6832 [92mK_eeg: 0.6205 [92mK_eog: 0.5952 [34mF1_perclass_combined: [85.98, 0.0, 79.87, 72.5, 70.77] [34mF1_perclass_eeg: [81.22, 0.0, 77.72, 76.41, 47.24] [34mF1_perclass_eog: [77.72, 0.0, 74.51, 68.76, 61.39] 
[37mEpoch 1 step 15 with [31mce_loss_combined : 0.623367 [31mce_loss_eeg : 0.687002 [31mce_loss_eog : 0.790579 [31mtotal : 2.100948 [94mAcc_combined: 76.48 [94mAcc_eeg: 74.27 [94mAcc_eog: 69.12 [92mF1_combined: 61.60 [92mF1_eeg: 59.84 [92mF1_eog: 55.75 [92mK_combined: 0.6761 [92mK_eeg: 0.6467 [92mK_eog: 0.5785 [34mF1_perclass_combined: [83.8, 0.1, 76.69, 75.56, 71.84] [34mF1_perclass_eeg: [83.58, 0.0, 77.52, 78.92, 59.15] [34mF1_perclass_eog: [76.03, 0.0, 68.27, 67.59, 66.87] 
[37mEpoch 1 step 17 with [31mce_loss_combined : 0.582808 [31mce_loss_eeg : 0.719515 [31mce_loss_eog : 0.715098 [31mtotal : 2.017421 [94mAcc_combined: 78.82 [94mAcc_eeg: 71.84 [94mAcc_eog: 73.95 [92mF1_combined: 62.65 [92mF1_eeg: 50.44 [92mF1_eog: 59.03 [92mK_combined: 0.6987 [92mK_eeg: 0.5863 [92mK_eog: 0.6308 [34mF1_perclass_combined: [85.91, 0.0, 80.96, 76.61, 69.78] [34mF1_perclass_eeg: [84.52, 0.0, 74.59, 79.87, 13.22] [34mF1_perclass_eog: [78.78, 0.0, 76.99, 68.52, 70.86] 
[37mEpoch 2 step 22 with [31mce_loss_combined : 0.526904 [31mce_loss_eeg : 0.649355 [31mce_loss_eog : 0.714730 [31mtotal : 1.890989 [94mAcc_combined: 80.89 [94mAcc_eeg: 75.91 [94mAcc_eog: 73.48 [92mF1_combined: 65.06 [92mF1_eeg: 59.52 [92mF1_eog: 59.31 [92mK_combined: 0.7300 [92mK_eeg: 0.6539 [92mK_eog: 0.6304 [34mF1_perclass_combined: [87.63, 0.75, 83.29, 78.24, 75.4] [34mF1_perclass_eeg: [86.16, 0.15, 79.44, 68.88, 62.97] [34mF1_perclass_eog: [81.16, 0.0, 74.34, 69.39, 71.64] 
[37mEpoch 3 step 30 with [31mce_loss_combined : 0.518661 [31mce_loss_eeg : 0.631525 [31mce_loss_eog : 0.649273 [31mtotal : 1.799459 [94mAcc_combined: 81.97 [94mAcc_eeg: 77.25 [94mAcc_eog: 75.85 [92mF1_combined: 66.50 [92mF1_eeg: 61.40 [92mF1_eog: 60.86 [92mK_combined: 0.7434 [92mK_eeg: 0.6737 [92mK_eog: 0.6547 [34mF1_perclass_combined: [88.57, 1.3, 83.32, 79.57, 79.75] [34mF1_perclass_eeg: [86.29, 0.56, 79.52, 81.19, 59.41] [34mF1_perclass_eog: [82.0, 0.0, 77.46, 68.39, 76.47] 
[37mEpoch 3 step 31 with [31mce_loss_combined : 0.504042 [31mce_loss_eeg : 0.635393 [31mce_loss_eog : 0.645517 [31mtotal : 1.784953 [94mAcc_combined: 81.56 [94mAcc_eeg: 76.77 [94mAcc_eog: 76.11 [92mF1_combined: 68.38 [92mF1_eeg: 64.77 [92mF1_eog: 61.42 [92mK_combined: 0.7429 [92mK_eeg: 0.6818 [92mK_eog: 0.6598 [34mF1_perclass_combined: [87.79, 12.67, 83.14, 80.21, 78.11] [34mF1_perclass_eeg: [85.16, 14.92, 77.6, 81.1, 65.06] [34mF1_perclass_eog: [81.84, 0.0, 77.75, 70.22, 77.27] 
[37mEpoch 4 step 35 with [31mce_loss_combined : 0.502378 [31mce_loss_eeg : 0.605252 [31mce_loss_eog : 0.653301 [31mtotal : 1.760930 [94mAcc_combined: 82.05 [94mAcc_eeg: 77.66 [94mAcc_eog: 76.59 [92mF1_combined: 68.13 [92mF1_eeg: 63.67 [92mF1_eog: 61.11 [92mK_combined: 0.7446 [92mK_eeg: 0.6885 [92mK_eog: 0.6672 [34mF1_perclass_combined: [88.98, 11.67, 84.0, 76.0, 79.99] [34mF1_perclass_eeg: [85.72, 5.1, 80.17, 80.55, 66.84] [34mF1_perclass_eog: [83.52, 0.0, 78.59, 67.59, 75.84] 
[37mEpoch 4 step 39 with [31mce_loss_combined : 0.473597 [31mce_loss_eeg : 0.612681 [31mce_loss_eog : 0.651634 [31mtotal : 1.737912 [94mAcc_combined: 82.98 [94mAcc_eeg: 78.87 [94mAcc_eog: 75.43 [92mF1_combined: 68.76 [92mF1_eeg: 64.32 [92mF1_eog: 61.19 [92mK_combined: 0.7615 [92mK_eeg: 0.7008 [92mK_eog: 0.6576 [34mF1_perclass_combined: [87.99, 7.89, 84.41, 81.68, 81.8] [34mF1_perclass_eeg: [84.2, 7.51, 82.2, 79.42, 68.25] [34mF1_perclass_eog: [79.43, 0.0, 76.42, 72.35, 77.73] 
[37mEpoch 4 step 43 with [31mce_loss_combined : 0.472144 [31mce_loss_eeg : 0.574936 [31mce_loss_eog : 0.647695 [31mtotal : 1.694775 [94mAcc_combined: 83.13 [94mAcc_eeg: 79.24 [94mAcc_eog: 76.18 [92mF1_combined: 68.21 [92mF1_eeg: 64.92 [92mF1_eog: 60.82 [92mK_combined: 0.7602 [92mK_eeg: 0.7050 [92mK_eog: 0.6604 [34mF1_perclass_combined: [88.73, 5.87, 84.73, 81.79, 79.95] [34mF1_perclass_eeg: [86.1, 9.34, 81.23, 82.5, 65.44] [34mF1_perclass_eog: [80.95, 0.0, 79.09, 68.78, 75.29] 
[37mEpoch 5 step 49 with [31mce_loss_combined : 0.497786 [31mce_loss_eeg : 0.564421 [31mce_loss_eog : 0.598597 [31mtotal : 1.660803 [94mAcc_combined: 82.50 [94mAcc_eeg: 80.26 [94mAcc_eog: 78.02 [92mF1_combined: 70.10 [92mF1_eeg: 68.25 [92mF1_eog: 62.50 [92mK_combined: 0.7507 [92mK_eeg: 0.7185 [92mK_eog: 0.6862 [34mF1_perclass_combined: [87.16, 19.44, 85.18, 77.95, 80.79] [34mF1_perclass_eeg: [86.38, 21.78, 83.27, 79.61, 70.2] [34mF1_perclass_eog: [83.6, 0.3, 80.06, 69.14, 79.39] 
[37mEpoch 6 step 56 with [31mce_loss_combined : 0.453760 [31mce_loss_eeg : 0.564741 [31mce_loss_eog : 0.619868 [31mtotal : 1.638369 [94mAcc_combined: 84.22 [94mAcc_eeg: 79.68 [94mAcc_eog: 77.38 [92mF1_combined: 69.22 [92mF1_eeg: 64.60 [92mF1_eog: 61.15 [92mK_combined: 0.7750 [92mK_eeg: 0.7098 [92mK_eog: 0.6708 [34mF1_perclass_combined: [90.33, 5.04, 85.24, 81.87, 83.6] [34mF1_perclass_eeg: [87.62, 4.69, 81.55, 83.13, 65.99] [34mF1_perclass_eog: [83.88, 0.0, 79.75, 62.62, 79.51] 
[37mEpoch 6 step 57 with [31mce_loss_combined : 0.437620 [31mce_loss_eeg : 0.543028 [31mce_loss_eog : 0.599948 [31mtotal : 1.580597 [94mAcc_combined: 84.57 [94mAcc_eeg: 80.81 [94mAcc_eog: 77.98 [92mF1_combined: 72.82 [92mF1_eeg: 69.82 [92mF1_eog: 63.33 [92mK_combined: 0.7832 [92mK_eeg: 0.7342 [92mK_eog: 0.6880 [34mF1_perclass_combined: [89.97, 21.78, 86.08, 82.3, 83.95] [34mF1_perclass_eeg: [87.69, 22.88, 82.46, 83.19, 72.86] [34mF1_perclass_eog: [84.17, 1.04, 79.08, 72.29, 80.08] 
[37mEpoch 6 step 60 with [31mce_loss_combined : 0.428584 [31mce_loss_eeg : 0.546458 [31mce_loss_eog : 0.577275 [31mtotal : 1.552316 [94mAcc_combined: 84.63 [94mAcc_eeg: 80.17 [94mAcc_eog: 78.80 [92mF1_combined: 71.26 [92mF1_eeg: 66.81 [92mF1_eog: 63.40 [92mK_combined: 0.7840 [92mK_eeg: 0.7248 [92mK_eog: 0.6980 [34mF1_perclass_combined: [89.94, 13.08, 85.69, 83.5, 84.11] [34mF1_perclass_eeg: [87.56, 10.12, 82.07, 82.6, 71.72] [34mF1_perclass_eog: [84.7, 0.4, 80.39, 70.78, 80.72] 
[37mEpoch 7 step 64 with [31mce_loss_combined : 0.435097 [31mce_loss_eeg : 0.528044 [31mce_loss_eog : 0.568210 [31mtotal : 1.531351 [94mAcc_combined: 84.33 [94mAcc_eeg: 81.00 [94mAcc_eog: 78.85 [92mF1_combined: 70.01 [92mF1_eeg: 66.39 [92mF1_eog: 63.63 [92mK_combined: 0.7752 [92mK_eeg: 0.7278 [92mK_eog: 0.6961 [34mF1_perclass_combined: [90.37, 8.66, 85.46, 80.91, 84.66] [34mF1_perclass_eeg: [87.84, 6.4, 82.57, 82.08, 73.07] [34mF1_perclass_eog: [85.51, 1.05, 80.16, 69.53, 81.9] 
[37mEpoch 7 step 65 with [31mce_loss_combined : 0.413583 [31mce_loss_eeg : 0.517225 [31mce_loss_eog : 0.566293 [31mtotal : 1.497102 [94mAcc_combined: 85.02 [94mAcc_eeg: 81.66 [94mAcc_eog: 78.94 [92mF1_combined: 71.73 [92mF1_eeg: 67.58 [92mF1_eog: 63.49 [92mK_combined: 0.7873 [92mK_eeg: 0.7398 [92mK_eog: 0.6974 [34mF1_perclass_combined: [90.62, 14.38, 86.21, 82.43, 84.99] [34mF1_perclass_eeg: [88.14, 9.28, 83.18, 83.28, 74.02] [34mF1_perclass_eog: [85.31, 1.35, 80.52, 68.04, 82.26] 
[37mEpoch 8 step 73 with [31mce_loss_combined : 0.400187 [31mce_loss_eeg : 0.498792 [31mce_loss_eog : 0.560582 [31mtotal : 1.459561 [94mAcc_combined: 85.49 [94mAcc_eeg: 82.29 [94mAcc_eog: 79.09 [92mF1_combined: 73.33 [92mF1_eeg: 68.97 [92mF1_eog: 63.95 [92mK_combined: 0.7950 [92mK_eeg: 0.7504 [92mK_eog: 0.6997 [34mF1_perclass_combined: [90.84, 20.31, 86.61, 83.04, 85.84] [34mF1_perclass_eeg: [88.54, 13.21, 83.69, 83.69, 75.7] [34mF1_perclass_eog: [85.23, 3.07, 80.76, 68.14, 82.54] 
[37mEpoch 8 step 74 with [31mce_loss_combined : 0.397802 [31mce_loss_eeg : 0.494215 [31mce_loss_eog : 0.554185 [31mtotal : 1.446202 [94mAcc_combined: 85.62 [94mAcc_eeg: 82.47 [94mAcc_eog: 79.25 [92mF1_combined: 73.72 [92mF1_eeg: 69.44 [92mF1_eog: 64.19 [92mK_combined: 0.7974 [92mK_eeg: 0.7525 [92mK_eog: 0.7040 [34mF1_perclass_combined: [90.79, 21.78, 86.8, 83.35, 85.87] [34mF1_perclass_eeg: [88.54, 15.0, 84.0, 83.91, 75.72] [34mF1_perclass_eog: [85.27, 2.41, 80.61, 69.94, 82.74] 
[37mEpoch 8 step 75 with [31mce_loss_combined : 0.397710 [31mce_loss_eeg : 0.493216 [31mce_loss_eog : 0.551459 [31mtotal : 1.442385 [94mAcc_combined: 85.62 [94mAcc_eeg: 82.51 [94mAcc_eog: 79.34 [92mF1_combined: 73.83 [92mF1_eeg: 69.70 [92mF1_eog: 64.37 [92mK_combined: 0.7973 [92mK_eeg: 0.7536 [92mK_eog: 0.7056 [34mF1_perclass_combined: [90.79, 22.41, 86.85, 83.32, 85.76] [34mF1_perclass_eeg: [88.57, 16.05, 84.11, 83.68, 76.11] [34mF1_perclass_eog: [85.41, 2.46, 80.58, 70.51, 82.88] 
[37mEpoch 10 step 91 with [31mce_loss_combined : 0.387455 [31mce_loss_eeg : 0.479539 [31mce_loss_eog : 0.545807 [31mtotal : 1.412801 [94mAcc_combined: 85.92 [94mAcc_eeg: 83.00 [94mAcc_eog: 79.52 [92mF1_combined: 75.03 [92mF1_eeg: 71.01 [92mF1_eog: 65.09 [92mK_combined: 0.8016 [92mK_eeg: 0.7598 [92mK_eog: 0.7080 [34mF1_perclass_combined: [90.83, 27.4, 87.17, 83.22, 86.53] [34mF1_perclass_eeg: [88.7, 21.04, 84.65, 83.72, 76.91] [34mF1_perclass_eog: [85.64, 6.18, 80.91, 69.49, 83.22] 
[37mEpoch 10 step 92 with [31mce_loss_combined : 0.385609 [31mce_loss_eeg : 0.484078 [31mce_loss_eog : 0.535924 [31mtotal : 1.405610 [94mAcc_combined: 86.01 [94mAcc_eeg: 82.93 [94mAcc_eog: 79.79 [92mF1_combined: 75.47 [92mF1_eeg: 72.05 [92mF1_eog: 65.56 [92mK_combined: 0.8034 [92mK_eeg: 0.7613 [92mK_eog: 0.7128 [34mF1_perclass_combined: [90.99, 29.1, 87.2, 83.49, 86.55] [34mF1_perclass_eeg: [88.73, 25.86, 84.54, 83.61, 77.49] [34mF1_perclass_eog: [86.25, 5.26, 80.53, 71.92, 83.84] 
[37mEpoch 10 step 94 with [31mce_loss_combined : 0.386310 [31mce_loss_eeg : 0.481416 [31mce_loss_eog : 0.533005 [31mtotal : 1.400731 [94mAcc_combined: 85.83 [94mAcc_eeg: 82.75 [94mAcc_eog: 79.90 [92mF1_combined: 75.71 [92mF1_eeg: 71.94 [92mF1_eog: 65.82 [92mK_combined: 0.8005 [92mK_eeg: 0.7585 [92mK_eog: 0.7151 [34mF1_perclass_combined: [90.9, 31.68, 87.19, 82.31, 86.49] [34mF1_perclass_eeg: [88.85, 26.25, 84.59, 82.87, 77.11] [34mF1_perclass_eog: [86.05, 6.84, 80.89, 71.3, 84.01] 
[37mEpoch 10 step 95 with [31mce_loss_combined : 0.383703 [31mce_loss_eeg : 0.477257 [31mce_loss_eog : 0.532634 [31mtotal : 1.393594 [94mAcc_combined: 85.97 [94mAcc_eeg: 82.94 [94mAcc_eog: 79.92 [92mF1_combined: 75.87 [92mF1_eeg: 72.25 [92mF1_eog: 65.89 [92mK_combined: 0.8029 [92mK_eeg: 0.7615 [92mK_eog: 0.7158 [34mF1_perclass_combined: [90.86, 31.51, 87.28, 83.12, 86.59] [34mF1_perclass_eeg: [88.9, 26.85, 84.69, 83.51, 77.32] [34mF1_perclass_eog: [86.11, 6.79, 80.8, 71.72, 84.05] 
[37mEpoch 13 step 121 with [31mce_loss_combined : 0.382821 [31mce_loss_eeg : 0.458800 [31mce_loss_eog : 0.526851 [31mtotal : 1.368472 [94mAcc_combined: 86.08 [94mAcc_eeg: 83.55 [94mAcc_eog: 80.07 [92mF1_combined: 77.27 [92mF1_eeg: 74.20 [92mF1_eog: 68.63 [92mK_combined: 0.8052 [92mK_eeg: 0.7684 [92mK_eog: 0.7217 [34mF1_perclass_combined: [90.61, 38.12, 87.33, 83.28, 86.99] [34mF1_perclass_eeg: [88.85, 35.25, 85.4, 83.04, 78.48] [34mF1_perclass_eog: [86.93, 18.45, 80.39, 73.12, 84.29] 
[37mEpoch 14 step 125 with [31mce_loss_combined : 0.369785 [31mce_loss_eeg : 0.465285 [31mce_loss_eog : 0.530151 [31mtotal : 1.365222 [94mAcc_combined: 86.52 [94mAcc_eeg: 83.63 [94mAcc_eog: 79.90 [92mF1_combined: 77.77 [92mF1_eeg: 74.07 [92mF1_eog: 67.38 [92mK_combined: 0.8113 [92mK_eeg: 0.7715 [92mK_eog: 0.7125 [34mF1_perclass_combined: [91.52, 38.5, 87.52, 83.63, 87.67] [34mF1_perclass_eeg: [89.12, 33.26, 84.99, 84.51, 78.47] [34mF1_perclass_eog: [86.72, 17.02, 81.19, 67.61, 84.38] 
[37mEpoch 14 step 126 with [31mce_loss_combined : 0.375161 [31mce_loss_eeg : 0.460923 [31mce_loss_eog : 0.526345 [31mtotal : 1.362429 [94mAcc_combined: 86.47 [94mAcc_eeg: 83.93 [94mAcc_eog: 80.05 [92mF1_combined: 77.38 [92mF1_eeg: 74.19 [92mF1_eog: 67.14 [92mK_combined: 0.8110 [92mK_eeg: 0.7750 [92mK_eog: 0.7191 [34mF1_perclass_combined: [91.25, 36.28, 87.34, 84.36, 87.66] [34mF1_perclass_eeg: [89.14, 32.46, 85.35, 84.83, 79.18] [34mF1_perclass_eog: [86.86, 11.15, 80.37, 73.0, 84.32] 
[37mEpoch 14 step 129 with [31mce_loss_combined : 0.373025 [31mce_loss_eeg : 0.458740 [31mce_loss_eog : 0.514149 [31mtotal : 1.345914 [94mAcc_combined: 86.40 [94mAcc_eeg: 83.56 [94mAcc_eog: 80.48 [92mF1_combined: 77.42 [92mF1_eeg: 74.17 [92mF1_eog: 67.68 [92mK_combined: 0.8095 [92mK_eeg: 0.7714 [92mK_eog: 0.7236 [34mF1_perclass_combined: [91.03, 37.21, 87.58, 83.91, 87.35] [34mF1_perclass_eeg: [89.13, 33.45, 85.11, 84.43, 78.75] [34mF1_perclass_eog: [86.76, 13.71, 81.43, 71.93, 84.59] 
[37mEpoch 15 step 131 with [31mce_loss_combined : 0.373444 [31mce_loss_eeg : 0.455025 [31mce_loss_eog : 0.513169 [31mtotal : 1.341638 [94mAcc_combined: 86.33 [94mAcc_eeg: 83.68 [94mAcc_eog: 80.41 [92mF1_combined: 77.32 [92mF1_eeg: 74.52 [92mF1_eog: 67.77 [92mK_combined: 0.8092 [92mK_eeg: 0.7731 [92mK_eog: 0.7233 [34mF1_perclass_combined: [91.06, 36.81, 87.4, 84.05, 87.29] [34mF1_perclass_eeg: [89.25, 34.77, 85.02, 84.32, 79.27] [34mF1_perclass_eog: [86.97, 14.17, 81.2, 72.11, 84.42] 
[37mEpoch 15 step 132 with [31mce_loss_combined : 0.370637 [31mce_loss_eeg : 0.452528 [31mce_loss_eog : 0.514545 [31mtotal : 1.337710 [94mAcc_combined: 86.42 [94mAcc_eeg: 83.80 [94mAcc_eog: 80.30 [92mF1_combined: 77.88 [92mF1_eeg: 75.00 [92mF1_eog: 68.00 [92mK_combined: 0.8095 [92mK_eeg: 0.7737 [92mK_eog: 0.7208 [34mF1_perclass_combined: [91.12, 39.83, 87.71, 83.37, 87.39] [34mF1_perclass_eeg: [89.22, 37.18, 85.48, 83.88, 79.25] [34mF1_perclass_eog: [86.89, 15.91, 81.15, 71.44, 84.61] 
[37mEpoch 15 step 133 with [31mce_loss_combined : 0.371005 [31mce_loss_eeg : 0.452533 [31mce_loss_eog : 0.513585 [31mtotal : 1.337123 [94mAcc_combined: 86.42 [94mAcc_eeg: 83.90 [94mAcc_eog: 80.36 [92mF1_combined: 78.10 [92mF1_eeg: 75.10 [92mF1_eog: 68.16 [92mK_combined: 0.8096 [92mK_eeg: 0.7748 [92mK_eog: 0.7216 [34mF1_perclass_combined: [91.09, 41.02, 87.76, 83.18, 87.46] [34mF1_perclass_eeg: [89.35, 37.36, 85.55, 83.76, 79.49] [34mF1_perclass_eog: [86.9, 16.73, 81.28, 71.04, 84.85] 
[37mEpoch 15 step 134 with [31mce_loss_combined : 0.370176 [31mce_loss_eeg : 0.451711 [31mce_loss_eog : 0.514845 [31mtotal : 1.336732 [94mAcc_combined: 86.50 [94mAcc_eeg: 84.01 [94mAcc_eog: 80.33 [92mF1_combined: 78.02 [92mF1_eeg: 75.15 [92mF1_eog: 67.98 [92mK_combined: 0.8106 [92mK_eeg: 0.7762 [92mK_eog: 0.7205 [34mF1_perclass_combined: [91.08, 40.03, 87.8, 83.64, 87.54] [34mF1_perclass_eeg: [89.38, 37.08, 85.58, 84.19, 79.51] [34mF1_perclass_eog: [86.91, 16.33, 81.33, 70.49, 84.84] 
[37mEpoch 15 step 135 with [31mce_loss_combined : 0.370176 [31mce_loss_eeg : 0.451886 [31mce_loss_eog : 0.514174 [31mtotal : 1.336236 [94mAcc_combined: 86.50 [94mAcc_eeg: 84.04 [94mAcc_eog: 80.39 [92mF1_combined: 77.99 [92mF1_eeg: 75.19 [92mF1_eog: 68.06 [92mK_combined: 0.8108 [92mK_eeg: 0.7767 [92mK_eog: 0.7216 [34mF1_perclass_combined: [91.07, 39.84, 87.78, 83.74, 87.55] [34mF1_perclass_eeg: [89.37, 37.15, 85.59, 84.3, 79.52] [34mF1_perclass_eog: [86.95, 16.24, 81.34, 70.9, 84.86] 
{'val_loss': {'ce_loss_combined': 0.37017637, 'ce_loss_eeg': 0.45188612, 'ce_loss_eog': 0.5141738, 'total': 1.3362364}, 'val_acc': {'combined': 0.865007473391716, 'eeg': 0.8403703592243723, 'eog': 0.8039062264889103}, 'val_f1': {'combined': 0.7799336172076391, 'eeg': 0.7518594891312385, 'eog': 0.6805725900762974}, 'val_k': {'combined': 0.8107576254007213, 'eeg': 0.7766856132959761, 'eog': 0.7216434013663816}, 'val_perclassf1': {'combined': array([0.91065068, 0.39835666, 0.87775946, 0.83741945, 0.87548183]), 'eeg': array([0.89372838, 0.37147436, 0.8558597 , 0.84302648, 0.79520852]), 'eog': array([0.86948269, 0.1624223 , 0.81335261, 0.70904988, 0.84855547])}}
We are in the final state.
 THE Configuration of your experiment ..
{'agent': 'Sleep_Agent_Init_Train',
 'augmentation': {},
 'channel': 0,
 'dataset': {'cache_datasets': {'test': False, 'train': False, 'valid': False},
             'data_roots': '/esat/biomeddata/SHHS_Dataset/no_backup',
             'data_split': {'split_method': 'patients_test',
                            'test_split_rate': 0.3,
                            'val_split_rate': 0.026},
             'data_view_dir': [{'data_type': 'stft',
                                'list_dir': 'patient_mat_list.txt',
                                'mod': 'eeg',
                                'num_ch': 1},
                               {'data_type': 'stft',
                                'list_dir': 'patient_eog_mat_list.txt',
                                'mod': 'eog',
                                'num_ch': 1}],
             'dataloader_class': 'SleepDataLoader_mat_huy',
             'filter_windows': {'test': {'perc_threshold': 0.4,
                                         'skip_skips': True,
                                         'std_threshold': 41,
                                         'use_type': 'include_only_skipped',
                                         'whole_patient': False},
                                'train': {'perc_threshold': 0.4,
                                          'skip_skips': False,
                                          'std_threshold': 41,
                                          'subsets': {'combined': 100,
                                                      'eeg': 100,
                                                      'eog': 100},
                                          'use_type': 'subsample',
                                          'whole_patient': True},
                                'val': {'skip_skips': True,
                                        'use_type': False,
                                        'whole_patient': False}},
             'huy_data': True,
             'inner_overlap': [0.5, 0.5],
             'keep_view': [1, 0],
             'seq_length': [21, 0],
             'seq_views': [False],
             'shuffle_train': True},
 'early_stopping': {'log_interval': 10,
                    'max_epoch': 1000,
                    'n_steps_stop': 50,
                    'n_steps_stop_after': 30,
                    'save_every': 1,
                    'validate_after': 0,
                    'validate_every': 50},
 'exp_name': 'Sleep EEG-EOG BLIP Experiment',
 'lr_finder': False,
 'lr_finder_steps': 100,
 'mode': 'train',
 'model': {'args': {'augment_within': False,
                    'dmodel': 128,
                    'dropout': 0.3,
                    'fc_inner': 1024,
                    'ignore_alignment_val': True,
                    'multi_loss': {'multi_loss_weights': {'alignment_loss': 0.1,
                                                          'multi_supervised_loss': {'combined': 1,
                                                                                    'eeg': 1,
                                                                                    'eog': 1},
                                                          'order_loss': 0}},
                    'num_classes': 5,
                    'three_modes': True,
                    'training_type': 'alignment_order_multisupervised'},
           'encoders': [{'args': {'align_inner': True,
                                  'd_model': 128,
                                  'dim_feedforward': 1024,
                                  'dim_proj': 128,
                                  'dropout': 0.3,
                                  'inner_biased': False,
                                  'mod_token': False,
                                  'num_heads': 8,
                                  'num_layers': 4,
                                  'outer_biased': False,
                                  'outer_rep': False,
                                  'pos': False,
                                  'rpos': True,
                                  'shared': True,
                                  'skip_random_mod': False},
                         'encoders': [],
                         'freeze_encoder': False,
                         'model': 'SleepEnc_BLIP_EEG_EOG_shared_free_cliplike',
                         'pretrainedEncoder': {'dir': '', 'use': False},
                         'savetrainedEncoder': {'dir': '', 'save': False}}],
           'load_ongoing': False,
           'model_class': 'EEG_SLEEP_BLIP_GM_MultiMode',
           'pretrained_model': {'dir': '', 'use': False},
           'save_dir': '/esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2021_data/shhs1/multi_modal/paper_models/fourier_transformer_eeg_eog_mat_BLIP_al01_shared_b16_freetrain_rpos_nopos_nonsharedpreds_drop03_align_inner_trial1_pt_incomplete_100p_100e_100o.pth.tar'},
 'normalization': {'calculate_metrics': False,
                   'dir': '/esat/biomeddata/SHHS_Dataset/no_backup/metrics_eeg_eog_emg_stft.pkl',
                   'metrics_type': 'train_dataset',
                   'save_metrics': False,
                   'use': True},
 'num_classes': 5,
 'num_modalities': 1,
 'optimizer': {'beta1': 0.9,
               'beta2': 0.999,
               'learning_rate': 0.0001,
               'momentum': 0.2,
               'type': 'Adam',
               'weight_decay': 0.0001},
 'plots': {'plot_stft_num': 0, 'save': False},
 'post_proc': {'post_proc_step': 15,
               'test_postprocessing': False,
               'val_postprocessing': False},
 'scheduler': {'max_lr': 0.03, 'type': 'cosanneal', 'warm_up': 55},
 'statistics': {'ce_weights': {'temp': 0.1, 'use': False}, 'print': False},
 'training_params': {'adversarial_training': {'adv_epsilon': 0.01,
                                              'use': False},
                     'async_loading': True,
                     'batch_size': 32,
                     'cuda': False,
                     'data_loader_workers': 8,
                     'gpu_device': [0],
                     'pin_memory': True,
                     'rec_test': False,
                     'res': True,
                     'seed': 28,
                     'tdqm_disable': True,
                     'test_batch_size': 32,
                     'test_on_tops': True,
                     'use_test_set': True,
                     'validation': True,
                     'verbose': True,
                     'wandb_disable': True}}
 *************************************** 
The experiment name is Sleep EEG-EOG BLIP Experiment
 *************************************** 
stft_eeg Train 3724 validation 100 test 1639
stft_eog Train 3724 validation 100 test 1639
{'use_type': 'subsample', 'skip_skips': False, 'whole_patient': True, 'std_threshold': 41, 'perc_threshold': 0.4, 'subsets': {'combined': 100, 'eeg': 100, 'eog': 100}}
We subsample patients with 100 both mods, 100 only EEG and 100 only EOG and len_skipped is 298.
{'use_type': False, 'skip_skips': True, 'whole_patient': False}
{'use_type': 'include_only_skipped', 'skip_skips': True, 'whole_patient': False, 'std_threshold': 41, 'perc_threshold': 0.4}
Patients with broken modalities are 24
{'use_type': False, 'skip_skips': True}
Loading metrics from /esat/biomeddata/SHHS_Dataset/no_backup/metrics_eeg_eog_emg_stft.pkl
Weights are [1. 1. 1. 1. 1.]
440
50
9
tensor([1., 1., 1., 1., 1.], device='cuda:0')
We are not shuffling the data
Training function is sleep_train_one_step_alignment_order_multisupervised
Loss Weights are {'combined': 1, 'eeg': 1, 'eog': 1, 'alignments': 0.1, 'order': 0, 'consistency': 0, 'reconstruction': 0}
We are not shuffling the data
<class 'graphs.models.attention_models.BLIP.SleepEnc_BLIP_EEG_EOG_shared_free_cliplike'>
Total number of trainable parameters are: 7628293
Available cuda devices: 1, current device:0
Total number of trainable parameters are: 7628293
[37mEpoch 0 step 1 with [31mce_loss_combined : 1.102323 [31mce_loss_eeg : 1.161232 [31mce_loss_eog : 1.248317 [31mtotal : 3.511872 [94mAcc_combined: 56.41 [94mAcc_eeg: 57.21 [94mAcc_eog: 50.59 [92mF1_combined: 28.99 [92mF1_eeg: 28.18 [92mF1_eog: 24.43 [92mK_combined: 0.3271 [92mK_eeg: 0.3276 [92mK_eog: 0.2384 [34mF1_perclass_combined: [69.71, 0.0, 66.11, 0.0, 9.13] [34mF1_perclass_eeg: [74.93, 0.0, 65.97, 0.0, 0.0] [34mF1_perclass_eog: [58.87, 0.0, 61.85, 0.0, 1.41] 
[37mEpoch 0 step 2 with [31mce_loss_combined : 0.937128 [31mce_loss_eeg : 0.934516 [31mce_loss_eog : 1.054685 [31mtotal : 2.926330 [94mAcc_combined: 62.77 [94mAcc_eeg: 62.75 [94mAcc_eog: 58.86 [92mF1_combined: 51.81 [92mF1_eeg: 49.68 [92mF1_eog: 47.21 [92mK_combined: 0.5094 [92mK_eeg: 0.4924 [92mK_eog: 0.4475 [34mF1_perclass_combined: [75.98, 0.0, 63.73, 68.66, 50.69] [34mF1_perclass_eeg: [76.5, 0.0, 66.96, 52.65, 52.3] [34mF1_perclass_eog: [68.95, 0.0, 65.35, 55.5, 46.25] 
[37mEpoch 0 step 3 with [31mce_loss_combined : 0.826838 [31mce_loss_eeg : 0.848679 [31mce_loss_eog : 1.052332 [31mtotal : 2.727849 [94mAcc_combined: 68.90 [94mAcc_eeg: 68.52 [94mAcc_eog: 60.04 [92mF1_combined: 53.78 [92mF1_eeg: 52.70 [92mF1_eog: 38.43 [92mK_combined: 0.5717 [92mK_eeg: 0.5646 [92mK_eog: 0.3972 [34mF1_perclass_combined: [85.87, 0.0, 67.69, 65.13, 50.22] [34mF1_perclass_eeg: [83.86, 0.0, 67.12, 69.95, 42.58] [34mF1_perclass_eog: [73.43, 0.0, 66.1, 52.62, 0.0] 
[37mEpoch 0 step 5 with [31mce_loss_combined : 0.787767 [31mce_loss_eeg : 0.765828 [31mce_loss_eog : 0.938644 [31mtotal : 2.492239 [94mAcc_combined: 71.80 [94mAcc_eeg: 70.86 [94mAcc_eog: 64.22 [92mF1_combined: 56.53 [92mF1_eeg: 56.64 [92mF1_eog: 43.70 [92mK_combined: 0.6082 [92mK_eeg: 0.6056 [92mK_eog: 0.4810 [34mF1_perclass_combined: [79.92, 0.0, 73.32, 71.06, 58.35] [34mF1_perclass_eeg: [83.06, 0.0, 67.9, 71.78, 60.46] [34mF1_perclass_eog: [71.35, 0.0, 71.24, 65.55, 10.36] 
[37mEpoch 0 step 6 with [31mce_loss_combined : 0.737849 [31mce_loss_eeg : 0.782523 [31mce_loss_eog : 0.883516 [31mtotal : 2.403888 [94mAcc_combined: 71.33 [94mAcc_eeg: 70.41 [94mAcc_eog: 65.98 [92mF1_combined: 57.04 [92mF1_eeg: 57.25 [92mF1_eog: 47.56 [92mK_combined: 0.6089 [92mK_eeg: 0.6012 [92mK_eog: 0.4980 [34mF1_perclass_combined: [81.15, 0.0, 71.34, 76.85, 55.84] [34mF1_perclass_eeg: [83.86, 0.0, 67.25, 77.55, 57.56] [34mF1_perclass_eog: [72.69, 0.0, 72.57, 63.19, 29.35] 
[37mEpoch 0 step 8 with [31mce_loss_combined : 0.646078 [31mce_loss_eeg : 0.844311 [31mce_loss_eog : 0.825265 [31mtotal : 2.315655 [94mAcc_combined: 75.91 [94mAcc_eeg: 64.25 [94mAcc_eog: 68.66 [92mF1_combined: 61.04 [92mF1_eeg: 52.22 [92mF1_eog: 51.33 [92mK_combined: 0.6699 [92mK_eeg: 0.5387 [92mK_eog: 0.5450 [34mF1_perclass_combined: [87.27, 0.0, 74.57, 74.78, 68.58] [34mF1_perclass_eeg: [86.0, 0.0, 49.45, 62.04, 63.59] [34mF1_perclass_eog: [75.76, 0.0, 73.9, 65.39, 41.59] 
[37mEpoch 1 step 9 with [31mce_loss_combined : 0.676599 [31mce_loss_eeg : 0.728119 [31mce_loss_eog : 0.807239 [31mtotal : 2.211957 [94mAcc_combined: 74.01 [94mAcc_eeg: 71.86 [94mAcc_eog: 69.17 [92mF1_combined: 60.14 [92mF1_eeg: 57.29 [92mF1_eog: 56.11 [92mK_combined: 0.6430 [92mK_eeg: 0.6086 [92mK_eog: 0.5748 [34mF1_perclass_combined: [85.08, 0.0, 71.35, 75.16, 69.1] [34mF1_perclass_eeg: [85.67, 0.0, 69.51, 73.16, 58.13] [34mF1_perclass_eog: [74.5, 0.0, 70.06, 71.24, 64.76] 
[37mEpoch 1 step 12 with [31mce_loss_combined : 0.628874 [31mce_loss_eeg : 0.665243 [31mce_loss_eog : 0.779855 [31mtotal : 2.073972 [94mAcc_combined: 77.29 [94mAcc_eeg: 77.07 [94mAcc_eog: 72.56 [92mF1_combined: 61.15 [92mF1_eeg: 60.81 [92mF1_eog: 56.88 [92mK_combined: 0.6795 [92mK_eeg: 0.6737 [92mK_eog: 0.6088 [34mF1_perclass_combined: [84.55, 0.0, 80.13, 71.84, 69.25] [34mF1_perclass_eeg: [85.09, 0.0, 79.19, 78.41, 61.36] [34mF1_perclass_eog: [78.59, 0.0, 76.27, 68.37, 61.16] 
[37mEpoch 1 step 13 with [31mce_loss_combined : 0.568873 [31mce_loss_eeg : 0.721331 [31mce_loss_eog : 0.740261 [31mtotal : 2.030466 [94mAcc_combined: 79.32 [94mAcc_eeg: 71.61 [94mAcc_eog: 72.90 [92mF1_combined: 63.68 [92mF1_eeg: 54.95 [92mF1_eog: 57.47 [92mK_combined: 0.7118 [92mK_eeg: 0.6020 [92mK_eog: 0.6126 [34mF1_perclass_combined: [88.08, 0.0, 79.36, 78.69, 72.3] [34mF1_perclass_eeg: [85.07, 0.0, 70.66, 74.86, 44.15] [34mF1_perclass_eog: [78.43, 0.0, 76.2, 59.72, 72.99] 
[37mEpoch 1 step 14 with [31mce_loss_combined : 0.525751 [31mce_loss_eeg : 0.716234 [31mce_loss_eog : 0.736348 [31mtotal : 1.978333 [94mAcc_combined: 80.58 [94mAcc_eeg: 72.50 [94mAcc_eog: 72.29 [92mF1_combined: 65.04 [92mF1_eeg: 57.85 [92mF1_eog: 58.27 [92mK_combined: 0.7310 [92mK_eeg: 0.6170 [92mK_eog: 0.6185 [34mF1_perclass_combined: [87.41, 0.16, 81.23, 81.05, 75.37] [34mF1_perclass_eeg: [85.5, 1.7, 72.6, 65.62, 63.81] [34mF1_perclass_eog: [78.45, 0.0, 72.55, 70.89, 69.44] 
[37mEpoch 1 step 16 with [31mce_loss_combined : 0.568881 [31mce_loss_eeg : 0.694901 [31mce_loss_eog : 0.681215 [31mtotal : 1.944998 [94mAcc_combined: 79.35 [94mAcc_eeg: 74.79 [94mAcc_eog: 76.19 [92mF1_combined: 63.60 [92mF1_eeg: 58.63 [92mF1_eog: 61.56 [92mK_combined: 0.7015 [92mK_eeg: 0.6334 [92mK_eog: 0.6667 [34mF1_perclass_combined: [87.36, 0.0, 80.31, 76.15, 74.15] [34mF1_perclass_eeg: [85.03, 0.0, 77.23, 70.17, 60.71] [34mF1_perclass_eog: [80.24, 0.0, 77.88, 73.26, 76.4] 
[37mEpoch 2 step 18 with [31mce_loss_combined : 0.547295 [31mce_loss_eeg : 0.678322 [31mce_loss_eog : 0.678873 [31mtotal : 1.904490 [94mAcc_combined: 80.31 [94mAcc_eeg: 75.83 [94mAcc_eog: 75.12 [92mF1_combined: 64.71 [92mF1_eeg: 60.39 [92mF1_eog: 60.67 [92mK_combined: 0.7252 [92mK_eeg: 0.6617 [92mK_eog: 0.6531 [34mF1_perclass_combined: [85.64, 0.0, 81.75, 79.84, 76.3] [34mF1_perclass_eeg: [82.95, 0.0, 77.87, 75.08, 66.05] [34mF1_perclass_eog: [79.99, 0.0, 76.44, 72.07, 74.85] 
[37mEpoch 2 step 20 with [31mce_loss_combined : 0.531977 [31mce_loss_eeg : 0.636981 [31mce_loss_eog : 0.720380 [31mtotal : 1.889338 [94mAcc_combined: 80.56 [94mAcc_eeg: 78.66 [94mAcc_eog: 74.11 [92mF1_combined: 64.29 [92mF1_eeg: 62.85 [92mF1_eog: 58.29 [92mK_combined: 0.7233 [92mK_eeg: 0.7001 [92mK_eog: 0.6286 [34mF1_perclass_combined: [88.04, 0.05, 82.1, 73.09, 78.16] [34mF1_perclass_eeg: [86.6, 0.0, 79.92, 79.96, 67.79] [34mF1_perclass_eog: [78.59, 0.0, 77.85, 64.34, 70.66] 
[37mEpoch 2 step 22 with [31mce_loss_combined : 0.510366 [31mce_loss_eeg : 0.608056 [31mce_loss_eog : 0.656406 [31mtotal : 1.774829 [94mAcc_combined: 81.33 [94mAcc_eeg: 78.95 [94mAcc_eog: 76.74 [92mF1_combined: 64.76 [92mF1_eeg: 63.39 [92mF1_eog: 61.31 [92mK_combined: 0.7340 [92mK_eeg: 0.7041 [92mK_eog: 0.6674 [34mF1_perclass_combined: [89.79, 0.11, 82.64, 69.88, 81.37] [34mF1_perclass_eeg: [86.76, 0.11, 80.34, 77.69, 72.06] [34mF1_perclass_eog: [81.81, 0.0, 78.94, 67.92, 77.9] 
[37mEpoch 3 step 29 with [31mce_loss_combined : 0.502934 [31mce_loss_eeg : 0.620714 [31mce_loss_eog : 0.639306 [31mtotal : 1.762954 [94mAcc_combined: 81.88 [94mAcc_eeg: 79.40 [94mAcc_eog: 77.64 [92mF1_combined: 66.34 [92mF1_eeg: 64.14 [92mF1_eog: 62.96 [92mK_combined: 0.7490 [92mK_eeg: 0.7097 [92mK_eog: 0.6863 [34mF1_perclass_combined: [88.99, 0.27, 82.12, 78.37, 81.95] [34mF1_perclass_eeg: [87.09, 1.86, 80.31, 81.56, 69.87] [34mF1_perclass_eog: [82.71, 0.0, 78.3, 75.73, 78.07] 
[37mEpoch 3 step 30 with [31mce_loss_combined : 0.470459 [31mce_loss_eeg : 0.573172 [31mce_loss_eog : 0.700053 [31mtotal : 1.743684 [94mAcc_combined: 82.39 [94mAcc_eeg: 80.32 [94mAcc_eog: 74.06 [92mF1_combined: 70.44 [92mF1_eeg: 66.95 [92mF1_eog: 56.92 [92mK_combined: 0.7518 [92mK_eeg: 0.7278 [92mK_eog: 0.6287 [34mF1_perclass_combined: [88.46, 20.91, 83.87, 77.71, 81.25] [34mF1_perclass_eeg: [87.09, 10.38, 80.93, 82.33, 74.03] [34mF1_perclass_eog: [79.81, 0.0, 77.51, 49.31, 77.95] 
[37mEpoch 3 step 32 with [31mce_loss_combined : 0.442662 [31mce_loss_eeg : 0.565597 [31mce_loss_eog : 0.601913 [31mtotal : 1.610171 [94mAcc_combined: 83.51 [94mAcc_eeg: 80.15 [94mAcc_eog: 78.16 [92mF1_combined: 70.53 [92mF1_eeg: 67.17 [92mF1_eog: 62.83 [92mK_combined: 0.7707 [92mK_eeg: 0.7238 [92mK_eog: 0.6913 [34mF1_perclass_combined: [89.18, 14.49, 84.53, 82.75, 81.67] [34mF1_perclass_eeg: [86.11, 12.74, 81.73, 82.88, 72.42] [34mF1_perclass_eog: [82.07, 0.0, 80.43, 75.36, 76.3] 
[37mEpoch 4 step 37 with [31mce_loss_combined : 0.444152 [31mce_loss_eeg : 0.551036 [31mce_loss_eog : 0.610433 [31mtotal : 1.605620 [94mAcc_combined: 83.29 [94mAcc_eeg: 80.72 [94mAcc_eog: 77.04 [92mF1_combined: 70.31 [92mF1_eeg: 65.99 [92mF1_eog: 61.64 [92mK_combined: 0.7661 [92mK_eeg: 0.7289 [92mK_eog: 0.6737 [34mF1_perclass_combined: [89.38, 15.47, 84.25, 79.45, 82.98] [34mF1_perclass_eeg: [87.33, 4.87, 82.03, 79.12, 76.62] [34mF1_perclass_eog: [82.77, 0.43, 78.66, 67.72, 78.62] 
[37mEpoch 4 step 40 with [31mce_loss_combined : 0.449087 [31mce_loss_eeg : 0.560840 [31mce_loss_eog : 0.593223 [31mtotal : 1.603150 [94mAcc_combined: 83.62 [94mAcc_eeg: 80.80 [94mAcc_eog: 78.70 [92mF1_combined: 71.90 [92mF1_eeg: 68.93 [92mF1_eog: 63.52 [92mK_combined: 0.7698 [92mK_eeg: 0.7324 [92mK_eog: 0.6998 [34mF1_perclass_combined: [88.36, 22.37, 85.43, 79.99, 83.35] [34mF1_perclass_eeg: [85.9, 19.26, 82.86, 83.58, 73.03] [34mF1_perclass_eog: [82.28, 0.22, 80.59, 75.06, 79.43] 
[37mEpoch 4 step 43 with [31mce_loss_combined : 0.435967 [31mce_loss_eeg : 0.579148 [31mce_loss_eog : 0.582561 [31mtotal : 1.597677 [94mAcc_combined: 84.29 [94mAcc_eeg: 79.15 [94mAcc_eog: 78.99 [92mF1_combined: 71.22 [92mF1_eeg: 65.53 [92mF1_eog: 64.10 [92mK_combined: 0.7826 [92mK_eeg: 0.7142 [92mK_eog: 0.7057 [34mF1_perclass_combined: [89.58, 14.29, 84.83, 83.73, 83.67] [34mF1_perclass_eeg: [86.68, 7.03, 79.59, 81.87, 72.49] [34mF1_perclass_eog: [83.0, 0.49, 80.08, 75.79, 81.14] 
[37mEpoch 5 step 51 with [31mce_loss_combined : 0.420786 [31mce_loss_eeg : 0.555658 [31mce_loss_eog : 0.577034 [31mtotal : 1.553478 [94mAcc_combined: 83.93 [94mAcc_eeg: 80.79 [94mAcc_eog: 78.86 [92mF1_combined: 71.75 [92mF1_eeg: 67.38 [92mF1_eog: 63.61 [92mK_combined: 0.7781 [92mK_eeg: 0.7367 [92mK_eog: 0.7027 [34mF1_perclass_combined: [89.47, 17.78, 84.37, 82.96, 84.16] [34mF1_perclass_eeg: [86.49, 9.91, 82.34, 82.81, 75.35] [34mF1_perclass_eog: [81.69, 0.11, 81.28, 74.13, 80.86] 
[37mEpoch 5 step 52 with [31mce_loss_combined : 0.418483 [31mce_loss_eeg : 0.544495 [31mce_loss_eog : 0.585095 [31mtotal : 1.548073 [94mAcc_combined: 84.42 [94mAcc_eeg: 80.41 [94mAcc_eog: 78.96 [92mF1_combined: 71.80 [92mF1_eeg: 67.37 [92mF1_eog: 64.17 [92mK_combined: 0.7839 [92mK_eeg: 0.7301 [92mK_eog: 0.7026 [34mF1_perclass_combined: [90.71, 16.3, 84.54, 82.47, 84.99] [34mF1_perclass_eeg: [86.85, 11.54, 80.46, 80.6, 77.41] [34mF1_perclass_eog: [82.5, 1.33, 80.59, 75.42, 81.0] 
[37mEpoch 6 step 53 with [31mce_loss_combined : 0.422465 [31mce_loss_eeg : 0.534985 [31mce_loss_eog : 0.576953 [31mtotal : 1.534403 [94mAcc_combined: 83.75 [94mAcc_eeg: 80.86 [94mAcc_eog: 78.77 [92mF1_combined: 70.69 [92mF1_eeg: 67.55 [92mF1_eog: 64.06 [92mK_combined: 0.7749 [92mK_eeg: 0.7372 [92mK_eog: 0.6979 [34mF1_perclass_combined: [89.26, 12.27, 83.42, 82.51, 86.02] [34mF1_perclass_eeg: [87.73, 9.75, 80.89, 81.15, 78.25] [34mF1_perclass_eog: [82.62, 0.11, 79.5, 75.23, 82.85] 
[37mEpoch 6 step 56 with [31mce_loss_combined : 0.393723 [31mce_loss_eeg : 0.510354 [31mce_loss_eog : 0.554892 [31mtotal : 1.458969 [94mAcc_combined: 85.34 [94mAcc_eeg: 82.27 [94mAcc_eog: 80.10 [92mF1_combined: 74.81 [92mF1_eeg: 70.15 [92mF1_eog: 65.76 [92mK_combined: 0.7976 [92mK_eeg: 0.7514 [92mK_eog: 0.7228 [34mF1_perclass_combined: [90.97, 28.12, 85.84, 83.29, 85.85] [34mF1_perclass_eeg: [88.14, 19.12, 83.64, 83.05, 76.79] [34mF1_perclass_eog: [83.63, 2.6, 80.7, 78.34, 83.51] 
[37mEpoch 6 step 60 with [31mce_loss_combined : 0.386200 [31mce_loss_eeg : 0.502285 [31mce_loss_eog : 0.523539 [31mtotal : 1.412025 [94mAcc_combined: 85.65 [94mAcc_eeg: 82.75 [94mAcc_eog: 80.97 [92mF1_combined: 75.50 [92mF1_eeg: 70.95 [92mF1_eog: 66.28 [92mK_combined: 0.8020 [92mK_eeg: 0.7618 [92mK_eog: 0.7326 [34mF1_perclass_combined: [91.48, 29.31, 86.11, 83.6, 86.98] [34mF1_perclass_eeg: [88.33, 19.66, 83.82, 83.77, 79.17] [34mF1_perclass_eog: [85.61, 2.92, 81.67, 77.36, 83.84] 
[37mEpoch 8 step 72 with [31mce_loss_combined : 0.376534 [31mce_loss_eeg : 0.473463 [31mce_loss_eog : 0.538350 [31mtotal : 1.388347 [94mAcc_combined: 85.91 [94mAcc_eeg: 83.31 [94mAcc_eog: 80.38 [92mF1_combined: 75.38 [92mF1_eeg: 72.54 [92mF1_eog: 65.77 [92mK_combined: 0.8041 [92mK_eeg: 0.7680 [92mK_eog: 0.7251 [34mF1_perclass_combined: [90.85, 29.05, 86.49, 83.29, 87.2] [34mF1_perclass_eeg: [88.6, 26.18, 84.44, 83.22, 80.25] [34mF1_perclass_eog: [84.76, 3.56, 81.45, 76.28, 82.81] 
[37mEpoch 8 step 74 with [31mce_loss_combined : 0.376806 [31mce_loss_eeg : 0.479261 [31mce_loss_eog : 0.517640 [31mtotal : 1.373707 [94mAcc_combined: 85.83 [94mAcc_eeg: 82.96 [94mAcc_eog: 81.03 [92mF1_combined: 75.94 [92mF1_eeg: 72.23 [92mF1_eog: 66.97 [92mK_combined: 0.8038 [92mK_eeg: 0.7626 [92mK_eog: 0.7338 [34mF1_perclass_combined: [91.73, 31.95, 85.99, 83.04, 86.97] [34mF1_perclass_eeg: [88.6, 25.99, 83.76, 83.85, 78.94] [34mF1_perclass_eog: [85.18, 5.97, 81.85, 77.74, 84.11] 
[37mEpoch 8 step 75 with [31mce_loss_combined : 0.371359 [31mce_loss_eeg : 0.470636 [31mce_loss_eog : 0.519217 [31mtotal : 1.361212 [94mAcc_combined: 86.03 [94mAcc_eeg: 83.41 [94mAcc_eog: 80.78 [92mF1_combined: 76.05 [92mF1_eeg: 72.60 [92mF1_eog: 66.50 [92mK_combined: 0.8064 [92mK_eeg: 0.7692 [92mK_eog: 0.7291 [34mF1_perclass_combined: [91.51, 31.9, 86.46, 83.35, 87.04] [34mF1_perclass_eeg: [88.82, 25.96, 84.3, 83.98, 79.95] [34mF1_perclass_eog: [84.96, 5.73, 81.93, 75.77, 84.12] 
[37mEpoch 9 step 87 with [31mce_loss_combined : 0.363212 [31mce_loss_eeg : 0.473629 [31mce_loss_eog : 0.498825 [31mtotal : 1.335667 [94mAcc_combined: 86.55 [94mAcc_eeg: 83.34 [94mAcc_eog: 81.59 [92mF1_combined: 76.79 [92mF1_eeg: 73.22 [92mF1_eog: 67.53 [92mK_combined: 0.8140 [92mK_eeg: 0.7700 [92mK_eog: 0.7438 [34mF1_perclass_combined: [91.65, 33.19, 87.08, 84.37, 87.64] [34mF1_perclass_eeg: [88.3, 29.12, 84.44, 83.97, 80.26] [34mF1_perclass_eog: [85.86, 5.7, 81.79, 78.51, 85.82] 
[37mEpoch 10 step 91 with [31mce_loss_combined : 0.367353 [31mce_loss_eeg : 0.463172 [31mce_loss_eog : 0.504626 [31mtotal : 1.335152 [94mAcc_combined: 86.24 [94mAcc_eeg: 83.33 [94mAcc_eog: 81.47 [92mF1_combined: 77.04 [92mF1_eeg: 73.78 [92mF1_eog: 68.12 [92mK_combined: 0.8100 [92mK_eeg: 0.7693 [92mK_eog: 0.7411 [34mF1_perclass_combined: [92.23, 35.78, 86.24, 83.23, 87.71] [34mF1_perclass_eeg: [88.9, 31.87, 83.93, 83.81, 80.4] [34mF1_perclass_eog: [85.6, 9.35, 81.99, 78.94, 84.71] 
[37mEpoch 10 step 92 with [31mce_loss_combined : 0.357605 [31mce_loss_eeg : 0.451155 [31mce_loss_eog : 0.509337 [31mtotal : 1.318097 [94mAcc_combined: 86.79 [94mAcc_eeg: 84.04 [94mAcc_eog: 80.99 [92mF1_combined: 77.68 [92mF1_eeg: 74.41 [92mF1_eog: 67.64 [92mK_combined: 0.8170 [92mK_eeg: 0.7785 [92mK_eog: 0.7316 [34mF1_perclass_combined: [91.68, 36.99, 87.36, 84.28, 88.11] [34mF1_perclass_eeg: [89.12, 32.61, 84.99, 84.08, 81.27] [34mF1_perclass_eog: [85.45, 11.77, 82.19, 73.52, 85.25] 
[37mEpoch 10 step 93 with [31mce_loss_combined : 0.352455 [31mce_loss_eeg : 0.449734 [31mce_loss_eog : 0.498129 [31mtotal : 1.300319 [94mAcc_combined: 86.96 [94mAcc_eeg: 84.12 [94mAcc_eog: 81.34 [92mF1_combined: 77.85 [92mF1_eeg: 74.57 [92mF1_eog: 67.76 [92mK_combined: 0.8189 [92mK_eeg: 0.7796 [92mK_eog: 0.7359 [34mF1_perclass_combined: [92.0, 37.43, 87.6, 84.19, 88.04] [34mF1_perclass_eeg: [89.09, 33.24, 85.19, 83.84, 81.48] [34mF1_perclass_eog: [86.2, 10.8, 82.44, 74.05, 85.29] 
[37mEpoch 10 step 94 with [31mce_loss_combined : 0.351119 [31mce_loss_eeg : 0.448211 [31mce_loss_eog : 0.491633 [31mtotal : 1.290963 [94mAcc_combined: 86.97 [94mAcc_eeg: 84.14 [94mAcc_eog: 81.73 [92mF1_combined: 78.12 [92mF1_eeg: 74.70 [92mF1_eog: 68.42 [92mK_combined: 0.8194 [92mK_eeg: 0.7800 [92mK_eog: 0.7427 [34mF1_perclass_combined: [92.1, 38.67, 87.55, 84.26, 88.04] [34mF1_perclass_eeg: [89.13, 33.72, 85.22, 83.81, 81.59] [34mF1_perclass_eog: [86.26, 10.97, 82.55, 77.03, 85.28] 
[37mEpoch 10 step 95 with [31mce_loss_combined : 0.350518 [31mce_loss_eeg : 0.447156 [31mce_loss_eog : 0.490322 [31mtotal : 1.287996 [94mAcc_combined: 86.99 [94mAcc_eeg: 84.13 [94mAcc_eog: 81.79 [92mF1_combined: 78.19 [92mF1_eeg: 74.65 [92mF1_eog: 68.65 [92mK_combined: 0.8198 [92mK_eeg: 0.7801 [92mK_eog: 0.7439 [34mF1_perclass_combined: [92.21, 38.79, 87.48, 84.33, 88.12] [34mF1_perclass_eeg: [89.17, 33.39, 85.15, 83.9, 81.66] [34mF1_perclass_eog: [86.34, 11.55, 82.53, 77.48, 85.32] 
[37mEpoch 14 step 125 with [31mce_loss_combined : 0.345924 [31mce_loss_eeg : 0.437486 [31mce_loss_eog : 0.485918 [31mtotal : 1.269328 [94mAcc_combined: 87.35 [94mAcc_eeg: 84.44 [94mAcc_eog: 82.03 [92mF1_combined: 77.81 [92mF1_eeg: 75.46 [92mF1_eog: 68.66 [92mK_combined: 0.8240 [92mK_eeg: 0.7843 [92mK_eog: 0.7480 [34mF1_perclass_combined: [92.44, 35.75, 87.93, 84.44, 88.48] [34mF1_perclass_eeg: [89.66, 36.17, 85.27, 83.7, 82.53] [34mF1_perclass_eog: [86.89, 10.99, 82.68, 77.55, 85.2] 
[37mEpoch 14 step 128 with [31mce_loss_combined : 0.344820 [31mce_loss_eeg : 0.433586 [31mce_loss_eog : 0.480650 [31mtotal : 1.259056 [94mAcc_combined: 87.30 [94mAcc_eeg: 84.48 [94mAcc_eog: 81.78 [92mF1_combined: 78.62 [92mF1_eeg: 75.65 [92mF1_eog: 69.17 [92mK_combined: 0.8233 [92mK_eeg: 0.7850 [92mK_eog: 0.7419 [34mF1_perclass_combined: [92.49, 40.3, 87.98, 84.0, 88.34] [34mF1_perclass_eeg: [89.57, 37.2, 85.4, 83.87, 82.23] [34mF1_perclass_eog: [87.16, 16.44, 82.76, 73.51, 85.98] 
[37mEpoch 14 step 129 with [31mce_loss_combined : 0.344809 [31mce_loss_eeg : 0.431708 [31mce_loss_eog : 0.473589 [31mtotal : 1.250107 [94mAcc_combined: 87.23 [94mAcc_eeg: 84.61 [94mAcc_eog: 82.47 [92mF1_combined: 78.98 [92mF1_eeg: 76.09 [92mF1_eog: 70.71 [92mK_combined: 0.8232 [92mK_eeg: 0.7870 [92mK_eog: 0.7553 [34mF1_perclass_combined: [92.39, 41.92, 87.83, 84.48, 88.29] [34mF1_perclass_eeg: [89.86, 38.66, 85.43, 83.7, 82.78] [34mF1_perclass_eog: [87.14, 18.05, 82.73, 79.45, 86.15] 
[37mEpoch 14 step 130 with [31mce_loss_combined : 0.346244 [31mce_loss_eeg : 0.433286 [31mce_loss_eog : 0.469826 [31mtotal : 1.249356 [94mAcc_combined: 87.21 [94mAcc_eeg: 84.60 [94mAcc_eog: 82.50 [92mF1_combined: 79.01 [92mF1_eeg: 76.12 [92mF1_eog: 71.20 [92mK_combined: 0.8232 [92mK_eeg: 0.7871 [92mK_eog: 0.7559 [34mF1_perclass_combined: [92.57, 41.91, 87.61, 84.6, 88.37] [34mF1_perclass_eeg: [89.77, 38.46, 85.35, 84.43, 82.61] [34mF1_perclass_eog: [87.3, 20.29, 82.79, 79.32, 86.28] 
[37mEpoch 14 step 131 with [31mce_loss_combined : 0.345017 [31mce_loss_eeg : 0.434350 [31mce_loss_eog : 0.467982 [31mtotal : 1.247350 [94mAcc_combined: 87.31 [94mAcc_eeg: 84.45 [94mAcc_eog: 82.59 [92mF1_combined: 78.70 [92mF1_eeg: 75.75 [92mF1_eog: 70.90 [92mK_combined: 0.8237 [92mK_eeg: 0.7842 [92mK_eog: 0.7556 [34mF1_perclass_combined: [92.78, 40.05, 87.7, 84.76, 88.23] [34mF1_perclass_eeg: [89.69, 37.39, 85.24, 84.41, 82.03] [34mF1_perclass_eog: [87.47, 19.12, 83.11, 78.44, 86.34] 
[37mEpoch 15 step 133 with [31mce_loss_combined : 0.342420 [31mce_loss_eeg : 0.431466 [31mce_loss_eog : 0.466926 [31mtotal : 1.240813 [94mAcc_combined: 87.34 [94mAcc_eeg: 84.61 [94mAcc_eog: 82.59 [92mF1_combined: 78.87 [92mF1_eeg: 75.99 [92mF1_eog: 71.05 [92mK_combined: 0.8247 [92mK_eeg: 0.7868 [92mK_eog: 0.7568 [34mF1_perclass_combined: [92.73, 40.67, 87.73, 84.76, 88.45] [34mF1_perclass_eeg: [89.87, 37.82, 85.27, 84.47, 82.51] [34mF1_perclass_eog: [87.37, 19.29, 82.9, 79.19, 86.47] 
[37mEpoch 15 step 134 with [31mce_loss_combined : 0.340850 [31mce_loss_eeg : 0.430626 [31mce_loss_eog : 0.467176 [31mtotal : 1.238652 [94mAcc_combined: 87.43 [94mAcc_eeg: 84.62 [94mAcc_eog: 82.57 [92mF1_combined: 78.82 [92mF1_eeg: 75.95 [92mF1_eog: 70.72 [92mK_combined: 0.8256 [92mK_eeg: 0.7868 [92mK_eog: 0.7561 [34mF1_perclass_combined: [92.74, 40.15, 87.86, 84.85, 88.52] [34mF1_perclass_eeg: [89.86, 37.67, 85.33, 84.4, 82.51] [34mF1_perclass_eog: [87.36, 18.07, 82.97, 78.84, 86.34] 
[37mEpoch 15 step 135 with [31mce_loss_combined : 0.340345 [31mce_loss_eeg : 0.430072 [31mce_loss_eog : 0.466713 [31mtotal : 1.237130 [94mAcc_combined: 87.47 [94mAcc_eeg: 84.64 [94mAcc_eog: 82.57 [92mF1_combined: 78.77 [92mF1_eeg: 75.94 [92mF1_eog: 70.56 [92mK_combined: 0.8260 [92mK_eeg: 0.7870 [92mK_eog: 0.7559 [34mF1_perclass_combined: [92.71, 39.83, 87.96, 84.82, 88.51] [34mF1_perclass_eeg: [89.9, 37.64, 85.37, 84.24, 82.57] [34mF1_perclass_eog: [87.32, 17.39, 82.98, 78.71, 86.42] 
{'val_loss': {'ce_loss_combined': 0.34034476, 'ce_loss_eeg': 0.43007225, 'ce_loss_eog': 0.4667134, 'total': 1.2371304}, 'val_acc': {'combined': 0.8746856746856747, 'eeg': 0.8463914463914464, 'eog': 0.8256806256806257}, 'val_f1': {'combined': 0.7876574039845734, 'eeg': 0.7594376278223011, 'eog': 0.7056257534448549}, 'val_k': {'combined': 0.8259913173968714, 'eeg': 0.7869515311243697, 'eog': 0.755933250436613}, 'val_perclassf1': {'combined': array([0.92709746, 0.39829642, 0.87963134, 0.84821067, 0.88505113]), 'eeg': array([0.89899661, 0.3764265 , 0.85369288, 0.84239298, 0.82567917]), 'eog': array([0.87317322, 0.1738758 , 0.82981804, 0.78707371, 0.86418799])}}
We are in the final state.
 THE Configuration of your experiment ..
{'agent': 'Sleep_Agent_Init_Train',
 'augmentation': {},
 'channel': 0,
 'dataset': {'cache_datasets': {'test': False, 'train': False, 'valid': False},
             'data_roots': '/esat/biomeddata/SHHS_Dataset/no_backup',
             'data_split': {'fold': 0,
                            'fold_size': 7,
                            'folds_file': '/users/sista/kkontras/Documents/Huy_shhs1/HUY '
                                          'SHHS1 CODE/data_split_eval.mat',
                            'rand_split': 0,
                            'rand_splits': 13,
                            'split_method': 'patients_huy',
                            'test_split_rate': 0.3,
                            'val_patient_num': 3,
                            'val_split_rate': 0.01692},
             'data_view_dir': [{'data_type': 'stft',
                                'list_dir': 'patient_mat_list.txt',
                                'mod': 'eeg',
                                'num_ch': 1},
                               {'data_type': 'stft',
                                'list_dir': 'patient_eog_mat_list.txt',
                                'mod': 'eog',
                                'num_ch': 1}],
             'dataloader_class': 'SleepDataLoader_mat_huy',
             'filter_windows': {'test': {'perc_threshold': 0.4,
                                         'skip_skips': True,
                                         'std_threshold': 41,
                                         'use_type': 'include_only_skipped',
                                         'whole_patient': False},
                                'train': {'perc_threshold': 0.4,
                                          'skip_skips': False,
                                          'std_threshold': 41,
                                          'subsets': {'combined': 100,
                                                      'eeg': 100,
                                                      'eog': 100},
                                          'use_type': 'subsample',
                                          'whole_patient': True},
                                'val': {'skip_skips': True,
                                        'use_type': False,
                                        'whole_patient': False}},
             'huy_data': True,
             'inner_overlap': [0.5, 0.5],
             'keep_view': [1, 0],
             'seq_length': [21, 0],
             'seq_views': [False],
             'shuffle_train': True},
 'early_stopping': {'log_interval': 10,
                    'max_epoch': 1000,
                    'n_steps_stop': 200,
                    'n_steps_stop_after': 400,
                    'save_every': 1,
                    'validate_after': 0,
                    'validate_every': 50},
 'exp_name': 'Sleep EEG-EOG BLIP Experiment',
 'lr_finder': False,
 'lr_finder_steps': 100,
 'mode': 'train',
 'model': {'args': {'augment_within': False,
                    'dmodel': 128,
                    'dropout': 0.3,
                    'fc_inner': 1024,
                    'ignore_alignment_val': True,
                    'multi_loss': {'multi_loss_weights': {'alignment_loss': 0.1,
                                                          'multi_supervised_loss': {'combined': 1,
                                                                                    'eeg': 1,
                                                                                    'eog': 1},
                                                          'order_loss': 0}},
                    'num_classes': 5,
                    'three_modes': True,
                    'training_type': 'alignment_order_multisupervised'},
           'encoders': [{'args': {'align_inner': True,
                                  'd_model': 128,
                                  'dim_feedforward': 1024,
                                  'dim_proj': 128,
                                  'dropout': 0.3,
                                  'inner_biased': False,
                                  'mod_token': False,
                                  'num_heads': 8,
                                  'num_layers': 4,
                                  'outer_biased': False,
                                  'outer_rep': False,
                                  'pos': False,
                                  'rpos': True,
                                  'shared': True,
                                  'skip_random_mod': False},
                         'encoders': [],
                         'freeze_encoder': False,
                         'model': 'SleepEnc_BLIP_EEG_EOG_shared_free_cliplike',
                         'pretrainedEncoder': {'dir': '', 'use': False},
                         'savetrainedEncoder': {'dir': '', 'save': False}}],
           'load_ongoing': False,
           'model_class': 'EEG_SLEEP_BLIP_GM_MultiMode',
           'pretrained_model': {'dir': '', 'use': False},
           'save_dir': '/esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2021_data/shhs1/multi_modal/paper_models/fourier_transformer_eeg_eog_mat_BLIP_al01_shared_b16_freetrain_rpos_nopos_nonsharedpreds_drop03_align_inner_trial1_incomplete_100p_100e_100o.pth.tar'},
 'normalization': {'calculate_metrics': False,
                   'dir': '/esat/biomeddata/SHHS_Dataset/no_backup/metrics_eeg_eog_emg_stft.pkl',
                   'metrics_type': 'train_dataset',
                   'save_metrics': False,
                   'use': True},
 'num_classes': 5,
 'num_modalities': 1,
 'optimizer': {'beta1': 0.9,
               'beta2': 0.999,
               'learning_rate': 0.0001,
               'momentum': 0.2,
               'type': 'Adam',
               'weight_decay': 0.0001},
 'plots': {'plot_stft_num': 0, 'save': False},
 'post_proc': {'post_proc_step': 15,
               'test_postprocessing': False,
               'val_postprocessing': False},
 'scheduler': {'max_lr': 0.03, 'type': 'cosanneal', 'warm_up': 55},
 'statistics': {'ce_weights': {'temp': 0.1, 'use': False}, 'print': False},
 'training_params': {'adversarial_training': {'adv_epsilon': 0.01,
                                              'use': False},
                     'async_loading': True,
                     'batch_size': 32,
                     'cuda': False,
                     'data_loader_workers': 8,
                     'gpu_device': [0],
                     'pin_memory': True,
                     'rec_test': False,
                     'res': True,
                     'seed': 28,
                     'tdqm_disable': True,
                     'test_batch_size': 32,
                     'test_on_tops': True,
                     'use_test_set': True,
                     'validation': True,
                     'verbose': True,
                     'wandb_disable': True}}
 *************************************** 
The experiment name is Sleep EEG-EOG BLIP Experiment
 *************************************** 
We are splitting dataset by huy splits
{'use_type': 'subsample', 'skip_skips': False, 'whole_patient': True, 'std_threshold': 41, 'perc_threshold': 0.4, 'subsets': {'combined': 100, 'eeg': 100, 'eog': 100}}
We subsample patients with 100 both mods, 100 only EEG and 100 only EOG and len_skipped is 298.
{'use_type': False, 'skip_skips': True, 'whole_patient': False}
{'use_type': 'include_only_skipped', 'skip_skips': True, 'whole_patient': False, 'std_threshold': 41, 'perc_threshold': 0.4}
Patients with broken modalities are 27
{'use_type': False, 'skip_skips': True}
Loading metrics from /esat/biomeddata/SHHS_Dataset/no_backup/metrics_eeg_eog_emg_stft.pkl
Weights are [1. 1. 1. 1. 1.]
440
50
9
tensor([1., 1., 1., 1., 1.], device='cuda:0')
We are not shuffling the data
Training function is sleep_train_one_step_alignment_order_multisupervised
Loss Weights are {'combined': 1, 'eeg': 1, 'eog': 1, 'alignments': 0.1, 'order': 0, 'consistency': 0, 'reconstruction': 0}
We are not shuffling the data
<class 'graphs.models.attention_models.BLIP.SleepEnc_BLIP_EEG_EOG_shared_free_cliplike'>
Total number of trainable parameters are: 7628293
Available cuda devices: 1, current device:0
Total number of trainable parameters are: 7628293
[37mEpoch 0 step 1 with [31mce_loss_combined : 1.057085 [31mce_loss_eeg : 1.007973 [31mce_loss_eog : 1.206921 [31mtotal : 3.271980 [94mAcc_combined: 59.40 [94mAcc_eeg: 60.78 [94mAcc_eog: 54.30 [92mF1_combined: 29.01 [92mF1_eeg: 30.01 [92mF1_eog: 26.11 [92mK_combined: 0.3706 [92mK_eeg: 0.3900 [92mK_eog: 0.2988 [34mF1_perclass_combined: [77.93, 0.0, 67.12, 0.0, 0.0] [34mF1_perclass_eeg: [82.99, 0.0, 67.06, 0.0, 0.0] [34mF1_perclass_eog: [66.7, 0.0, 63.82, 0.0, 0.0] 
[37mEpoch 0 step 2 with [31mce_loss_combined : 0.843884 [31mce_loss_eeg : 0.797159 [31mce_loss_eog : 1.025335 [31mtotal : 2.666378 [94mAcc_combined: 67.85 [94mAcc_eeg: 70.30 [94mAcc_eog: 57.54 [92mF1_combined: 54.02 [92mF1_eeg: 56.34 [92mF1_eog: 33.50 [92mK_combined: 0.5653 [92mK_eeg: 0.5987 [92mK_eog: 0.3669 [34mF1_perclass_combined: [79.33, 0.0, 65.4, 72.62, 52.72] [34mF1_perclass_eeg: [83.14, 0.0, 66.99, 75.39, 56.17] [34mF1_perclass_eog: [68.11, 0.0, 66.63, 19.74, 13.01] 
[37mEpoch 0 step 3 with [31mce_loss_combined : 0.864438 [31mce_loss_eeg : 0.811905 [31mce_loss_eog : 0.943540 [31mtotal : 2.619883 [94mAcc_combined: 64.27 [94mAcc_eeg: 66.65 [94mAcc_eog: 65.61 [92mF1_combined: 51.20 [92mF1_eeg: 53.83 [92mF1_eog: 50.19 [92mK_combined: 0.5248 [92mK_eeg: 0.5606 [92mK_eog: 0.5195 [34mF1_perclass_combined: [80.22, 0.0, 56.71, 68.79, 50.3] [34mF1_perclass_eeg: [82.95, 0.0, 58.43, 73.93, 53.84] [34mF1_perclass_eog: [75.4, 0.0, 67.63, 68.96, 38.98] 
[37mEpoch 0 step 6 with [31mce_loss_combined : 0.687369 [31mce_loss_eeg : 0.715916 [31mce_loss_eog : 0.924559 [31mtotal : 2.327844 [94mAcc_combined: 76.51 [94mAcc_eeg: 73.19 [94mAcc_eog: 65.90 [92mF1_combined: 60.20 [92mF1_eeg: 58.09 [92mF1_eog: 51.56 [92mK_combined: 0.6644 [92mK_eeg: 0.6296 [92mK_eog: 0.5276 [34mF1_perclass_combined: [85.19, 0.0, 78.87, 69.4, 67.57] [34mF1_perclass_eeg: [85.19, 0.0, 71.56, 75.18, 58.51] [34mF1_perclass_eog: [70.94, 0.0, 73.0, 59.45, 54.42] 
[37mEpoch 1 step 9 with [31mce_loss_combined : 0.659118 [31mce_loss_eeg : 0.728154 [31mce_loss_eog : 0.874711 [31mtotal : 2.261982 [94mAcc_combined: 76.09 [94mAcc_eeg: 73.66 [94mAcc_eog: 67.23 [92mF1_combined: 59.28 [92mF1_eeg: 57.93 [92mF1_eog: 48.39 [92mK_combined: 0.6587 [92mK_eeg: 0.6288 [92mK_eog: 0.5263 [34mF1_perclass_combined: [85.9, 0.0, 78.15, 61.53, 70.82] [34mF1_perclass_eeg: [85.74, 0.0, 76.07, 70.98, 56.86] [34mF1_perclass_eog: [77.42, 0.0, 71.71, 28.3, 64.5] 
[37mEpoch 1 step 11 with [31mce_loss_combined : 0.650278 [31mce_loss_eeg : 0.687044 [31mce_loss_eog : 0.831609 [31mtotal : 2.168930 [94mAcc_combined: 77.93 [94mAcc_eeg: 75.66 [94mAcc_eog: 70.90 [92mF1_combined: 62.51 [92mF1_eeg: 60.18 [92mF1_eog: 56.73 [92mK_combined: 0.6939 [92mK_eeg: 0.6588 [92mK_eog: 0.5974 [34mF1_perclass_combined: [83.26, 0.0, 80.7, 79.62, 68.96] [34mF1_perclass_eeg: [85.01, 0.0, 77.66, 78.54, 59.7] [34mF1_perclass_eog: [72.98, 0.0, 75.82, 71.57, 63.3] 
[37mEpoch 1 step 13 with [31mce_loss_combined : 0.591770 [31mce_loss_eeg : 0.656730 [31mce_loss_eog : 0.739179 [31mtotal : 1.987679 [94mAcc_combined: 79.11 [94mAcc_eeg: 76.29 [94mAcc_eog: 75.10 [92mF1_combined: 63.07 [92mF1_eeg: 61.21 [92mF1_eog: 59.84 [92mK_combined: 0.7038 [92mK_eeg: 0.6721 [92mK_eog: 0.6456 [34mF1_perclass_combined: [87.46, 0.0, 79.34, 79.69, 68.85] [34mF1_perclass_eeg: [86.58, 0.0, 76.34, 80.42, 62.7] [34mF1_perclass_eog: [79.35, 0.0, 77.8, 72.63, 69.43] 
[37mEpoch 2 step 19 with [31mce_loss_combined : 0.557248 [31mce_loss_eeg : 0.650144 [31mce_loss_eog : 0.741816 [31mtotal : 1.949208 [94mAcc_combined: 80.30 [94mAcc_eeg: 77.02 [94mAcc_eog: 73.23 [92mF1_combined: 64.68 [92mF1_eeg: 61.47 [92mF1_eog: 59.45 [92mK_combined: 0.7266 [92mK_eeg: 0.6799 [92mK_eog: 0.6275 [34mF1_perclass_combined: [88.34, 0.17, 81.0, 79.7, 74.17] [34mF1_perclass_eeg: [85.46, 0.06, 78.09, 80.73, 63.05] [34mF1_perclass_eog: [78.16, 0.0, 73.76, 72.83, 72.48] 
[37mEpoch 2 step 23 with [31mce_loss_combined : 0.525383 [31mce_loss_eeg : 0.640947 [31mce_loss_eog : 0.708463 [31mtotal : 1.874792 [94mAcc_combined: 82.02 [94mAcc_eeg: 76.92 [94mAcc_eog: 74.38 [92mF1_combined: 66.03 [92mF1_eeg: 62.02 [92mF1_eog: 60.30 [92mK_combined: 0.7460 [92mK_eeg: 0.6844 [92mK_eog: 0.6440 [34mF1_perclass_combined: [87.99, 0.11, 83.22, 77.88, 80.96] [34mF1_perclass_eeg: [85.97, 0.28, 76.66, 80.65, 66.56] [34mF1_perclass_eog: [77.79, 0.0, 75.89, 73.7, 74.12] 
[37mEpoch 3 step 27 with [31mce_loss_combined : 0.534906 [31mce_loss_eeg : 0.620767 [31mce_loss_eog : 0.683006 [31mtotal : 1.838679 [94mAcc_combined: 82.16 [94mAcc_eeg: 78.22 [94mAcc_eog: 75.89 [92mF1_combined: 67.66 [92mF1_eeg: 64.15 [92mF1_eog: 60.86 [92mK_combined: 0.7481 [92mK_eeg: 0.6969 [92mK_eog: 0.6553 [34mF1_perclass_combined: [87.97, 7.28, 83.33, 80.84, 78.89] [34mF1_perclass_eeg: [86.33, 8.71, 78.77, 80.58, 66.34] [34mF1_perclass_eog: [80.73, 0.11, 77.78, 68.52, 77.14] 
[37mEpoch 3 step 28 with [31mce_loss_combined : 0.508130 [31mce_loss_eeg : 0.620801 [31mce_loss_eog : 0.686175 [31mtotal : 1.815105 [94mAcc_combined: 82.50 [94mAcc_eeg: 78.20 [94mAcc_eog: 75.78 [92mF1_combined: 70.75 [92mF1_eeg: 66.21 [92mF1_eog: 61.32 [92mK_combined: 0.7551 [92mK_eeg: 0.6973 [92mK_eog: 0.6574 [34mF1_perclass_combined: [88.28, 20.31, 83.69, 80.75, 80.73] [34mF1_perclass_eeg: [85.76, 17.87, 80.15, 81.55, 65.7] [34mF1_perclass_eog: [81.15, 0.0, 76.54, 72.41, 76.5] 
[37mEpoch 4 step 40 with [31mce_loss_combined : 0.522650 [31mce_loss_eeg : 0.579402 [31mce_loss_eog : 0.658823 [31mtotal : 1.760875 [94mAcc_combined: 82.23 [94mAcc_eeg: 79.31 [94mAcc_eog: 78.27 [92mF1_combined: 66.93 [92mF1_eeg: 64.82 [92mF1_eog: 63.68 [92mK_combined: 0.7476 [92mK_eeg: 0.7125 [92mK_eog: 0.6953 [34mF1_perclass_combined: [87.09, 3.74, 83.78, 77.53, 82.51] [34mF1_perclass_eeg: [86.32, 4.66, 79.68, 81.31, 72.11] [34mF1_perclass_eog: [82.95, 0.0, 78.53, 76.56, 80.34] 
[37mEpoch 4 step 41 with [31mce_loss_combined : 0.485640 [31mce_loss_eeg : 0.596198 [31mce_loss_eog : 0.632763 [31mtotal : 1.714601 [94mAcc_combined: 83.51 [94mAcc_eeg: 78.99 [94mAcc_eog: 78.52 [92mF1_combined: 69.60 [92mF1_eeg: 65.74 [92mF1_eog: 63.68 [92mK_combined: 0.7694 [92mK_eeg: 0.7126 [92mK_eog: 0.6989 [34mF1_perclass_combined: [88.83, 10.0, 84.23, 81.2, 83.73] [34mF1_perclass_eeg: [86.97, 9.9, 79.38, 82.38, 70.07] [34mF1_perclass_eog: [83.34, 0.11, 79.12, 75.27, 80.59] 
[37mEpoch 5 step 48 with [31mce_loss_combined : 0.470569 [31mce_loss_eeg : 0.563427 [31mce_loss_eog : 0.640763 [31mtotal : 1.674760 [94mAcc_combined: 82.53 [94mAcc_eeg: 80.11 [94mAcc_eog: 78.49 [92mF1_combined: 68.96 [92mF1_eeg: 65.99 [92mF1_eog: 63.51 [92mK_combined: 0.7549 [92mK_eeg: 0.7200 [92mK_eog: 0.6972 [34mF1_perclass_combined: [88.37, 8.65, 82.34, 81.78, 83.66] [34mF1_perclass_eeg: [86.85, 8.72, 81.54, 82.73, 70.08] [34mF1_perclass_eog: [82.16, 0.0, 79.87, 74.54, 80.99] 
[37mEpoch 6 step 57 with [31mce_loss_combined : 0.466985 [31mce_loss_eeg : 0.528591 [31mce_loss_eog : 0.618053 [31mtotal : 1.613629 [94mAcc_combined: 83.05 [94mAcc_eeg: 81.46 [94mAcc_eog: 78.61 [92mF1_combined: 72.26 [92mF1_eeg: 69.06 [92mF1_eog: 64.05 [92mK_combined: 0.7654 [92mK_eeg: 0.7414 [92mK_eog: 0.7014 [34mF1_perclass_combined: [89.12, 23.01, 82.67, 80.85, 85.63] [34mF1_perclass_eeg: [87.44, 17.21, 82.78, 83.33, 74.55] [34mF1_perclass_eog: [82.37, 0.66, 79.41, 75.87, 81.96] 
[37mEpoch 6 step 60 with [31mce_loss_combined : 0.459923 [31mce_loss_eeg : 0.536825 [31mce_loss_eog : 0.613424 [31mtotal : 1.610171 [94mAcc_combined: 84.52 [94mAcc_eeg: 81.35 [94mAcc_eog: 79.15 [92mF1_combined: 73.53 [92mF1_eeg: 69.28 [92mF1_eog: 64.39 [92mK_combined: 0.7824 [92mK_eeg: 0.7397 [92mK_eog: 0.7026 [34mF1_perclass_combined: [89.18, 24.1, 85.4, 83.47, 85.49] [34mF1_perclass_eeg: [86.8, 18.42, 82.86, 83.86, 74.44] [34mF1_perclass_eog: [84.3, 2.57, 80.19, 72.92, 81.97] 
[37mEpoch 7 step 65 with [31mce_loss_combined : 0.459314 [31mce_loss_eeg : 0.530882 [31mce_loss_eog : 0.611168 [31mtotal : 1.601364 [94mAcc_combined: 84.74 [94mAcc_eeg: 81.84 [94mAcc_eog: 79.10 [92mF1_combined: 75.16 [92mF1_eeg: 70.77 [92mF1_eog: 64.20 [92mK_combined: 0.7877 [92mK_eeg: 0.7472 [92mK_eog: 0.7069 [34mF1_perclass_combined: [89.49, 32.75, 85.47, 82.16, 85.97] [34mF1_perclass_eeg: [87.6, 23.92, 82.94, 82.9, 76.49] [34mF1_perclass_eog: [83.55, 1.15, 79.83, 74.11, 82.38] 
[37mEpoch 8 step 71 with [31mce_loss_combined : 0.456123 [31mce_loss_eeg : 0.518758 [31mce_loss_eog : 0.606304 [31mtotal : 1.581185 [94mAcc_combined: 84.71 [94mAcc_eeg: 81.84 [94mAcc_eog: 79.28 [92mF1_combined: 74.73 [92mF1_eeg: 70.52 [92mF1_eog: 65.59 [92mK_combined: 0.7860 [92mK_eeg: 0.7475 [92mK_eog: 0.7057 [34mF1_perclass_combined: [89.22, 29.96, 85.62, 82.21, 86.65] [34mF1_perclass_eeg: [87.17, 22.15, 82.72, 83.43, 77.11] [34mF1_perclass_eog: [85.06, 9.62, 80.58, 69.76, 82.92] 
[37mEpoch 8 step 72 with [31mce_loss_combined : 0.442552 [31mce_loss_eeg : 0.528715 [31mce_loss_eog : 0.580752 [31mtotal : 1.552019 [94mAcc_combined: 85.07 [94mAcc_eeg: 81.77 [94mAcc_eog: 79.58 [92mF1_combined: 75.27 [92mF1_eeg: 70.77 [92mF1_eog: 65.48 [92mK_combined: 0.7917 [92mK_eeg: 0.7461 [92mK_eog: 0.7124 [34mF1_perclass_combined: [90.22, 32.51, 85.84, 81.78, 86.01] [34mF1_perclass_eeg: [87.5, 24.56, 82.95, 82.15, 76.71] [34mF1_perclass_eog: [84.62, 5.52, 80.44, 74.5, 82.3] 
[37mEpoch 8 step 74 with [31mce_loss_combined : 0.436975 [31mce_loss_eeg : 0.509908 [31mce_loss_eog : 0.574136 [31mtotal : 1.521019 [94mAcc_combined: 85.32 [94mAcc_eeg: 82.24 [94mAcc_eog: 80.19 [92mF1_combined: 75.67 [92mF1_eeg: 71.36 [92mF1_eog: 65.58 [92mK_combined: 0.7953 [92mK_eeg: 0.7530 [92mK_eog: 0.7210 [34mF1_perclass_combined: [89.81, 32.71, 86.06, 83.09, 86.67] [34mF1_perclass_eeg: [87.7, 24.99, 83.26, 83.48, 77.39] [34mF1_perclass_eog: [85.03, 3.19, 80.86, 75.43, 83.41] 
[37mEpoch 10 step 89 with [31mce_loss_combined : 0.436928 [31mce_loss_eeg : 0.498011 [31mce_loss_eog : 0.585247 [31mtotal : 1.520185 [94mAcc_combined: 85.53 [94mAcc_eeg: 82.81 [94mAcc_eog: 80.23 [92mF1_combined: 76.46 [92mF1_eeg: 73.12 [92mF1_eog: 67.33 [92mK_combined: 0.7970 [92mK_eeg: 0.7594 [92mK_eog: 0.7200 [34mF1_perclass_combined: [90.0, 35.99, 86.41, 82.96, 86.91] [34mF1_perclass_eeg: [87.72, 32.01, 83.93, 82.62, 79.3] [34mF1_perclass_eog: [84.92, 11.03, 81.0, 75.76, 83.96] 
[37mEpoch 10 step 91 with [31mce_loss_combined : 0.429004 [31mce_loss_eeg : 0.493551 [31mce_loss_eog : 0.565218 [31mtotal : 1.487773 [94mAcc_combined: 85.66 [94mAcc_eeg: 82.69 [94mAcc_eog: 80.68 [92mF1_combined: 76.65 [92mF1_eeg: 73.19 [92mF1_eog: 66.61 [92mK_combined: 0.7997 [92mK_eeg: 0.7597 [92mK_eog: 0.7276 [34mF1_perclass_combined: [90.15, 36.84, 86.44, 82.74, 87.09] [34mF1_perclass_eeg: [88.09, 32.75, 83.94, 83.33, 77.85] [34mF1_perclass_eog: [85.63, 6.63, 81.41, 75.14, 84.26] 
[37mEpoch 10 step 93 with [31mce_loss_combined : 0.425855 [31mce_loss_eeg : 0.486394 [31mce_loss_eog : 0.566322 [31mtotal : 1.478571 [94mAcc_combined: 85.72 [94mAcc_eeg: 83.03 [94mAcc_eog: 80.75 [92mF1_combined: 77.04 [92mF1_eeg: 73.55 [92mF1_eog: 67.09 [92mK_combined: 0.8005 [92mK_eeg: 0.7631 [92mK_eog: 0.7290 [34mF1_perclass_combined: [89.94, 38.37, 86.53, 83.01, 87.36] [34mF1_perclass_eeg: [88.31, 33.58, 84.26, 82.93, 78.65] [34mF1_perclass_eog: [85.74, 7.78, 81.21, 76.59, 84.12] 
[37mEpoch 13 step 123 with [31mce_loss_combined : 0.419984 [31mce_loss_eeg : 0.481918 [31mce_loss_eog : 0.570480 [31mtotal : 1.472382 [94mAcc_combined: 86.13 [94mAcc_eeg: 83.49 [94mAcc_eog: 81.06 [92mF1_combined: 77.79 [92mF1_eeg: 74.62 [92mF1_eog: 68.71 [92mK_combined: 0.8066 [92mK_eeg: 0.7700 [92mK_eog: 0.7350 [34mF1_perclass_combined: [90.18, 40.11, 86.92, 84.08, 87.66] [34mF1_perclass_eeg: [88.4, 36.34, 84.42, 83.49, 80.43] [34mF1_perclass_eog: [85.91, 14.07, 81.47, 77.42, 84.68] 
[37mEpoch 14 step 124 with [31mce_loss_combined : 0.422801 [31mce_loss_eeg : 0.479399 [31mce_loss_eog : 0.569483 [31mtotal : 1.471684 [94mAcc_combined: 86.08 [94mAcc_eeg: 83.53 [94mAcc_eog: 81.07 [92mF1_combined: 77.63 [92mF1_eeg: 74.37 [92mF1_eog: 69.08 [92mK_combined: 0.8059 [92mK_eeg: 0.7710 [92mK_eog: 0.7331 [34mF1_perclass_combined: [90.23, 39.74, 86.79, 83.85, 87.56] [34mF1_perclass_eeg: [88.5, 34.71, 84.3, 84.0, 80.36] [34mF1_perclass_eog: [85.99, 17.37, 81.94, 75.11, 84.99] 
[37mEpoch 14 step 125 with [31mce_loss_combined : 0.425731 [31mce_loss_eeg : 0.477176 [31mce_loss_eog : 0.560657 [31mtotal : 1.463563 [94mAcc_combined: 86.08 [94mAcc_eeg: 83.73 [94mAcc_eog: 81.07 [92mF1_combined: 77.70 [92mF1_eeg: 74.96 [92mF1_eog: 69.04 [92mK_combined: 0.8060 [92mK_eeg: 0.7737 [92mK_eog: 0.7335 [34mF1_perclass_combined: [90.24, 40.1, 86.81, 83.78, 87.58] [34mF1_perclass_eeg: [88.79, 37.18, 84.67, 83.98, 80.18] [34mF1_perclass_eog: [85.98, 16.82, 81.86, 75.5, 85.01] 
[37mEpoch 14 step 128 with [31mce_loss_combined : 0.408177 [31mce_loss_eeg : 0.474376 [31mce_loss_eog : 0.552002 [31mtotal : 1.434555 [94mAcc_combined: 86.10 [94mAcc_eeg: 83.49 [94mAcc_eog: 81.37 [92mF1_combined: 77.72 [92mF1_eeg: 74.41 [92mF1_eog: 68.77 [92mK_combined: 0.8054 [92mK_eeg: 0.7687 [92mK_eog: 0.7383 [34mF1_perclass_combined: [90.56, 40.52, 86.81, 82.69, 88.03] [34mF1_perclass_eeg: [88.92, 36.13, 84.63, 82.12, 80.24] [34mF1_perclass_eog: [86.29, 13.68, 81.87, 76.81, 85.2] 
{'val_loss': {'ce_loss_combined': 0.40817684, 'ce_loss_eeg': 0.4743758, 'ce_loss_eog': 0.5520025, 'total': 1.434555}, 'val_acc': {'combined': 0.8610305332097252, 'eeg': 0.8349033563603377, 'eog': 0.8137205059959927}, 'val_f1': {'combined': 0.7772095064174898, 'eeg': 0.7440740742951594, 'eog': 0.6877167955113912}, 'val_k': {'combined': 0.8054194875891572, 'eeg': 0.768683658338917, 'eog': 0.7382710527869769}, 'val_perclassf1': {'combined': array([0.90559682, 0.40523326, 0.8680531 , 0.82689756, 0.88026679]), 'eeg': array([0.88924593, 0.36130868, 0.84627826, 0.82115405, 0.80238346]), 'eog': array([0.86290933, 0.13683966, 0.8187076 , 0.7681101 , 0.85201729])}}
We are in the final state.
Job finished
